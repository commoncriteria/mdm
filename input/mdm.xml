<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="..\transformspp2html.xsl"?>
<?xml-model href="https://raw.githubusercontent.com/commoncriteria/transforms/master/schemas/CCProtectionProfile.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>
<PP boilerplate="yes" target-product="MDM" target-products="MDMs" xmlns="https://niap-ccevs.org/cc/v1" xmlns:h="http://www.w3.org/1999/xhtml" xmlns:sec="https://niap-ccevs.org/cc/v1/section">
  <PPReference>
    <ReferenceTable>
      <PPTitle>Protection Profile for Mobile Device Management</PPTitle>
      <PPVersion>5.0-Draft</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2025-11-19</PPPubDate>
      <Keywords>Mobile Device Management; MDM</Keywords>
    </ReferenceTable>
  </PPReference>
  <RevisionHistory>
    <entry>
      <version>1.0</version>
      <date>2013-10-21</date>
      <subject>Initial Release</subject>
    </entry>
    <entry>
      <version>1.1</version>
      <date>2014-02-07</date>
      <subject>Typographical changes and clarifications to front-matter</subject>
    </entry>
    <entry>
      <version>2.0</version>
      <date>2014-12-31</date>
      <subject>Separation of MDM agent SFRs<h:br/>Updated cryptography, protocol, X.509 requirements.<h:br/> Updated management functions to match MDF PP v2.0.<h:br/> Included SSH as a remote administration protocol.<h:br/> Removed IPsec as protocol to communicate to MDM agent.<h:br/> Added X509 enrollment objective requirement.<h:br/> Added Optional Mobile Application Store requirements.</subject>
    </entry>
    <entry>
      <version>3.0</version>
      <date>2016-11-21</date>
      <subject>Updates to align with Technical Decisions<h:br/> Added requirements to support BYOD use case <h:br/> Removed IPsec and SSH requirements, which are now contained in EPs</subject>
    </entry>
    <entry>
      <version>4.0</version>
      <date>2018-09-24</date>
      <subject> Updates to align with Technical Decisions<h:br/> Removed platform dependency<h:br/> Removed TLS SFRs and use the TLS Functional Package<h:br/> Allowed for a distributed TOE </subject>
    </entry>
    <entry>
      <version>5.0</version>
      <date>2024-11-15</date>
      <subject> Updates to align with Technical Decisions<h:br/> Updates to align with CC:2022<h:br/> Updates to support subordinate MDM<h:br/><h:br/></subject>
    </entry>
  </RevisionHistory>
  <include-pkg id="ssh">
    <git>
      <url>https://github.com/commoncriteria/ssh</url>
      <branch>release-2.0</branch>
    </git>
    <url>https://commoncriteria.github.io/ssh/release-2.0/ssh-release.html</url>
  </include-pkg>
  <include-pkg id="tls">
    <git>
      <url>https://github.com/commoncriteria/tls</url>
      <branch>release-2.1</branch>
    </git>
    <url>https://commoncriteria.github.io/tls/release-2.1/tls-release.html</url>
  </include-pkg>
  <include-pkg id="X509">
    <git>
      <url>https://github.com/commoncriteria/X509</url>
      <branch>release-1.0</branch>
    </git>
    <url>https://www.niap-ccevs.org/protectionprofiles/511</url>
  </include-pkg>
  <pp-preferences>
    <audit-events-in-sfrs/>
  </pp-preferences>
  <sec:Introduction>
    <section id="ov" title="Overview">
      Mobile Device Management (MDM) products allow enterprises to apply security policies to managed devices (MDs), such as smartphones, tablets, and workstations. The purpose of 
			these policies is to establish a security posture adequate to permit MDs to process enterprise data and connect to enterprise network
			resources.
      <h:br/>
      <h:br/>
      This document provides a baseline set of Security Functional Requirements (SFRs) for an MDM system, which is the Target of Evaluation (TOE). The MDM 
			system is only one component of an enterprise deployment of MDs. Other components, such as the MD platforms, which enforce 
			the security policies and network access control servers are out of scope.
    </section>
    <tech-terms>
      <term full="Administrator">The person who is responsible for management activities, including setting the 
				policy that is applied by the enterprise on the MD.</term>
      <term full="API Application Programming Interface" abbr="API">A specification of routines, data structures,
				object classes, and variables that allows an application to make use of services provided by another
				software component, such as a library. APIs are often provided for a set of libraries included with 
				the platform.</term>
      <term full="Critical Security Parameter" abbr="CSP">Security-related information whose disclosure or 
				modification can compromise the security of a cryptographic module or authentication system.</term>
      <term full="Data">Program or application or data files that are stored or transmitted by a server or MD.</term>
      <term full="Data Encryption Key" abbr="DEK">A key used to encrypt data-at-rest.</term>
      <term full="Developer Modes">States in which additional services are available to a user in order to
				provide enhanced system access for debugging of	software.</term>
      <term full="Enrolled State">The state in which a MD is administered and configured by a policy from an MDM.</term>
      <term full="Enterprise Applications">Applications that are provided and managed by the enterprise as
				opposed to a public application store.</term>
      <term full="Enterprise Data">Any data residing in enterprise servers or temporarily stored on MDs to which the MD user is allowed access according to the security policy defined by 
				the enterprise and implemented by the administrator.</term>
      <term full="Enrollment over Secure Transport" abbr="EST">Cryptographic protocol that describes an X.509 
				certificate management protocol targeting public key infrastructure (PKI) clients that need to acquire
				client certificates and associated certificate authority (CA) certificates.</term>
      <term full="Key Encryption Key" abbr="KEK">A key that is used to encrypt other keys,
				such as DEKs or storage repositories that contain keys.</term>
      <term full="Locked State">Device state where the device is powered
				on but most functionality is unavailable for use without authentication.</term>
      <term full="Managed Device" abbr="MD">A device enrolled and managed, or to be enrolled and managed, by an MDM system. This device is a mobile device typically evaluated under the MDF PP or a device utilizing a GPOS typically evaluated under the GPOS PP.</term>
      <term full="Mobile Application Store" abbr="MAS">An MDM feature that allows for an organization to substitute a device manufacturer's
            application store for one that restricts what applications are made available to users.</term>
      <term full="Mobile Device">A device which is composed of a hardware platform and its system software. The device typically provides wireless
				connectivity and may include software for functions like secure messaging, email, web, VPN connection, and VoIP (Voice over IP), for access
				to the protected enterprise network, enterprise data and applications, and for communicating to other MDs.</term>
      <term full="Mobile Device Management" abbr="MDM">Products that allow enterprises to apply security policies to MDs. This system consists of two primary
				components: the MDM server and the MDM agent.</term>
      <term full="Managed Device User">The person who uses and is held responsible for an MD. </term>
      <term full="Operating System" abbr="OS">Software which runs at the highest
				privilege level and can directly control hardware resources. Modern mobile devices
				typically have at least two primary operating systems: one which runs on the cellular
				baseband processor and one which runs on the application processor. The platform of the
				application processor handles most user interaction and provides the execution
				environment for apps. The platform of the cellular baseband processor handles
				communications with the cellular network and may control other peripherals. The term
				OS, without context, may be assumed to refer to the platform of the
				application processor.</term>
      <term full="Powered-Off State">MD shutdown state.</term>
      <term full="Protected Data">All non-TSF data on the MD,
				including user or enterprise data. Protected data is encrypted while the MD
				is in the powered-off state. This includes keys in software-based storage. May overlap
				with sensitive data.</term>
      <term full="Root Encryption Key" abbr="REK">A key tied to a particular device that
				is used to encrypt all other keys for that device.</term>
      <term full="Sensitive Data">Data that is encrypted by the MD.
				May include all user or enterprise data or may be data for specific applications such as
				emails, messaging, documents, calendar items, or contacts. May be protected while the
				MD is in the locked state. Must include at minimum some keys in
				software-based key storage.</term>
      <term full="Subordinate MDM Server">The subordinate MDM server is used to facilitate communications between a primary MDM server and an MDM agent on a managed device. The subordinate MDM server may modify/interpret the MDM policy sent from the primary MDM server to the MDM agent, using well-defined rules, and re-sign the resulting MDM policy for delivery to the MDM agent.</term>
      <term full="Trust Anchor Database">A list of trusted root Certificate Authority certificates. </term>
      <term full="Unenrolled State">Device state when it is not managed by an MDM.</term>
      <term full="Unlocked State">Device state where it is powered on and the user has been authenticated. The device functionality is available for use by the user.</term>
    </tech-terms>
    <section title="Compliant Targets of Evaluation" id="cte">
      The Mobile Device Management (MDM) system consists of two primary components: the MDM server software and the MDM agent. Optionally, the MDM system may
			consist of a separate Mobile Application Store (MAS) server or a subordinate MDM server.
      <sec:TOE_Boundary>
        The MDM system operational environment consists of the MD on which the MDM agent resides, 
				the platform on which the MDM server runs, and an untrusted wireless network over which they communicate, as pictured below.
        <h:br/>
        <h:br/>
        <figure entity="images/MDMSystem.png" title="MDM System Operating Environment" id="agentoperatingenvironment"/>
        <h:br/>
        <h:br/>
        The
        <h:b>MDM server</h:b>
        is software (an application, service, etc.) on a general-purpose platform, a network device, or cloud architecture executing
				in a trusted network environment. The MDM server provides administration of MD policies and reporting on the device behavior.
				The MDM server is responsible for managing device enrollment, configuring and sending policies to the MDM agents, collecting reports on device
				status, and sending commands to the agents. The MDM server may be standalone or distributed, where a distributed TOE is one that requires
				multiple distinct components to operate as a logical whole in order to fulfill the requirements of this PP (a more extensive description of 
				distributed MDMs is given in section 3).
        <h:br/>
        <h:br/>
        The
        <h:b>MDM agent</h:b>
        establishes a secure connection back to the
				MDM server controlled by an enterprise administrator and configures the
				MD per the administrator's policies. The MDM agent is addressed in the PP-Module for MDM
				Agents. If the MDM agent is installed on a MD as an application
				developed by the MDM developer, the PP-Module extends this PP and is included in the TOE. In this case, the TOE security 
				functionality specified in this PP must be
				addressed by the MDM agent in addition to the MDM
				Server. Otherwise, the MDM agent is provided by the MD vendor
				and is out of scope of this PP; however, MDMs are
				required to indicate the device platforms supported by the MDM server and
				must be tested against the native MDM agent of those platforms.
        <h:br/>
        <h:br/>
        The
        <h:b>Mobile Application Store (MAS)</h:b>
        hosts applications for the enterprise, authenticates agents, and securely transmits 
				applications to enrolled MDs. The MAS functionality can be included as part of the MDM server Software or can be logically
				distinct. If the MAS functionality is on a physically separate server, then the TOE is
				distributed with the MDM server and MAS server being 
				separate components.
        <h:br/>
        <h:br/>
        The
        <h:b>Subordinate MDM Server</h:b>
        is an optional, physically separate, server that sits between a primary MDM server and an MDM agent on a managed device. The purpose of the subordinate MDM server is to forward signed policy files from a primary MDM server to an MDM agent on a managed device for which the subordinate MDM is responsible. The subordinate MDM server can either directly pass these signed policies to the managed device, or can interpret the policy into a different format if necessary. This interpretation process will follow well defined rules to ensure that the resulting interpreted policy matches the actions defined in the original policy. This interpreted policy is signed by the subordinate MDM server for delivery to the MDM agent. Any alerts or notifications generated by an MDM agent will be passed by the subordinate MDM server back to the primary MDM server to alert the enterprise administrators.
        <h:br/>
        <h:br/>
        <figure entity="images/SubordinateMDMSystem.png" title="MDM System with Subordinate MDM" id="subordinateMDMDiagram"/>
        <h:br/>
        <h:br/>
      </sec:TOE_Boundary>
    </section>
    <sec:Use_Cases>
      This PP defines four use cases:
      <h:br/>
      <usecases>
        <usecase title="Enterprise-owned device for general-purpose enterprise use" id="uc1">
          <description>An enterprise-owned device for general-purpose business use is commonly
						called Corporate-Owned, Personally-Enabled (COPE). This use case entails a significant
						degree of enterprise control over configuration and software inventory. Enterprise
						administrators use an MDM product to establish policies on the MDs prior to user issuance. Users may use internet connectivity to browse the web, access corporate mail, or run enterprise 
						applications, but this connectivity may be under
						significant control of the enterprise. The user may also be expected to store data and
						use applications for personal, non-enterprise use. The enterprise administrator uses the
						MDM product to deploy security policies and query MD
						status. The MDM may issue commands for remediation
						actions.</description>
        </usecase>
        <usecase title="Enterprise-owned device for specialized, high-security use" id="uc2">
          <description>An enterprise-owned device with intentionally limited network connectivity, tightly controlled configuration,
						and limited software inventory is appropriate for specialized, high-security use cases. As in the previous use case, the MDM
						product is used to establish such policies on MDs prior to issuance to users. The device may not be permitted
						connectivity to any external
						peripherals. It may only be able to communicate via its Wi-Fi or cellular radios with
						the enterprise-run network, which may not even permit connectivity to the internet. Use
						of the device may require compliance with usage policies that are more restrictive than
						those in any general-purpose use case, yet may mitigate risks to highly sensitive
						information. Based on the operational environment and the acceptable risk level of the
						enterprise, those security functional requirements outlined in Section 5 of this
						PP along with the selections in the Use Case 2 template defined in
						Appendix G are sufficient for the high-security use case.</description>
        </usecase>
        <usecase title="Personally-owned device for personal and enterprise use" id="uc3">
          <description>
            A personally-owned device which is used for both personal activities and
						enterprise data is commonly called Bring Your Own Device (BYOD). The device may be
						provisioned for access to enterprise resources after significant personal usage has
						occurred. Unlike in the enterprise-owned cases, the enterprise is limited in what
						security policies it can enforce because the user purchased the device primarily for
						personal use and is unlikely to accept policies that limit the functionality of the
						device.
            <h:br/>
            <h:br/>
            However, because the enterprise allows the user full (or nearly full)
						access to the enterprise network, the enterprise will require certain security policies,
						for example a password or screen lock policy and health reporting, such as the
						integrity of the MD system software, before allowing access. The
						administrator of the MDM can establish remediation actions, such as
						wipe of the enterprise data, for non-compliant devices. These controls could potentially
						be enforced by a separation mechanism built-in to the device itself to distinguish
						between enterprise and personal activities, or by a third-party application that
						provides access to enterprise resources and leverages security capabilities provided by
						the MD. Based on the operational environment and the acceptable risk level
						of the enterprise, those security functional requirements outlined in Section 5 of this
						PP along with the selections in the Use Case 3 template defined in
						Appendix G are sufficient for the secure implementation of this BYOD use case.
          </description>
        </usecase>
        <usecase title="Personally-owned device for personal and limited enterprise use" id="uc4">
          <description>A personally-owned device may also be given access to limited enterprise services such as enterprise email. The enterprise may not
						need to enforce any security policies on this device because the user does not have full access to the enterprise or enterprise data.
						However, the enterprise may want secure email and web browsing with assurance that the services being provided to those clients by the
						device are not compromised. Based on the operational environment and the acceptable risk level of the enterprise, those security
						functional requirements outlined in Section 5 of this PP are sufficient for the secure implementation of this BYOD use case.</description>
        </usecase>
      </usecases>
    </sec:Use_Cases>
    <section title="Package Usage" id="package-usage">
      This section contains selections and assignments that are required when the listed Functional Packages are claimed by this PP.
      <package-usage-list>
        <package-usage ref="X509">
          <usage id="usage-x509-verify-required" title="Certificate Verification Required in FIA_XCU_EXT.1.1">
            <description>The ST author shall select the option to verify identities in certificates in FIA_XCU_EXT.1.1. If the TOE implements a certificate authority, the ST author shall select the option to assert identities in certificates.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-nosmime-cert-profile" title="Restrictions on Certificate Functions in FDP_CER_EXT.1.1/OLTLeaf">
            <description>This usage requirement applies only if the TOE implements a certificate authority. The PP does not define S/MIME functionality, therefore the ST author shall not select the option to implement a certificate profile supporting this protocol.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-nosmime-cert-eku" title="Restrictions on Certificate Functions in FDP_CER_EXT.1.2/OLTLeaf">
            <description>This usage requirement applies only if the TOE implements a certificate authority. The PP does not define S/MIME functionality, therefore the ST author shall not select the option to set extendedKeyUsage bits for email protection.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-status-gen-required" title="Generation of Certificate Status Required in FDP_CSIR_EXT.1.1">
            <description>This usage requirement applies only if the TOE implements a certificate authority. The ST author shall only select the option to generate certificate status information in FDP_CSIR_EXT.1.1.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-ocsp-sigalgs" title="Restrictions on Signature Algorithms in FDP_OCSP_EXT.1.1">
            <description>This usage requirement applies only if the TOE implements a certificate authority. The TOE must use CNSA-compliant signature algorithms. Thus, the ST author shall not select the use of SHA-512 or secp521 for OCSP response signatures.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-distributed-iterations" title="Required Iteration Names for FIA_X509_EXT.1">
            <description>A TOE may utilize FIA_X509_EXT.1 as defined in the package in two different manners in this PP. Use of the requirement for validating X.509 certificates presented from outside the TOE boundary shall be iterated as FIA_X509_EXT.1/External. 
              Use of the requirement for validating X.509 certificates presented between components of a distributed TOE shall be iterated as FIA_X509_EXT.1/Internal.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-revocation-sigalgs" title="Limitations on Signature Algorithms in FIA_X509_EXT.1.1">
            <description>This usage requirement applies to both internal and external iterations of FIA_X509_EXT.1. The TOE must use CNSA-compliant signature algorithms. Thus, the ST author shall select no other algorithms outside of those specified in RFC 8603 for certificate or CRL signatures. 
              Additionally, the TOE shall not use ECDSA with SHA-512 signatures for OCSP responses, and shall utilize no other algorithms for OCSP responses.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-extensions" title="Required Extension Processing for FIA_X509_EXT.1.2">
            <description>This usage requirement applies to both internal and external iterations of FIA_X509_EXT.1. The ST author shall select the options to process the basicConstraints and extendedKeyUsage extensions. Other extensions may be selected as appropriate without restriction.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-revocation-methods" title="Restrictions on Revocation Functionality for FIA_X509_EXT.1.3">
            <description>
              This usage requirement applies in different manners to the different iterations of FIA_X509_EXT.1.
              <h:br/>
              For the external iteration of FIA_X509_EXT.1, the ST author shall select only from options involving CRL or OCSP in FIA_X509_EXT.1.3.
              <h:br/>
              For the internal iteration of FIA_X509_EXT.1, the ST author shall not select the option to validate certificate revocation status by validity period. Other selections may be selected without restriction.
            </description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-revocation-connections" title="Restrictions on Revocation Information Retrieval for FIA_X509_EXT.1.4">
            <description>
              This usage requirement applies in different manners to the different iterations of FIA_X509_EXT.1.
              <h:br/>
              For the external iteration of FIA_X509_EXT.1, the ST author shall not select to not obtain revocation status information for any reason, utilize local revocation information or utilize a network connection directly to a CA. Revocation information must be 
              retrieved via an option involving CRL or OCSP.
              <h:br/>
              For the internal iteration of FIA_X509_EXT.1, the ST author shall not select the option to determine that the certificate expires within a certain period.
            </description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-eku-values" title="Restrictions on Acceptable Key Usage Values for FIA_X509_EXT.1.5">
            <description>This usage requirement applies to both internal and external iterations of FIA_X509_EXT.1. The ST author shall not select the option to pass certificate information to supported functions and shall select the option to verify certificates by evaluating the 
              extendedKeyUsage field in the leaf certificate. The ST author shall additionally not select the option to validate certificates against any rules for S/MIME.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-functions" title="Restrictions on Acceptable Functions for FIA_X509_EXT.2.1">
            <description>The ST author shall not select options that utilize the S/MIME protocol.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
        </package-usage>
      </package-usage-list>
    </section>
  </sec:Introduction>
  <sec:Conformance_Claims title="Conformance Claims" id="ccl" boilerplate="no">
    <CClaimsInfo cc-version="cc-2022r1" cc-approach="direct-rationale">
      <cc-st-conf>exact</cc-st-conf>
      <cc-pt2-conf>extended</cc-pt2-conf>
      <cc-pt3-conf>conformant</cc-pt3-conf>
      <cc-pp-conf/>
      <cc-pp-config-with>
        <PP-cc-ref>Protection Profile for Mobile Device Fundamentals, Version 4.0</PP-cc-ref>
        <PP-cc-ref>Protection Profile for Application Software, Version 2.0</PP-cc-ref>
        <Mod-cc-ref>PP-Module for MDM Agents, Version 2.0</Mod-cc-ref>
        <Mod-cc-ref>PP-Module for VPN Client, Version 3.0</Mod-cc-ref>
      </cc-pp-config-with>
      <cc-pkg-claim>
        <FP-cc-ref conf="conformant">Functional Package for SSH, Version 2.0</FP-cc-ref>
        <FP-cc-ref conf="conformant">Functional Package for TLS, Version 2.1</FP-cc-ref>
        <FP-cc-ref conf="conformant">Functional Package for X.509, Version 1.0</FP-cc-ref>
      </cc-pkg-claim>
    </CClaimsInfo>
  </sec:Conformance_Claims>
  <section title="Introduction to Distributed TOEs" id="idt">
    This PP includes support for distributed MDM TOEs. MDMs can sometimes be composed of multiple components operating as a logical whole. Frequently we
		see this architecture when dealing with products hosted in the cloud and offered as Software as a Service. There are a number of different
		architectures; but fundamentally, they are variations of the following model where the SFRs of this PP can only be fulfilled if the components 
		are deployed and operate together. To be considered a distributed TOE, a minimum of two interconnected components are required.
    <section title="Registration of Distributed TOE Components" id="rcd">
      When dealing with a distributed TOE, a number of separate components need to be brought together in the operational environment in order to create the TOE.
			This requires that trusted communications channels are set up between certain pairs of components (it is assumed that all components need to
			communicate with at least one other component, but not that all components need to communicate with all other components). The underlying model for
			creation of the TOE is to have a "registration process" in which components "join" the TOE. The registration
			process starts with two components, one of which (the "joiner") is about to join an existing TOE by registering with the other
			(the "gatekeeper"). The two components will use one or more specified authentication and communication channel options so that the components
			authenticate each other and protect any sensitive data that is transmitted during the registration process (e.g., a key might be sent by a gatekeeper 
			to the joiner as a result of the registration). The following figures illustrate the three supported registration models.
      <xref to="DTF1"/>
      illustrates a
			distributed TOE registration approach which uses an instance of FPT_ITT.1/INTER_XFER / FPT_ITT.1/INTER_XFER_AGENT or
			FTP_ITC.1/INTER_XFER_IT to protect the registration exchange.
      <h:br/>
      <h:br/>
      <figure entity="images/DistributedToeFig1.png" pre="Figure " title="Distributed TOE registration using channel satisfying FPT_ITT.1/INTER_XFER / FPT_ITT.1/INTER_XFER_AGENT or FTP_ITC.1/INTER_XFER_IT" id="DTF1"/>
      <h:br/>
      <h:br/>
      The second approach (<xref to="DTF2"/>) uses an alternative registration channel and supports use cases where the channel relies on environmental security
			constraints to provide the necessary protection of the registration exchange.
      <h:br/>
      <h:br/>
      <figure entity="images/DistributedToeFig2.png" pre="Figure " title="Distributed TOE registration using channel satisfying FTP_TRP.1/TRUSTPATH_JOIN" id="DTF2"/>
      <h:br/>
      <h:br/>
      The final approach (<xref to="DTF3"/>) supports use cases where registration is performed manually through direct configuration of both the Joiner and Gatekeeper 
			devices. Once configured, the two components establish an internal TSF channel that satisfies
			FPT_ITT.1/INTER_XFER / FPT_ITT.1/INTER_XFER_AGENT or FTP_ITC.1/INTER_XFER_IT.
      <h:br/>
      <h:br/>
      <figure entity="images/DistributedToeFig3.png" pre="Figure " title="Distributed TOE registration without a registration channel" id="DTF3"/>
      <h:br/>
      <h:br/>
      In each case, during the registration process, the administrator must positively enable the joining components before it can act as part of the TSF.
      <xref to="DTF4"/>
      illustrates the approaches that this enablement step may take;
      <h:br/>
      <h:br/>
      <figure entity="images/DistributedToeFig4.png" pre="Figure " title="Joiner enablement options for Distributed TOEs" id="DTF4"/>
      <h:br/>
      <h:br/>
      Note that in the case where no registration channel is required, that is the joiner and gatekeeper are directly configured (<xref to="DTF3"/>), enablement is
			implied as part of this direct configuration process.
      <h:br/>
      <h:br/>
      After registration, the components will communicate between themselves using a normal SSH, TLS, DTLS, IPsec, or HTTPS channel (which is specified in an ST as 
			an instance of FPT_ITT.1/INTER_XFER / FPT_ITT.1/INTER_XFER_AGENT or FTP_ITC.1/INTER_XFER_IT in
			terms of
      <xref to="req"/>
      and
      <xref g="t-audit-optional"/>). This channel for
			inter-component communications is specified at the top level with the new (extended) SFR FCO_CPC_EXT.1 and is in addition to the other communication 
			channels required for communication with entities outside the TOE (which are specified in an ST as instances of FTP_ITC.1/INTER_XFER_IT and 
			FTP_TRP.1/TRUSTPATH_REM_ADMIN.
    </section>
    <section title="Allocation of Requirements in Distributed TOEs" id="ard">
      For a distributed TOE, the security functional requirements in this PP need to be met by the TOE as a whole, but not all SFRs will necessarily be 
			implemented by all components. The following categories are defined in order to specify when each SFR must be implemented by a component:
      <h:br/>
      <h:ul>
        <h:li><h:b>All Components ("All")</h:b> - All components that comprise the distributed TOE must independently satisfy the requirement.</h:li>
        <h:li><h:b>At least one Component ("One")</h:b> - This requirement must be fulfilled by at least one component within the distributed TOE.</h:li>
        <h:li>
          <h:b>Feature Dependent ("Feature Dependent")</h:b>
          - These requirements will only be fulfilled where the feature is implemented by the
				distributed TOE component (note that the requirement to meet the PP as a whole requires that at least one component implements these
				requirements if they are specified in
          <xref to="req"/>).
        </h:li>
      </h:ul>
      <xref to="distTOE"/>
      specifies how each of the SFRs in this PP must be met, using the categories above.
      <h:br/>
      <h:br/>
      <h:b>
        <ctr ctr-type="Table" pre="Table " id="distTOE">: Security Functional Requirements for Distributed TOEs</ctr>
      </h:b>
      <h:table>
        <h:TR>
          <h:TD>
            <h:b>Requirement</h:b>
          </h:TD>
          <h:TD>
            <h:b>Description</h:b>
          </h:TD>
          <h:TD>
            <h:b>Distributed TOE SFR Allocation</h:b>
          </h:TD>
        </h:TR>
        <h:tr>
          <h:td>FAU_ALT_EXT.1</h:td>
          <h:td>Server Alerts</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_CRP_EXT.1</h:td>
          <h:td>Support for Compliance Reporting of Mobile Device Configuration</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_GEN.1/AUDITGEN</h:td>
          <h:td>Audit Data Generation</h:td>
          <h:td>All</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_GEN.1/MAS_SERVER</h:td>
          <h:td>Audit Data Generation</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_NET_EXT.1</h:td>
          <h:td>Network Reachability Review</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_SAR.1</h:td>
          <h:td>Audit Review</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_SEL.1</h:td>
          <h:td>Security Audit Event Selection</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_STG.1</h:td>
          <h:td>External Trail Storage</h:td>
          <h:td>All</h:td>
        </h:tr>
        <h:tr>
          <h:td>FAU_STG.2</h:td>
          <h:td>Audit Event Storage</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCO_CPC_EXT.1</h:td>
          <h:td>Communication Partner Control</h:td>
          <h:td>All</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_CKM.1/AKG</h:td>
          <h:td>Cryptographic Key Generation - Asymmetric Key</h:td>
          <h:td>All</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_CKM.1/SKG</h:td>
          <h:td>Cryptographic Key Generation - Symmetric Key</h:td>
          <h:td>All</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_CKM.2</h:td>
          <h:td>Cryptographic Key Establishment</h:td>
          <h:td>All</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_CKM.6</h:td>
          <h:td>Cryptographic Key Destruction</h:td>
          <h:td>All</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_CKM_EXT.7</h:td>
          <h:td>Cryptographic Key Agreement</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_COP.1/Hash</h:td>
          <h:td>Cryptographic Operation - Hashing</h:td>
          <h:td>All</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_COP.1/KeyedHash</h:td>
          <h:td>Cryptographic Operation - Keyed Hash</h:td>
          <h:td>All</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_COP.1/KeyEncap</h:td>
          <h:td>Cryptographic Operation - Key Encapsulation</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_COP.1/KeyWrap</h:td>
          <h:td>Cryptographic Operation - Key Wrapping</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_COP.1/SigGen</h:td>
          <h:td>Cryptographic Operation - Signature Generation</h:td>
          <h:td>All</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_COP.1/SigVer</h:td>
          <h:td>Cryptographic Operation - Signature Verification</h:td>
          <h:td>All</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_COP.1/SKC</h:td>
          <h:td>Cryptographic Operation - Encryption/Decryption</h:td>
          <h:td>All</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_COP.1/XOF</h:td>
          <h:td>Cryptographic Operation - Extendable-Output Function</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_HTTPS_EXT.1</h:td>
          <h:td>HTTPS Protocol</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_IV_EXT.1</h:td>
          <h:td>Initialization Vector Generation</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_RBG.1</h:td>
          <h:td>Random Bit Generation (RBG)</h:td>
          <h:td>All</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_RBG.2</h:td>
          <h:td>Random Bit Generation (External Seeding)</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_RBG.3</h:td>
          <h:td>Random Bit Generation (Internal Seeding - Single Source)</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_RBG.4</h:td>
          <h:td>Random Bit Generation (Internal Seeding - Multiple Sources)</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_RBG.5</h:td>
          <h:td>Random Bit Generation (Combining Noise Sources)</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_STG_EXT.1</h:td>
          <h:td>Cryptographic Key Storage</h:td>
          <h:td>All</h:td>
        </h:tr>
        <h:tr>
          <h:td>FCS_STG_EXT.2</h:td>
          <h:td>Encrypted Cryptographic Key Storage</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FIA_CLI_EXT.1</h:td>
          <h:td>Client Authorization</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FIA_ENR_EXT.1</h:td>
          <h:td>Enrollment</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FIA_TOK_EXT.1</h:td>
          <h:td>Client Tokens</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FIA_UAU.1</h:td>
          <h:td>Timing of Authentication</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FIA_UAU.4</h:td>
          <h:td>Single-Use Authentication Mechanisms</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FMT_MOF.1/FUNCBE</h:td>
          <h:td>Management of functions behavior</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FMT_MOF.1/MANAGEMENT_ENROLL</h:td>
          <h:td>Management of functions behavior (Enrollment)</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FMT_MOF.1/MANAGEMENT_MAS</h:td>
          <h:td>Management of Functions in (MAS Server Downloads)</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FMT_POL_EXT.1</h:td>
          <h:td>Trusted Policy Update</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FMT_SAE_EXT.1</h:td>
          <h:td>Security Attribute Expiration</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FMT_SMF.1/MAS</h:td>
          <h:td>Specification of Management Functions (MAS Server)</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FMT_SMF.1/SERVER_CONF_AGENT</h:td>
          <h:td>Specification of Management Functions (Server configuration of Agent)</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FMT_SMF.1/SERVER_CONF_SERVER</h:td>
          <h:td>Specification of Management Functions (Server configuration of Server)</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FMT_SMR.1/SECMAN_ROLES</h:td>
          <h:td>Security Management Roles</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FMT_SMR.1/SECMAN_ROLES_MAS</h:td>
          <h:td>Security Management Roles</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FPT_API_EXT.1</h:td>
          <h:td>Use of Supported Services and APIs</h:td>
          <h:td>All</h:td>
        </h:tr>
        <h:tr>
          <h:td>FPT_FLS.1</h:td>
          <h:td>Failure with Preservation of Secure State</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FPT_ITT.1/INTER_XFER</h:td>
          <h:td>Internal TOE TSF Data Transfer</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FPT_ITT.1/INTER_XFER_AGENT</h:td>
          <h:td>Internal TOE TSF Data Transfer (MDM Agent)</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FPT_LIB_EXT.1</h:td>
          <h:td>Use of Third-Party Libraries</h:td>
          <h:td>All</h:td>
        </h:tr>
        <h:tr>
          <h:td>FPT_TST.1</h:td>
          <h:td>TSF Self-Testing</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FPT_TST_EXT.1</h:td>
          <h:td>Functionality Testing</h:td>
          <h:td>All (except for agent components)</h:td>
        </h:tr>
        <h:tr>
          <h:td>FPT_TUD_EXT.1</h:td>
          <h:td>Trusted Update</h:td>
          <h:td>All</h:td>
        </h:tr>
        <h:tr>
          <h:td>FTA_TAB.1</h:td>
          <h:td>Default TOE Access Banners</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FTP_ITC.1/INTER_TSF_XFER_AGENT</h:td>
          <h:td>Inter-TSF Trusted Channel (MDM Agent)</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FTP_ITC.1/INTER_XFER_IT</h:td>
          <h:td>Inter-TSF Trusted Channel (Authorized IT Entities)</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FTP_ITC_EXT.1</h:td>
          <h:td>Trusted Channel</h:td>
          <h:td>One</h:td>
        </h:tr>
        <h:tr>
          <h:td>FTP_TRP.1/TRUSTPATH_ENROLL</h:td>
          <h:td>Trusted Path for Enrollment</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FTP_TRP.1/TRUSTPATH_JOIN</h:td>
          <h:td>Trusted Path for Joining</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
        <h:tr>
          <h:td>FTP_TRP.1/TRUSTPATH_REM_ADMIN</h:td>
          <h:td>Trusted Path for Remote Administration</h:td>
          <h:td>Feature Dependent</h:td>
        </h:tr>
      </h:table>
      <h:br/>
      Only those SFRs included in the ST are required to be audited. The ST for a distributed TOE must include a mapping of SFRs to each of the components 
			of the TOE. (Note that this deliverable is examined as part of the ASE_TSS.1 and AVA_VAN.1 Evaluation Activities.) The ST for a distributed TOE 
			may also introduce a "minimum configuration" and identify components that may have instances added to an operational configuration without affecting 
			the validity of the CC certification. Appendix E describes Evaluation Activities relating to these equivalency aspects of a distributed TOE (and
			hence what is expected in the ST).
    </section>
    <section title="Security Audit for Distributed TOEs" id="dis">
      <h:br/>
      For distributed TOEs, the handling of audit information might be more complicated than for TOEs consisting only of one component.
			There are a few basic requirements to be fulfilled:
      <h:br/>
      <h:br/>
      <h:ul>
        <h:li>Every component must be able to generate audit information.</h:li>
        <h:li>Every component must be able to buffer audit information and forward it to another TOE component or an external audit server. Optionally,
			each component may store audit information locally.</h:li>
        <h:li>For the overall TOE it must be possible to send out audit information to an external audit server.</h:li>
      </h:ul>
      <h:br/>
      In general, every component must be able to generate its own audit information. It would be possible that every component also stores its own audit 
	      information locally as well as every component could be able to send out audit data to an external audit server. It would also be sufficient that
	      every component would be able to generate its own audit data and buffer it locally before the information is sent out to one or more other 
	      TOE components for local storage or transmission to an external audit server. For the transfer of audit records between TOE components 
	      the secure connection via FTP_ITC.1/INTER_XFER_IT or FPT_ITT.1/INTER_XFER / FPT_ITT.1/INTER_XFER_AGENT  must be used.
      <h:br/>
      <h:br/>
      Such a solution would still be suitable to fulfill the requirement that all audit-related SFRs have to be fulfilled by all TOE components,
	      although formally not every component would support local storage or transfer to an external audit server itself.
      <h:br/>
      <h:br/>
      Regarding the establishment of inter-TOE communication, error conditions as well as successful connection and tear-down events should be captured
	      by both ends of the connection.
      <h:br/>
      <h:br/>
      All TOE components shall be able to generate its own audit data according to FAU_GEN.1 for all SFRs that it implements. For distributed 
	      TOEs, a mapping shall be provided to show which auditable events according to FAU_GEN.1 are covered by which components (also giving a
	      justification that the records generated by each component cover all the SFRs that it implements). The overall TOE has to provide audit 
	      information about all events defined for FAU_GEN.1. As a result, at least one TOE component has to be assigned to every auditable event
	      defined for FAU_GEN.1. The part of the mapping related to
      <xref g="t-audit-mandatory"/>
      shall be consistent with the mapping of SFRs to 
	      TOE components for ASE_TSS.1 in the sense that all components defined as generating audit information for a particular SFR should also contribute 
	      to that SFR in the mapping for ASE_TSS.1. This applies not only to audit events defined for mandatory SFRs but also to all audit events for 
	      optional, selection-based, and objective SFRs as defined in
      <xref g="t-audit-optional"/>,
      <xref g="t-audit-objective"/>, and
      <xref g="t-audit-sel-based"/>.
      <h:br/>
      <h:br/>
      If one or more of the optional audit components FAU_STG.1 or FAU_STG.2 are selected in the ST derived from this PP, then the SFR
	      mapping for ASE_TSS.1 must include a specific identification of the TOE components to which they apply.
    </section>
  </section>
  <!-- 3.0 Security Problem Definition-->
  <sec:Security_Problem_Definition>
    <!-- 3.1 Threats -->
    <sec:Threats>
      <threats>
        <threat name="T.MALICIOUS_APPS">
          <description>Malicious or flawed application threats exist because apps loaded onto anMD may include malicious or exploitable code. An administrator of the MDM or MD usermay inadvertently import malicious code, or an attacker may insert malicious code into the TOE, resulting in thecompromise of TOE or TOE data.</description>
          <!-- New mapping to build updated threat mapping table. -->
          <addressed-by>FAU_ALT_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of malicious apps by generating an alert if application of a policy fails, as this may indicate that a mechanism used to prevent the execution of malicious apps was not able to be enforced.</rationale>
          <addressed-by>FAU_CRP_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of malicious apps by allowing MDs to report on their configuration status so it can be determined whether they have any unauthorized (and potentially malicious) apps installed.</rationale>
          <addressed-by>FAU_NET_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates this threat by providing network status information so that an inaccessible MD can be flagged as potentially non-conformant to an MDM policy (and therefore potentially subject to the threat of executing malicious apps)</rationale>
          <addressed-by>FCS_COP.1/Hash</addressed-by>
          <rationale>A conformant TOE mitigates the threat of malicious apps by implementing cryptographic algorithms which may be used to verify the integrity of apps (if the TOE includes its own MAS).</rationale>
          <addressed-by>FCS_COP.1/SigGen</addressed-by>
          <rationale>A conformant TOE mitigates the threat of malicious apps by generating asymmetric cryptographic keys to protect data in transit.</rationale>
          <addressed-by>FCS_COP.1/SigVer</addressed-by>
          <rationale>A conformant TOE mitigates the threat of malicious apps by implementing cryptographic algorithms which may be used to verify the authenticity of apps (if the TOE includes its own MAS).</rationale>
          <addressed-by>FIA_ENR_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of malicious apps by providing a means to enroll MDs into management, where policies prohibiting the installation of potential malicious apps can be enforced.</rationale>
          <addressed-by>FIA_TOK_EXT.1 (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threats of malicious apps by providing a mechanism to securely enroll a unique MD into management.</rationale>
          <addressed-by>FIA_UAU.4 (Objective)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of malicious apps by limiting reuse of authentication credentials used to enroll MDs to provide assurance that MDs are properly enrolled into management.</rationale>
          <addressed-by>FMT_MOF.1/FUNCBE</addressed-by>
          <rationale>A conformant TOE mitigates the threat of malicious apps by implementing mechanisms to control the apps that can be installed on an enrolled MD.</rationale>
          <addressed-by>FMT_MOF.1/MANAGEMENT_MAS (Selection-based)</addressed-by>
          <rationale>A conformant TOE may mitigate the threat of malicious apps by implementing a MAS server that limits the apps that can be installed on enrolled MDs to those hosted by the TOE.</rationale>
          <addressed-by>FMT_POL_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of malicious apps by providing signed policy updates that can prohibit the execution of potentially malicious apps.</rationale>
          <addressed-by>FMT_SAE_EXT.1 (Objective)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of malicious apps by limiting the validity period of an enrollment request to provide assurance that MDs are properly enrolled into management.</rationale>
          <addressed-by>FMT_SMF.1/MAS (Selection-based)</addressed-by>
          <rationale>A conformant TOE may mitigate the threat of malicious apps by implementing a MAS server that limits the apps that can be installed on enrolled MDs to those hosted by the TOE.</rationale>
          <addressed-by>FMT_SMF.1/SERVER_CONF_AGENT</addressed-by>
          <rationale>A conformant TOE mitigates the threat of malicious apps by implementing mechanisms to control the apps that can be installed on an enrolled MD.</rationale>
          <addressed-by>FTP_ITC_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of malicious apps by communicating its policy data to enrolled MDs securely over a trusted channel.</rationale>
        </threat>
        <threat name="T.NETWORK_ATTACK">
          <description>An attacker may masquerade as an MDM server and attempt tocompromise the integrity of the MD by sending malicious management commands.</description>
          <!-- New mapping to build updated threat mapping table. -->
          <addressed-by>FAU_GEN.1/AUDITGEN</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by generating audit records of activity which may indicate attempts of such attacks.</rationale>
          <addressed-by>FAU_SAR.1 (Optional)</addressed-by>
          <rationale>A conformant TOE may mitigate the threat of network attack by implementing a mechanism within the TOE boundary to review audit data that may indicate attempted network attacks.</rationale>
          <addressed-by>FAU_SEL.1 (Optional)</addressed-by>
          <rationale>A conformant TOE may mitigate the threat of network attack by implementing a mechanism to specify the events that are audited by the TOE, which could include activities suggestive of a potential network attack.</rationale>
          <addressed-by>FAU_STG.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by retaining audit records of activity which may indicate attempts of such attacks.</rationale>
          <addressed-by>FAU_STG.2 (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by preventing unauthorized modification of locally stored audit records of activity which may indicate attempts of such attacks.</rationale>
          <addressed-by>FCO_CPC_EXT.1 (Objective)</addressed-by>
          <rationale>A conformant TOE may mitigate the threat of network attack by implementing a mechanism to register distributed TOE components so that individual endpoints are protected against impersonation.</rationale>
          <addressed-by>FCS_CKM_EXT.7 (Implementation-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of a network attack by implementing secure methods to perform key agreement for trusted communications.</rationale>
          <addressed-by>FCS_CKM.1/AKG</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by ensuring the generation of strong asymmetric keys used for trusted communications.</rationale>
          <addressed-by>FCS_CKM.1/SKG</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by ensuring the generation of strong symmetric keys used for trusted communications.</rationale>
          <addressed-by>FCS_CKM.2 (Implementation-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing secure key establishment functions that prevent impersonation of the TOE.</rationale>
          <addressed-by>FCS_CKM.6</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by securely destroying cryptographic keys to prevent their malicious reuse.</rationale>
          <addressed-by>FCS_COP.1/AEAD</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by enforcing the use of secure authenticated encryption algorithms when wireless functionality is implemented by the TOE.</rationale>
          <addressed-by>FCS_COP.1/Hash</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing hash algorithms to maintain integrity of data in transit.</rationale>
          <addressed-by>FCS_COP.1/KeyedHash</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing HMAC algorithms to maintain authenticity and integrity of data in transit.</rationale>
          <addressed-by>FCS_COP.1/KeyEncap (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of a network attack by using a secure key encapsulation method to transmit a symmetric key to a third party as part of key establishment for trusted communications.</rationale>
          <addressed-by>FCS_COP.1/KeyWrap (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of a network attack by using a secure key wrap method to distribute key material to a third party for use in trusted communications.</rationale>
          <addressed-by>FCS_COP.1/SigGen</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by generating strong asymmetric cryptographic keys to protect data in	transit.</rationale>
          <addressed-by>FCS_COP.1/SigVer</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by generating strong symmetric cryptographic keys to protect data in	transit.</rationale>
          <addressed-by>FCS_COP.1/SKC (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing encryption algorithms to maintain confidentiality of data in transit.</rationale>
          <addressed-by>FCS_COP.1/XOF (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of a network attack by supporting extendable output function implementations that are dependencies of some secure key generation and signature verification algorithms.</rationale>
          <addressed-by>FCS_HTTPS_EXT.1 (Selection-based)</addressed-by>
          <rationale>A conformant TOE may mitigate the threat of network attack by implementing the HTTPS protocol to protect data in transit.</rationale>
          <addressed-by>FCS_IV_EXT.1 (Selection-based)</addressed-by>
          <rationale>A conformant TOE may mitigate the threat of network attack by implementing functionality for appropriate IV generation based on the encryption algorithms it supports.</rationale>
          <addressed-by>FCS_RBG.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing a cryptographically strong DRBG to ensure generation of strong cryptographic keys.</rationale>
          <addressed-by>FCS_RBG.2 (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by using sufficient entropy data to seed its DRBG to ensure a uniform keyspace of cryptographic key generation.</rationale>
          <addressed-by>FCS_RBG.3 (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by using sufficient entropy data to seed its DRBG to ensure a uniform keyspace of cryptographic key generation.</rationale>
          <addressed-by>FCS_RBG.4 (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by using sufficient entropy data to seed its DRBG to ensure a uniform keyspace of cryptographic key generation.</rationale>
          <addressed-by>FCS_RBG.5 (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by using sufficient entropy data to seed its DRBG to ensure a uniform keyspace of cryptographic key generation.</rationale>
          <addressed-by>FCS_STG_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing protected storage for secret and private keys that must be stored persistently for use in trusted communications and in proving the authenticity of policy information.</rationale>
          <addressed-by>FCS_STG_EXT.2 (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by using a particular method to protect persistently stored key data used for network communications.</rationale>
          <addressed-by>FIA_CLI_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing a mechanism to ensure that the MD being enrolled is genuine.</rationale>
          <addressed-by>FIA_ENR_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing a mechanism to ensure that the MD is enrolled via a trusted channel.</rationale>
          <addressed-by>FMT_POL_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing a mechanism to ensure the authenticity of policies issued by the TOE.</rationale>
          <addressed-by>FPT_FLS.1 (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing a mechanism to fail into a secure state if it cannot generate strong random numbers.</rationale>
          <addressed-by>FPT_ITT.1/INTER_XFER (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing a protected channel to protect data in transit between separate parts of the TOE.</rationale>
          <addressed-by>FPT_ITT.1/INTER_XFER_AGENT (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing a protected channel to protect data in transit between separate parts of the TOE, specifically in the case where an MDM Agent is also part of the TOE.</rationale>
          <addressed-by>FPT_TST.1 (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing a mechanism to self-test its ability to generate strong random numbers.</rationale>
          <addressed-by>FTP_ITC_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by specifying the channels over which data in transit is protected.</rationale>
          <addressed-by>FTP_ITC.1/INTER_TSF_XFER_AGENT (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing a protected channel to protect data in transit between the TOE and an environmental MDM Agent.</rationale>
          <addressed-by>FTP_ITC.1/INTER_XFER_IT</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing a mechanism to protect data in transit between the TOE and external IT entities that support its operation.</rationale>
          <addressed-by>FTP_TRP.1/TRUSTPATH_ENROLL</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing a trusted path for enrollment of MDs.</rationale>
          <addressed-by>FTP_TRP.1/TRUSTPATH_JOIN (Objective)</addressed-by>
          <rationale>A conformant TOE may mitigate the threat of network attack by implementing a mechanism to securely join distributed TOE components to one another using a trusted path.</rationale>
          <addressed-by>FTP_TRP.1/TRUSTPATH_REM_ADMIN</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing a trusted path for remote administration.</rationale>
        </threat>
        <threat name="T.NETWORK_EAVESDROP">
          <description>An attacker is positioned on a communications channel or elsewhere on thenetwork infrastructure. Attackers may monitor and gain access to data exchangedbetween the MDM server and other endpoints.</description>
          <!-- New mapping to build updated threat mapping table. -->
          <addressed-by>FCS_CKM_EXT.7 (Implementation-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by ensuring that a third-party cannot obtain the key used by the TOE to communicate securely with a remote entity.</rationale>
          <addressed-by>FCS_CKM.1/AKG</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by implementing secure key generation functions that prevent impersonation of the TOE.</rationale>
          <addressed-by>FCS_CKM.1/SKG</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by implementing secure key generation functions that prevent impersonation of the TOE.</rationale>
          <addressed-by>FCS_CKM.2 (Implementation-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by implementing secure key establishment functions that prevent impersonation of the TOE.</rationale>
          <addressed-by>FCS_CKM.6</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by securely destroying cryptographic keys to prevent their malicious reuse.</rationale>
          <addressed-by>FCS_COP.1/AEAD</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by enforcing the use of a cryptographic algorithm to protect data in transit that includes assurance of both authenticity and confidentiality.</rationale>
          <addressed-by>FCS_COP.1/KeyEncap (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by using a key encapsulation algorithm to protect data in transit</rationale>
          <addressed-by>FCS_COP.1/KeyWrap (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by using a key wrap algorithm to protect data in transit.</rationale>
          <addressed-by>FCS_COP.1/SKC (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by implementing encryption algorithms to maintain confidentiality of data in transit.</rationale>
          <addressed-by>FCS_COP.1/XOF (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by supporting extendable output function implementations that are dependencies of algorithms used for protection of data in transit.</rationale>
          <addressed-by>FCS_HTTPS_EXT.1 (Selection-based)</addressed-by>
          <rationale>A conformant TOE may mitigate the threat of network eavesdrop by implementing the HTTPS protocol to protect data in transit.</rationale>
          <addressed-by>FCS_IV_EXT.1 (Selection-based)</addressed-by>
          <rationale>A conformant TOE may mitigate the threat of network eavesdrop by implementing functionality for appropriate IV generation based on the encryption algorithms it supports.</rationale>
          <addressed-by>FCS_RBG.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by implementing a cryptographically strong DRBG to ensure generation of strong cryptographic keys.</rationale>
          <addressed-by>FCS_RBG.2 (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by using sufficient entropy data to seed its DRBG to ensure a uniform keyspace of cryptographic key generation.</rationale>
          <addressed-by>FCS_RBG.3 (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by using sufficient entropy data to seed its DRBG to ensure a uniform keyspace of cryptographic key generation.</rationale>
          <addressed-by>FCS_RBG.4 (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by using sufficient entropy data to seed its DRBG to ensure a uniform keyspace of cryptographic key generation.</rationale>
          <addressed-by>FCS_RBG.5 (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by using sufficient entropy data to seed its DRBG to ensure a uniform keyspace of cryptographic key generation.</rationale>
          <addressed-by>FCS_STG_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by implementing protected storage for secret and private keys that must be stored persistently for use in trusted communications and in proving the authenticity of policy information.</rationale>
          <addressed-by>FCS_STG_EXT.2 (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by using a particular method to protect persistently stored key data used for network communications.</rationale>
          <addressed-by>FIA_ENR_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network attack by implementing a mechanism to ensure that the MD is enrolled via a trusted channel.</rationale>
          <addressed-by>FPT_FLS.1 (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by implementing a mechanism to fail into a secure state if it cannot generate strong random numbers.</rationale>
          <addressed-by>FPT_ITT.1/INTER_XFER (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by implementing a protected channel to protect data in transit between separate parts of the TOE.</rationale>
          <addressed-by>FPT_ITT.1/INTER_XFER_AGENT (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by implementing a protected channel to protect data in transit between separate parts of the TOE, specifically in the case where an MDM Agent is also part of the TOE.</rationale>
          <addressed-by>FPT_TST.1 (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by implementing a mechanism to self-test its ability to generate strong random numbers.</rationale>
          <addressed-by>FTP_ITC_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by specifying the channels over which data in transit is protected.</rationale>
          <addressed-by>FTP_ITC.1/INTER_TSF_XFER_AGENT (Selection-based)</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by implementing a protected channel to protect data in transit between the TOE and an environmental MDM Agent.</rationale>
          <addressed-by>FTP_ITC.1/INTER_XFER_IT</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by implementing a mechanism to protect data in transit between the TOE and external IT entities that support its operation.</rationale>
          <addressed-by>FTP_TRP.1/TRUSTPATH_ENROLL</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by implementing a trusted path for enrollment of MDs.</rationale>
          <addressed-by>FTP_TRP.1/TRUSTPATH_JOIN (Objective)</addressed-by>
          <rationale>A conformant TOE may mitigate the threat of network eavesdrop by implementing a mechanism to securely join distributed TOE components to one another using a trusted path.</rationale>
          <addressed-by>FTP_TRP.1/TRUSTPATH_REM_ADMIN</addressed-by>
          <rationale>A conformant TOE mitigates the threat of network eavesdrop by implementing a trusted path for remote administration.</rationale>
        </threat>
        <threat name="T.PHYSICAL_ACCESS">
          <description>The MD may be lost or stolen, and an unauthorized individual mayattempt to access user data. Although these attacks are primarily directed against theMD platform, the TOE configures features on MDs that mitigate the this threat against them. Therefore, misuse or failure of the TOE may also compromise the MD, exposing it to this threat.</description>
          <!-- New mapping to build updated threat mapping table. -->
          <addressed-by>FAU_ALT_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of physical access to the MD by generating an alert when a MD is unable to receive policy information or has its enrollment status altered (e.g. unenrollment may be evidence of physical compromise).</rationale>
          <addressed-by>FAU_GEN.1/AUDITGEN</addressed-by>
          <rationale>A conformant TOE mitigates the threat of physical access to the MD by generating audit records of the management activities performed on the TOE that are applied to that device.</rationale>
          <addressed-by>FAU_GEN.1/MAS_SERVER (Selection-based)</addressed-by>
          <rationale>A conformant TOE potentially mitigates the threat of physical access to the MD by providing a mechanism on the TOE that logs a failure of the TSF to affect an enrolled MD's installed apps.</rationale>
          <addressed-by>FAU_SAR.1 (Optional)</addressed-by>
          <rationale>A conformant TOE potentially mitigates the threat of physical access to the MD by providing a review mechanism for audit records of the management activities performed on the TOE that are applied to that device (to detect potential misconfiguration of the device).</rationale>
          <addressed-by>FAU_SEL.1 (Optional)</addressed-by>
          <rationale>A conformant TOE potentially mitigates the threat of physical access to the MD by providing a mechanism to specify audit records of the specific management activities performed on the TOE that are applied to that device (to detect potential misconfiguration of the device).</rationale>
          <addressed-by>FAU_STG.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of physical access to the MD by retaining audit logs that may indicate potential misuse of the TOE to misconfigure a MD.</rationale>
          <addressed-by>FAU_STG.2 (Selection-based)</addressed-by>
          <rationale>A conformant TOE potentially mitigates the threat of physical access to the MD by providing a mechanism on the TOE that protects audit records of configuration of that device from unauthorized modification or destruction.</rationale>
          <addressed-by>FIA_UAU.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of physical access to the MD by enforcing user authentication on the TOE so that MDs cannot be configured without authorization.</rationale>
          <addressed-by>FMT_MOF.1/FUNCBE</addressed-by>
          <rationale>A conformant TOE mitigates the threat of physical access to the MD by implementing management functions that allow for the TOE to place it into a secure configuration.</rationale>
          <addressed-by>FMT_MOF.1/MANAGEMENT_ENROLL</addressed-by>
          <rationale>A conformant TOE mitigates the threat of physical access to the MD by implementing management functions that allow for the TOE to place it into a secure configuration.</rationale>
          <addressed-by>FMT_MOF.1/MANAGEMENT_MAS (Selection-based)</addressed-by>
          <rationale>A conformant TOE potentially mitigates the threat of physical access to the MD by implementing management functions that allow for the TOE to download and install applications.</rationale>
          <addressed-by>FMT_SMF.1/MAS (Selection-based)</addressed-by>
          <rationale>A conformant TOE potentially mitigates the threat of physical access to the MD by implementing management functions for its MAS Server functionality that allow the TSF to securely configure enrolled devices.</rationale>
          <addressed-by>FMT_SMF.1/SERVER_CONF_AGENT</addressed-by>
          <rationale>A conformant TOE mitigates the threat of physical access to the MD by implementing management functions that allow for the TOE to place it into a secure configuration.</rationale>
          <addressed-by>FMT_SMF.1/SERVER_CONF_SERVER</addressed-by>
          <rationale>A conformant TOE mitigates the threat of physical access to the MD by implementing management functions that allow the TSF to ensure its own secure operation with respect to applying policies.</rationale>
          <addressed-by>FMT_SMR.1/SECMAN_ROLES</addressed-by>
          <rationale>A conformant TOE mitigates the threat of physical access to the MD by implementing roles for its own management that allow the TSF to ensure its own secure operation with respect to applying policies.</rationale>
          <addressed-by>FMT_SMR.1/SECMAN_ROLES_MAS (Selection-based)</addressed-by>
          <rationale>A conformant TOE potentially mitigates the threat of physical access to the MD by implementing roles for its own management that allow the TSF to ensure its own secure operation with respect to applying MAS Server policies.</rationale>
          <addressed-by>FPT_API_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of physical access to the MD by ensuring that the TSF is not subject to compromise through improper API usage.</rationale>
          <addressed-by>FPT_LIB_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of physical access to the MD by ensuring that the TSF is not subject to compromise through insecure library usage.</rationale>
          <addressed-by>FPT_TST_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of physical access to the MD by ensuring that the TSF performs self-tests to verify its own integrity so that it can be trusted as a management platform.</rationale>
          <addressed-by>FPT_TUD_EXT.1</addressed-by>
          <rationale>A conformant TOE mitigates the threat of physical access to the MD by ensuring that the TSF uses a trusted update mechanism to verify its own integrity so that it can be trusted as a management platform.</rationale>
          <addressed-by>FTA_TAB.1 (Optional)</addressed-by>
          <rationale>A conformant TOE potentially mitigates the threat of physical access to the MD by providing a mechanism on the TOE that advises of actionable consequences for its misuse in configuration of MDs.</rationale>
        </threat>
      </threats>
    </sec:Threats>
    <!-- 3.2 Assumptions -->
    <sec:Assumptions>
      <assumptions>
        <assumption name="A.COMPONENTS_RUNNING">
          <description>This assumption applies to distributed TOEs only.
						For distributed TOEs, it is assumed that the availability of all TOE components is checked as
						appropriate to reduce the risk of an undetected attack on (or failure of) one or more TOE components. It is also assumed that in addition to the
						availability of all components it is also checked as appropriate that the audit functionality is running properly on all TOE components.</description>
          <objective-refer ref="OE.COMPONENTS_RUNNING">
            <rationale>The operational environment objective OE.COMPONENTS_RUNNING is realized through A.COMPONENTS_RUNNING.</rationale>
          </objective-refer>
        </assumption>
        <assumption name="A.CONNECTIVITY">
          <description>The TOE relies on network connectivity to carry out its
						management activities. The TOE will robustly handle instances when
						connectivity is unavailable or unreliable.</description>
          <objective-refer ref="OE.WIRELESS_NETWORK">
            <rationale>The operational environment objective OE.WIRELESS_NETWORK is realized through
							A.CONNECTIVITY.</rationale>
          </objective-refer>
        </assumption>
        <assumption name="A.MDM_SERVER_PLATFORM">
          <description>
            The MDM server relies on a trustworthy platform and
						local network from which it provides administrative capabilities.
            <h:br/>
            <h:br/>
            The MDM server relies on this platform to provide a range of
						security-related services including reliable timestamps, user and group account
						management, logon and logout services via a local or network directory service, remote
						access control, and audit log management services to include offloading of audit logs to
						other servers. The platform is expected to be configured specifically to provide 
						MDM services, employing features such as a host-based firewall, which
						limits its network role to providing MDM functionality.
          </description>
          <objective-refer ref="OE.TIMESTAMP">
            <rationale>The operational environment objective OE.TIMESTAMP is realized through A.MDM_SERVER_PLATFORM.</rationale>
          </objective-refer>
        </assumption>
        <assumption name="A.PROPER_ADMIN">
          <description>One or more competent, trusted personnel who are not careless, willfully
						negligent, or hostile, are assigned and authorized as the TOE
						Administrators, and do so using and abiding by guidance documentation.</description>
          <objective-refer ref="OE.PROPER_ADMIN">
            <rationale>The operational environment objective OE.PROPER_ADMIN is realized through
							A.PROPER_ADMIN.</rationale>
          </objective-refer>
        </assumption>
        <assumption name="A.PROPER_USER">
          <description>MD users are not willfully negligent or hostile, and use the
						device within compliance of a reasonable enterprise security policy.</description>
          <objective-refer ref="OE.PROPER_USER">
            <rationale>The operational environment objective OE.PROPER_USER is realized through
							A.PROPER_USER.</rationale>
          </objective-refer>
        </assumption>
      </assumptions>
    </sec:Assumptions>
    <!-- 3.3 Organizational Security Policies -->
    <sec:Organizational_Security_Policies>
      <OSPs>
        <OSP name="P.ACCOUNTABILITY">
          <description>Personnel operating the TOE shall be accountable for their actions within the TOE.</description>
        </OSP>
        <OSP name="P.ADMIN">
          <description>The configuration of the MD security functions must adhere to the
						enterprise security policy.</description>
          <objective-refer ref="OE.PROPER_ADMIN">
            <rationale>The organizational security policy P.ADMIN is realized through
							OE.PROPER_ADMIN.</rationale>
          </objective-refer>
        </OSP>
        <OSP name="P.DEVICE_ENROLL">
          <description>A MD must be enrolled for a specific user by the administrator of
						the MDM prior to being used in the enterprise network by the user.</description>
          <objective-refer ref="OE.IT_ENTERPRISE">
            <rationale>The organizational security policy P.DEVICE_ENROLL is realized through
							OE.IT_ENTERPRISE.</rationale>
          </objective-refer>
        </OSP>
        <OSP name="P.NOTIFY">
          <description>The MD user must immediately notify the administrator if a MD
						is lost or stolen so that the administrator may apply remediation actions via the 
						MDM system.</description>
          <objective-refer ref="OE.PROPER_USER">
            <rationale>The organizational security policy P.NOTIFY is realized through
							OE.PROPER_USER.</rationale>
          </objective-refer>
        </OSP>
      </OSPs>
    </sec:Organizational_Security_Policies>
  </sec:Security_Problem_Definition>
  <!-- 4.0 Security Objectives -->
  <sec:Security_Objectives>
    <!-- 4.1 Security Objectives for the TOE -->
    <!-- 4.2 Security Objctives for the Operational Environment -->
    <sec:Security_Objectives_for_the_Operational_Environment>
      <SOEs>
        <SOE name="OE.COMPONENTS_RUNNING">
          <description>For distributed TOEs, the administrator ensures that the availability of every TOE component is checked as appropriate to reduce the 
		  risk of an undetected attack on (or failure of) one or more TOE components. The administrator also ensures that it is checked as appropriate 
		  for every TOE component that the audit functionality is running properly.</description>
        </SOE>
        <SOE name="OE.IT_ENTERPRISE">
          <description>The enterprise IT infrastructure provides security for a network that is available to the TOE and MDs that prevents 
		  unauthorized access.</description>
        </SOE>
        <SOE name="OE.PROPER_ADMIN">
          <description>TOE Administrators are trusted to follow and apply all administrator guidance in a trusted manner.</description>
        </SOE>
        <SOE name="OE.PROPER_USER">
          <description>Users of the MD are trained to securely use the MD and apply all guidance in a trusted manner.</description>
        </SOE>
        <SOE name="OE.TIMESTAMP">
          <description>Reliable timestamps is provided by the operational environment for the TOE.</description>
        </SOE>
        <SOE name="OE.WIRELESS_NETWORK">
          <description>A wireless network will be available to the MDs.</description>
        </SOE>
      </SOEs>
    </sec:Security_Objectives_for_the_Operational_Environment>
    <!-- 4.3 Security Objectives Rationale -->
    <sec:Security_Objectives_Rationale/>
  </sec:Security_Objectives>
  <!-- 5.0 Security Requirements -->
  <sec:req title="Security Requirements">
    <h:br/>
    <h:br/>
    For a distributed TOE, the ST author should reference
    <xref to="distTOE"/>
    for guidance on how each SFR should be met. The table details whether
		SFRs should be met by all TOE components, by at least one TOE component or whether they are dependent on the feature being implemented by the
		TOE component. The ST for a distributed TOE must include a mapping of SFRs to each of the components of the TOE. (Note that this deliverable 
		is examined as part of the ASE_TSS.1 and AVA_VAN.1 Evaluation Activities.)
    <h:br/>
    <h:br/>
    <h:b>Test Environment for Evaluation Activities</h:b>
    <h:p/>
    As described in the evaluation activities below, the ST for an MDM system is required to list all the supported MDM agents and MD platforms with which
			an MDM server operates. The identified evaluation activities for testing that includes the use of an agent should be completed for each MDM agent
			and platform listed in the ST.
    <h:br/>
    <h:br/>
    The evaluator's activities for testing that include use of an agent will ensure that the Server interacts appropriately with the agent (i.e., sends a
			policy update to the agent), but will not ensure that the agent handles the received data correctly (i.e., appropriately applies the policy to the 
			device), as that is accounted for in the Evaluation Activities in the Mobile Device Fundamentals PP or the PP-Module for Mobile Device Management
			Agents.
    <h:br/>
    <h:br/>
    In addition to the above guidance, if the TOE server acts as a primary MDM server and interfaces with one or more subordinate MDM servers, then the ST 
  	  is required to list all of the supported subordinate MDM servers. All evaluation activity testing that includes the use of a subordinate MDM server should
  	  be completed for each of the subordinate MDM servers listed in the ST. MDM Agent testing should be done for devices managed directly by the primary MDM 
  	  Server, MDM Agent testing with a subordinate MDM server will be done during the subordinate MDM server evaluation. If the TOE server acts as a subordinate
  	  MDM server and interfaces with one or more primary MDM servers, then the ST is required to list all of the supported primary MDM servers, along with all
  	  of the supported MDM agents and MD platforms with which it operates. A test primary MDM server may be used for evaluation activity testing that requires
  	  the use of a primary MDM server. For clarification purposes "primary MDM server" and "subordinate MDM server" will be specified when the distinction is 
  	  necessary and relevant to explanations and testing, otherwise "MDM server" may be used when the distinction is not necessary and could reference either 
  	  a primary MDM server or subordinate MDM server.
    <!-- 5.1 Security Functional Requirements-->
    <sec:SFRs title="Security Functional Requirements">
      <section id="ss-audit-table" title="Auditable Events for Mandatory SFRs">
        <h:br/>
        <audit-table id="t-audit-mandatory" table="mandatory"/>
      </section>
      <!-- 5.1.1 Security Audit (FAU) -->
      <section id="fau" title="Security Audit (FAU)">
        <ext-comp-def title="Server Alerts" fam-id="FAU_ALT_EXT">
          <fam-behavior>This family defines requirements for the TSF to alert administrators when a set of specified events occurs.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Support for Compliance Reporting of Mobile Device Configuration" fam-id="FAU_CRP_EXT">
          <fam-behavior>This family defines requirements for the TSF to provide an interface for the MDM server to convey information about MDs for other systems.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Network Reachability Review" fam-id="FAU_NET_EXT">
          <fam-behavior>This family defines requirements for administrators to see network connectivity status.</fam-behavior>
        </ext-comp-def>
        <!-- FAU_ALT_EXT.1 Server Alerts -->
        <f-component cc-id="fau_alt_ext.1" id="fau-alt-ext-1" name="Server Alerts">
          <comp-lev>defines requirements for alerting the administrator to events.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT.
            <h:ul>
              <h:li>Install policies.</h:li>
            </h:ul>
          </management>
          <audit>
            The following actions should be auditable if FAU_GEN security audit data generation
          is include in the PP or ST.
            <h:ul>
              <h:li>Type of alert.</h:li>
              <h:li>Identity of MD that sent alert.</h:li>
            </h:ul>
          </audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fau-alt-ext-1e1">
            <title>
              The TSF shall alert the administrators in the event of any of the following:
              <h:ul>
                <h:li>Change in enrollment status</h:li>
                <h:li>Failure to apply policies to a MD</h:li>
                <h:li>
                  <selectables>
                    <selectable id="fau_alt_ext.1.1_2">
                      <assignable>other events</assignable>
                    </selectable>
                    <selectable id="fau_alt_ext.1.1_3">no other events</selectable>
                  </selectables></h:li>
              </h:ul>
            </title>
            <note role="application">
              An alert can be defined as anything providing straightaway notice to the administrator. An alert is different from 
		    an audit record, however the fact that an alert was sent should be audited per FAU_GEN.1. Email, pop-up notifications, or other methods 
		    are acceptable forms of alerts. If the TOE is a subordinate MDM server, then sending an alert to the primary MDM server over the trusted channel is
		    sufficient to fulfil this requirement.
              <h:br/>
              <h:br/>
              The MDM agent is required to report to the MDM server on successful application of policies on a MD, and failures can be
		    inferred from the absence of such alerts. This requirement is intended to ensure that the MDM server notifies administrators when policies 
		    are not properly installed. Failure to properly install policy updates does not affect the enrollment status of the MD.
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS and verify that it describes how the alert system is implemented. The evaluator shall also verify that
		      a description of each assigned event is provided in the TSS.</TSS>
              <Guidance>The evaluator shall examine the guidance document and verify that it describes how the alerts can be configured, if configurable.</Guidance>
              <Tests>
                For each MDM agent or platform listed as supported in the ST:
                <testlist>
                  <test>The evaluator shall enroll a device and ensure that the MDM server alerts the administrator of the change in enrollment status. The evaluator shall unenroll (retire) a device and ensure that the MDM server alerts the administrator of the change in enrollment status.</test>
                  <test>The evaluator shall configure policies, which the MDM agent should not be able to apply. These policies shall include: <h:ul><h:li>a setting which is configurable on the MDM server interface but not supported by the platform on which the MDM agent runs, if any
			      such settings exist</h:li> <h:li>a valid configuration setting with an invalid parameter, which may require manual modification of the policy prior to transmission
			      to the device</h:li></h:ul> The evaluator shall deploy such policies and verify that the MDM server alerts the administrator about the failed application of the policy. <h:br/> Alternate test: The evaluator shall configure a policy that the MDM agent can successfully apply. The evaluator blocks the response from the MDM agent of the successful application of the policy, resulting in the MDM server alerting of a failure of application. The evaluator shall verify that the MDM server alerts the administrator about the failed application of the policy.</test>
                  <test>(Conditional) The evaluator shall trigger each of the events listed and ensure that the MDM server alerts the administrator.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Type of alert</audit-event-descr>
            <audit-event-info>Identity of MD that sent alert.</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FAU_CRP_EXT.1 Support for Compliance Reporting of Mobile Device Configuration -->
        <f-component cc-id="fau_crp_ext.1" id="fau-crp-ext-1" name="Support for Compliance Reporting of Mobile Device Configuration">
          <comp-lev>defines requirements for providing information to enrolled MDs
            through a secure channel.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT.
            <h:ul>
              <h:li>Query the current version of the MD firmware or software.</h:li>
              <h:li>Query the current version of the hardware model of the device.</h:li>
              <h:li>Query the current version of installed applications.</h:li>
            </h:ul>
          </management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies><no-link>FTP_ITC.1</no-link> Inter-TSF Trusted Channel</dependencies>
          <f-element id="fau-crp-ext-1e1">
            <title>
              The TSF shall provide
              <selectables>
                <selectable id="fau_crp_ext.1.1_1">an interface that provides responses to queries about the configuration of enrolled devices</selectable>
                <selectable id="fau_crp_ext.1.1_2">an interface that permits the export of data about the configuration of enrolled devices</selectable>
              </selectables>
              to authorized entities over a channel that meets the secure channel requirements in FTP_ITC.1/INTER_XFER_IT. The provided information for each enrolled MD includes:
              <h:ul>
                <h:li>The current version of the MD firmware or software</h:li>
                <h:li>The current version of the hardware model of the device</h:li>
                <h:li>
                  <selectables linebreak="yes">
                    <selectable id="fau_crp_ext.1.1_3">The current version of installed mobile applications</selectable>
                    <selectable id="fau_crp_ext.1.1_4">List of MD configuration policies that are in place on the device (as defined in <xref to="fel-smf-man-agnt"/>)</selectable>
                    <selectable id="fau_crp_ext.1.1_6">
                      <assignable>list of other available information about enrolled devices</assignable>
                    </selectable>
                    <selectable id="fau_crp_ext.1.1_7">no other information</selectable>
                  </selectables>.
                </h:li>
              </h:ul>
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall provide
                <assignable>type of interface</assignable>
                to authorized entities over a 
                channel that meets the secure channel requirements in FTP_ITC.1 The provided information for each enrolled MD includes:
                <h:ul>
                  <h:li>The current version of the MD firmware or software</h:li>
                  <h:li>The current version of the hardware model of the device</h:li>
                  <h:li>
                    <selectables linebreak="yes">
                      <selectable>The current version of installed applications</selectable>
                      <selectable>List of MD configuration policies that are in place on the device (as defined in <xref to="fel-smf-man-agnt"/>)</selectable>
                      <selectable>
                        <assignable>list of other available information about enrolled devices</assignable>
                      </selectable>
                      <selectable>no other information</selectable>
                    </selectables>.
                  </h:li>
                </h:ul>
              </title>
            </ext-comp-def-title>
            <note role="application">
              The intent of this requirement is that the MDM server be able to provide 
              compliance information about enrolled MDs for use by other enterprise security infrastructure systems. 
              There are active standards efforts underway by the Internet Engineering Task Force (IETF) Security Automation and 
              Continuous Monitoring (SACM) Working Group and others to define protocols and standards to assess and report on 
              endpoint device posture. It is expected that this requirement will evolve in future versions of this Protection Profile 
              as standards efforts mature.
              <h:br/>
              <h:br/>
              If the TOE acts as a subordinate MDM server, then this SFR also ensures that there is a
              mechanism for the primary MDM server to query information about the devices managed by
              the subordinate MDM server.
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to verify that it describes the TOE's compliance reporting capability with respect to whether it provides responses to queries about the configuration of enrolled devices or whether it permits the export of data about the configuration of these devices. The evaluator shall also verify that the TSS identifies the trusted channel used to protect data that is transmitted over this interface. Lastly, the evaluator shall verify that the TSS identifies the information that is provided for each enrolled device.</TSS>
              <Guidance>The evaluator shall check to ensure that the operational guidance contains instructions on how to access the MDM server's compliance
		      reporting interface.</Guidance>
              <Tests>
                <testlist>
                  <test>Using the operational guidance, the evaluator shall demonstrate the ability to access the compliance reporting interface from an authorized entity and successfully obtain information about enrolled devices.</test>
                  <test>The evaluator shall attempt to access the compliance reporting interface from an unauthorized entity and demonstrate that the attempt is denied.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FAU_GEN.1/AUDITGEN Audit Data Generation -->
        <f-component cc-id="fau_gen.1" id="fau-gen-1-auditgen" name="Audit Data Generation" iteration="AUDITGEN">
          <f-element id="fel-gen-func-tsf">
            <title>
              The TSF shall
              <selectables>
                <selectable id="fau_gen.1.1_AUDITGEN_1">invoke platform-provided functionality</selectable>
                <selectable id="fau_gen.1.1_AUDITGEN_2">implement functionality</selectable>
              </selectables>
              to generate audit data of the following auditable events:
              <h:ol type="a">
                <h:li>All administrative actions</h:li>
                <h:li>
                  <selectables>
                    <selectable id="fau_gen.1.1_AUDITGEN_3">Commands issued to the MDM agent</selectable>
                    <selectable id="fau_gen.1.1_AUDITGEN_4">Commands issued to the subordinate MDM server</selectable>
                    <selectable id="fau_gen.1.1_AUDITGEN_5">Status updates provided to the primary MDM server</selectable>
                    <selectable id="fau_gen.1.1_AUDITGEN_6">none</selectable>
                  </selectables></h:li>
                <h:li>Specifically defined auditable events listed in <xref g="t-audit-mandatory"/></h:li>
                <h:li><h:b><selectables linebreak="yes"><selectable id="fau_gen.1.1_AUDITGEN_7">Start up and shut down of the audit functions</selectable><selectable id="sel-at2">Auditable events defined in <xref g="t-audit-optional"/> for Strictly Optional SFRs</selectable><selectable id="sel-at3">Auditable events defined in <xref g="t-audit-objective"/> for Objective SFRs</selectable><selectable id="sel-at4">Auditable events defined in <xref g="t-audit-sel-based"/> for Selection-Based SFRs</selectable><selectable id="sel-atssh">Auditable events for the <xref to="ssh"/></selectable><selectable id="sel-attls">Auditable events for the <xref to="tls"/></selectable><selectable id="sel-atssh">Auditable events for the <xref to="X509"/></selectable><selectable id="fau_gen.1.1_AUDITGEN_8">no other events</selectable></selectables></h:b>.</h:li>
              </h:ol>
            </title>
            <note role="application">
              This requirement outlines the events for which audit data must be generated by either the MDM system or the
				MDM server platform. Each audit data event may be written by the MDM system or may be dispatched to the operating system on which 
				it runs. It is acceptable to select both "invoke platform-provided functionality" and "implement functionality." It should be specified
				which auditable events are completed by the MDM system and which are completed by the MDM platform.
              <h:br/>
              <h:br/>
              The ST author can include other auditable events in the assignment; they are not limited to the list presented. All audits must contain at least 
				the information mentioned in
              <xref to="fel-gen-tsf-info"/>.
              <h:br/>
              <h:br/>
              For distributed TOEs, each component must generate audit data for each of the SFRs that it implements. If more than one TOE component is
				involved when an audit event is triggered, the event has to be audited on each component (e.g., rejection of a connection by one component
				while attempting to establish a secure communication channel between two components should result in an audit event being generated by
				both components). This is not limited to error cases but also includes events about successful actions like successful build up or tear down 
				of a secure communication channel between TOE components.
              <h:br/>
              <h:br/>
              Item
              <h:b>a</h:b>
              above requires all administrative actions to be auditable. Administrative actions refer to any management functions specified by 
				FMT_MOF.1/FUNCBE. Thus no additional specification for the auditability of these actions is specified in
              <xref g="t-audit-mandatory"/>
              aside 
				from those that require additional record content. If the TOE is distributed and the given component does not deal with setting the policy 
				applied to the MDM agent, it is acceptable to not have any administrative actions to audit.
              <h:br/>
              <h:br/>
              Item
              <h:b>b</h:b>
              includes those commands, which may be performed automatically based on triggers or on a schedule.
              <h:mark style="background-color:yellowgreen;">If the TOE server acts as a primary MDM server and interfaces with a subordinate MDM server, then "Commands issued to the subordinate MDM server" must be selected. If the TOE server acts as a subordinate MDM server and interfaces with a primary MDM server, then "Status updates provided to the primary MDM Server" must be selected. For distributed TOEs, if the TOE component directly interacts with a primary MDM server, subordinate MDM server, or MDM agent then the corresponding selection should be made for that component. If the TOE component does not directly interact with any of these entities, then it is acceptable to select "none."</h:mark>
              <h:br/>
              <h:br/>
              <h:b>In item d above, "start up and shut down of the MDM system" must be selected if the TSF has a start up and shut down phase. 
        Additionally, if the TOE is distributed, this applies to all components. If the TOE is not distributed then MDM system is equivalent 
        to MDM server. If the TSF does not have a distinct start up or shut down phase (e.g., a cloud service), this selection is not required.</h:b>
              <h:br/>
              Depending on the specific requirements selected by the ST author from SFR, optional requirements, selection-based
				requirements, and objective requirements, the ST author should include the appropriate auditable
				events from
              <xref g="t-audit-optional"/>,
              <xref g="t-audit-sel-based"/>, and
              <xref g="t-audit-objective"/>
              in the
              ST for the requirements selected. Each functional package includes auditable events for the SFRs defined in the package. The ST author is expected to include the auditable events (if any) for each SFR that the ST claims from a functional package.
              <h:br/>
              <h:br/>
              <h:b>The auditable event for "start up and shut down of the audit functions" must be selected if the TSF has a start up and shut down phase. 
                Additionally, if the TOE is distributed, this applies to all components. If the TOE
                is not distributed then MDM system is equivalent 
                to MDM server. If the TSF does not have a distinct start up or shut down phase (e.g., a cloud service), this selection is not required.</h:b>
              <h:br/>
              <h:br/>
            </note>
            <aactivity level="element">
              <TSS>
                The evaluator shall check the TSS and ensure that it lists all of the auditable events. The evaluator shall check to make sure that every
		      audit event type mandated by the PP is described in the TSS. The evaluator shall verify that for every audit event described in the 
		      TSS, the description indicates where the audit event is generated (TSF, TOE platform).
                <h:br/>
                <h:br/>
                If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each supported
		      platform) how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the 
		      MDM server; nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).
              </TSS>
              <Guidance>
                The evaluator shall check the administrative guide and ensure that it lists all of the auditable events. The evaluator shall check 
		      to make sure that every audit event type mandated by the PP is described.
                <h:br/>
                <h:br/>
                The evaluator shall also make a determination of the administrative actions that are relevant in the context of this PP including those listed in
		      the management section. The evaluator shall examine the administrative guide and make a determination of which administrative commands 
		      are related to the configuration (including enabling or disabling) of the mechanisms implemented in the TOE that are necessary to enforce 
		      the requirements specified in the PP.
                <h:br/>
                <h:br/>
                The evaluator shall document the methodology or approach taken while determining which actions in the administrative guide are security 
		      relevant with respect to this PP. The evaluator may perform this activity as part of the activities associated with ensuring the AGD_OPE
		      guidance  satisfies the requirements.
              </Guidance>
              <Tests>The evaluator shall test the TOE's ability to correctly generate audit data by having the TOE generate audit data for the events listed in the provided table and administrative actions. This should include all instances of an event. The evaluator shall test that audit data are generated for the establishment and termination of a channel for each of the cryptographic protocols contained in the ST. For administrative actions, the evaluator shall test that each action determined by the evaluator above to be security relevant in the context of this PP is auditable. <h:br/> <h:br/>Note that the testing here can be accomplished in conjunction with the testing of the security mechanisms directly. For example, testing performed to ensure that the administrative guidance provided is correct verifies that AGD_OPE.1 is satisfied and should address the invocation of the administrative actions that are needed to verify the audit data are generated as expected.</Tests>
            </aactivity>
          </f-element>
          <f-element id="fel-gen-tsf-info">
            <title> The TSF shall record within the audit data at least the following information: <h:ul><h:li>date and time of the event</h:li> <h:li>type of event</h:li> <h:li>subject identity (if applicable)</h:li> <h:li>and the outcome (success or failure) of the event</h:li> <h:li>additional information in <xref g="t-audit-mandatory"/></h:li> <h:li><h:b><selectables linebreak="yes"><selectable id="sel-at2-i">Additional information defined in <xref g="t-audit-optional"/> for Strictly Optional SFRs</selectable><selectable id="sel-at3-i">Additional information defined in <xref g="t-audit-objective"/> for Objective SFRs</selectable><selectable id="sel-at4-i">Additional information defined in <xref g="t-audit-sel-based"/> for Selection-Based SFRs</selectable><selectable id="sel-atssh">Additional information defined in <xref to="ssh"/></selectable><selectable id="sel-attls">Additional information defined in <xref to="tls"/></selectable><selectable id="sel-atssh">Additional information defined in <xref to="X509"/></selectable><selectable id="fau_gen.1.2_AUDITGEN_1">no other additional information</selectable></selectables></h:b></h:li></h:ul></title>
            <note role="application">
              This requirement outlines the information to be included in audit data. All audits must contain at least the
		            information mentioned in
              <xref to="fel-gen-tsf-info"/>. The ST author
		            must identify in the TSS which information of the audit data is performed by the TSF and that which is performed by the 
		            TOE platform.
              <h:br/>
              <h:br/>
            </note>
            <aactivity level="element">
              <TSS>The evaluator shall check the TSS and ensure that it provides a format for audit data. Each audit data format type must be covered, 
		            along with a brief description of each field.</TSS>
              <Guidance>
                The evaluator shall check the administrative guide and ensure that it provides a format for audit data. Each audit data format
		            type must be covered, along with a brief description of each field. The evaluator shall check to make sure that the description of the
		            fields contains the information required in
                <xref to="fel-gen-tsf-info"/>.
              </Guidance>
              <Tests>When verifying the test results from <xref to="fel-gen-func-tsf"/>, the evaluator shall ensure the audit data generated during testing matches the format specified in the administrative guide, and that the fields for each audit data have the proper entries. <h:br/> <h:br/>Note that the testing here can be accomplished in conjunction with the testing of the security mechanisms directly. For example, testing performed to ensure that the administrative guidance provided is correct verifies that AGD_OPE.1 is satisfied and should address the invocation of the administrative actions that are needed to verify the audit data are generated as expected.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FAU_GEN.1/MAS_SERVER Audit Data Generation (MAS Server) -->
        <f-component cc-id="fau_gen.1" id="fau-gen-1-mas-server" name="Audit Data Generation (MAS Server)" iteration="MAS_SERVER" status="sel-based">
          <f-element id="fau-gen-1e1-mas">
            <title>
              The
              <h:b>MAS Server</h:b>
              shall be able to generate audit data of the following
              auditable events: [<h:i>
                <h:ol type="a">
                  <h:li>Failure to push a new application on a MD</h:li>
                  <h:li>Failure to update an existing application on a MD</h:li>
                </h:ol>
              </h:i>].
            </title>
            <note role="application">The MDM agent is required to report to the MAS Server on successful receipt of an application or update on a MD, and failures can be inferred from the absence of such alerts.</note>
          </f-element>
          <f-element id="fel-gen-mas-server">
            <title>
              The
              <selectables>
                <selectable id="fau_gen.1.2_MAS_SERVER_1">
                  <h:b>MAS Server</h:b>
                </selectable>
                <selectable id="fau_gen.1.2_MAS_SERVER_2">
                  <h:b>MAS Server platform</h:b>
                </selectable>
              </selectables>
              shall record within the audit data at least the following information:
              <h:ul>
                <h:li>date and time of the auditable event</h:li>
                <h:li>type of event</h:li>
                <h:li>MD identity</h:li>
                <h:li>
                  <assignable>other audit relevant information.</assignable>
                </h:li>
              </h:ul>
            </title>
            <note role="application">
              All audits must contain at least the information mentioned in
              <xref to="fel-gen-mas-server"/>, but may contain 
		    more information which can be assigned. The ST author must identify in the TSS which
		    information of the audit data is performed by
		    the TSF and that which is performed by the TOE platform.
              <h:br/>
              <h:br/>
              This requirement is claimed if "enable, disable, and modify policies listed in
              FMT_SMF.1/MAS" is selected in FMT_MOF.1.1/FUNCBE.
            </note>
            <aactivity>
              <TSS>The evaluator shall check the TSS and ensure that it provides a format for audit
                data. Each audit data format type must be covered,
		      along with a brief description of each field.</TSS>
              <Guidance>
                The evaluator shall check the administrative guide and ensure that it
                provides a format for audit data. Each audit data format
		      type must be covered, along with a brief description of each field.
                <h:br/>
                <h:br/>
                The evaluator shall check to make sure that the description of the fields contains the information required in
                <xref to="fel-stg-func"/>.
              </Guidance>
              <Tests>The evaluator shall verify that when an application or update push fails, that the audit data generated match the format specified in the guidance and that the fields in each audit data have proper entries. <h:br/> <h:br/>When verifying the test results from <xref to="fel-gen-mas"/>, the evaluator shall ensure the audit data generated during testing match the format specified in the administrative guide, and that the fields in each audit data have the proper entries. <h:br/> <h:br/>Note that the testing here can be accomplished in conjunction with the testing of the security mechanisms directly. For example, testing performed to ensure that the administrative guidance provided is correct verifies that AGD_OPE.1 is satisfied and should address the invocation of the administrative actions that are needed to verify the audit data are generated as expected.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FAU_NET_EXT.1 Network Reachability Review -->
        <f-component cc-id="fau_net_ext.1" id="fau-net-ext-1" name="Network Reachability Review">
          <comp-lev>defines requirements for authorized administrators to read network connectivity
            status.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT.
            <h:ul>
              <h:li>Query connectivity status.</h:li>
            </h:ul>
          </management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies><no-link>FAU_ALT_EXT.2</no-link> Agent Alerts</dependencies>
          <f-element id="fau-net-ext-1e1">
            <title>The TSF shall provide authorized administrators with the capability to read the network connectivity status of an enrolled agent.</title>
            <note role="application">
              The MDM server establishes the network connectivity status of enrolled agents using periodic reachability event alerts
		    from the agents according to FAU_ALT_EXT.2.1 in the PP-Module for MDM Agent. This status may be determined by sending an update request from
		    the MDM server which the agent is required to respond to or by using scheduled periodic notifications of connectivity initiated by the 
		    MDM agent.
              <h:br/>
              <h:br/>
              If the TOE server acts as a subordinate MDM server then there should be some mechanism for the primary MDM server to initialize and read results of the network 
		    reachability tests performed by the subordinate MDM server on those devices that it manages.
            </note>
            <aactivity>
              <TSS>The evaluator ensures that the TSS describes how reachability events are implemented, for each supported MD platform. The evaluator
		      verifies that this description clearly indicates who (MDM agent or MDM server) initiates reachability events.</TSS>
              <Guidance>The evaluator shall verify that the guidance instructs administrators on the method of determining the network connectivity status
		      of an enrolled agent.</Guidance>
              <Tests>For each MDM agent or platform listed as supported in the ST: <h:br/> <h:br/>The evaluator shall configure the MDM agent or platform to perform a network reachability test, both with and without such connectivity and shall ensure that by following the guidance, the evaluator can determine results that reflect both.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FAU_SAR.1 Audit Review -->
        <f-component cc-id="fau_sar.1" id="fau-sar-1" name="Audit Review" status="optional">
          <f-element id="fau-sar-1e1">
            <title>
              The TSF shall
              <selectables>
                <selectable id="fau_sar.1.1_1">
                  <h:b>invoke platform-provided functionality</h:b>
                </selectable>
                <selectable id="fau_sar.1.1_2">
                  <h:b>implement functionality</h:b>
                </selectable>
              </selectables>
              <h:b>to</h:b>
              provide [<h:i>authorized administrators</h:i>] with the
              capability to read [<h:i>all audit information</h:i>] from the audit data.
            </title>
          </f-element>
          <f-element id="fau-sar-1e2">
            <title>
              The TSF shall
              <selectables>
                <selectable id="fau_sar.1.2_1">
                  <h:b>invoke platform-provided functionality</h:b>
                </selectable>
                <selectable id="fau_sar.1.2_2">
                  <h:b>implement functionality</h:b>
                </selectable>
              </selectables>
              <h:b>to</h:b>
              provide the audit data in a manner suitable for the
              <h:b>authorized administrators</h:b>
              to interpret the information.
            </title>
            <note role="application">The intent of this requirement is to ensure that the
              administrator can view and interpret the audit data and to
		    prevent unauthorized users from accessing the logs.</note>
            <aactivity>
              <TSS>If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each supported
		      platform) how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the
		      MDM server; nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).</TSS>
              <Guidance>The evaluator shall check the operational guidance and ensure that it describes how the administrator accesses the audit data and describes
		      the format of audit data.</Guidance>
              <Tests>The evaluator shall attempt to view the audit data as the authorized administrator and verify that the action succeeds. The evaluator shall ensure the audit data generated during testing match the format specified in the administrative guide.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FAU_SEL.1 Security Audit Event Selection -->
        <f-component cc-id="fau_sel.1" id="fau-sel-1" name="Security Audit Event Selection" status="optional">
          <f-element id="fau-sel-1e1">
            <title>
              The TSF shall
              <selectables>
                <selectable id="fau_sel.1.1_1">
                  <h:b>invoke platform-provided functionality</h:b>
                </selectable>
                <selectable id="fau_sel.1.1_2">
                  <h:b>implement functionality</h:b>
                </selectable>
              </selectables>
              to select the set of events to be audited from the set of all auditable events based on the following attributes:
              <h:ol type="a">
                <h:li>[<h:i>event type</h:i>]</h:li>
                <h:li>[<h:i>success of auditable security events</h:i></h:li>
                <h:li>
                  <h:i>failure of auditable security events</h:i>
                </h:li>
                <h:li><h:i><assignable>other attributes</assignable></h:i>]</h:li>
              </h:ol>
            </title>
            <note role="application">The intent of this requirement is to identify all criteria that can be selected to trigger an audit event. The 
		    ST author must select whether the TSF or the platform maintains the audit data. For the ST author, the assignment is used to list
		    any additional criteria or "none."</note>
            <aactivity>
              <TSS>If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each supported 
		      platform) how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the 
		      MDM server; nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).</TSS>
              <Guidance>The evaluator shall review the administrative guidance to ensure that the guidance itemizes all event types, as well as describes all 
		      attributes that are to be selectable in accordance with the requirement, to include those attributes listed in the assignment. The
		      administrative guidance shall also contain instructions on how to set the pre-selection as well as explain the syntax (if present) for 
		      multi-value pre-selection. The administrative guidance shall also identify those audit data
		      that is always recorded, regardless of 
		      the selection criteria currently being enforced.</Guidance>
              <Tests>
                The evaluator shall also perform the following tests:
                <testlist>
                  <test>For each attribute listed in the requirement, the evaluator shall devise a test to show that selecting the attribute causes only audit events with that attribute (or those that are always recorded, as identified in the administrative guidance) to be recorded.</test>
                  <test>[conditional] If the TSF supports specification of more complex audit pre-selection criteria (e.g., multiple attributes, logical expressions using attributes) then the evaluator shall devise tests showing that this capability is correctly implemented. The evaluator shall also, in the test plan, provide a short narrative justifying the set of tests as representative and sufficient to exercise the capability.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>All modifications to the audit configuration that occur while the audit collection functions are operating.</audit-event-descr>
          </audit-event>
        </f-component>
        <!-- FAU_STG.1 Audit Data Storage Location -->
        <f-component cc-id="fau_stg.1" id="fau-stg-1" name="Audit Data Storage Location">
          <f-element id="fau-stg-1e1">
            <title>
              The TSF shall be able to
              <h:b>transmit the generated audit data to an external IT
              entity using a trusted channel according to FTP_ITC.1/INTER_XFER_IT</h:b>
              and store
              generated audit data on the
              <selectables>
                <selectable id="locally">TOE itself</selectable>
                <selectable id="fau_stg.1.1_1">no other storage</selectable>
              </selectables>.
            </title>
            <note role="application">
              <h:p>
                Per
                <xref to="fel-gen-func-tsf"/>, audit data may be generated by the TOE, the platform, or both. If audit data is generated by the TOE, the TSF must have the ability to securely transmit this data to a remote entity. It may additionally store this data within the TOE boundary, in which case "the TOE itself" is selected and FAU_STG.2 must be included in the ST. Regardless of whether the TSF stores the audit data it generates within the TOE boundary, the TOE must always be able to securely transmit the audit data it generates to a remote entity. If audit data is generated by the platform, any secure local storage or secure remote transmission of this data is the responsibility of the platform.
              </h:p>
              <h:p>Although the audit server is outside of the TOE, the TSF should still be able to support 
                mutual authentication. There are no requirements levied on the audit server, but the TOE should be 
                able to support TLS client certificate authentication. This way if the non-TOE audit server does 
                support verifying client certificates, the TSF is able to make use of that.</h:p>
              <h:p>For distributed TOEs, each component must be able to export any audit data it generates across a
              protected channel. This may involve individual components independently transmitting audit data to the same environmental audit server via FTP_ITC.1/INTER_XFER_IT, or it may involve one component of a distributed TOE aggregating audit data generated by other components prior to external transmission. In this case, the internal communication of audit data is protected via the mechanisms specified in FPT_ITT.1/INTER_XFER or FPT_ITT.1/INTER_XFER_AGENT as appropriate. The intent of this requirement in the context of a distributed TOE is that all audit data generated by all components of the TSF be transmitted to an environmental entity entirely through trusted channels, regardless of whether it is transmitted directly from the TSF to the operational environment or whether it is first transmitted to another part of the TOE.</h:p>
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to ensure it describes the means by which the audit data are transferred to the external audit server, 
		      and how the trusted channel is provided.</TSS>
              <Guidance>
                The evaluator shall also examine the operational guidance to determine that it describes the relationship between the local audit
		      data and the audit data that are sent to the audit log server. For example, when an audit event is generated, is it simultaneously sent
		      to the external server and the local store, or is the local store used as a buffer and "cleared" periodically by sending the data to the
		      audit server.
                <h:br/>
                <h:br/>
                The evaluator shall also examine the operational guidance to ensure it describes how to establish the trusted channel to the audit server, as
		      well as describe any requirements on the audit server (particular audit server protocol, version of the protocol required, etc.), as well
		      as configuration of the TOE needed to communicate with the audit server.
              </Guidance>
              <Tests>
                Testing of the trusted channel mechanism will be performed as specified in the associated evaluation activities for the particular trusted channel mechanism.
                <h:br/>
                <h:br/>
                The evaluator shall perform the following test for this requirement:
                <testlist>
                  <test>The evaluator shall establish a session between the TOE and the audit server according to the configuration guidance provided. The evaluator shall then examine the traffic that passes between the audit server and the TOE during several activities of the evaluator's choice designed to generate audit data to be transferred to the audit server. The evaluator shall observe that these data are not able to be viewed in the clear during this transfer, and that they are successfully received by the audit server. The evaluator shall record the particular software (name, version) used on the audit server during testing.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FAU_STG.2 Audit Event Storage -->
        <f-component cc-id="fau_stg.2" id="fel-stg-2" name="Audit Event Storage" status="sel-based">
          <f-element id="fel-stg-func">
            <title>
              The TSF shall
              <selectables>
                <selectable id="fau_stg.2.1_1">
                  <h:b>invoke platform-provided functionality</h:b>
                </selectable>
                <selectable id="fau_stg.2.1_2">
                  <h:b>implement functionality</h:b>
                </selectable>
              </selectables>
              to protect the stored audit data in the audit trail from unauthorized
              <h:b>modification</h:b>.
            </title>
            <note role="application">
              If "store audit data locally" is selected in
              <xref to="fau-stg-1e1"/>, this SFR must be included in the ST.
              <h:br/>
              <h:br/>
              The purpose of this requirement is to ensure that audit data are stored securely. The ST author
			is responsible for selecting whether audit data 
			are maintained when audit storage or failure occurs. The ST author must choose a means by which
			audit data are saved and select the events during which
			the data will be saved. The TSF may rely on the underlying operating system for this functionality, and the first selection should be made
			appropriately.
            </note>
            <aactivity level="component">
              <TSS>
                If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each supported
		      platform) how the audit data protection functionality is invoked (it should be noted that this may be through a mechanism that is not 
		      implemented by the MDM server; nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).
                <h:br/>
                <h:br/>
                If "implement functionality" is selected, the evaluator shall ensure that the TSS
              describes how the audit data are protected from unauthorized 
		      modification or deletion. The evaluator shall ensure that the TOE uses audit trail specific protection mechanisms.
              </TSS>
              <Guidance/>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                  <test>The evaluator shall access the audit trail as an unauthorized user and attempt to modify and delete the audit data. The evaluator shall verify that these attempts fail.</test>
                  <test>The evaluator shall access the audit trail as an authorized user and attempt to modify and delete the audit data. The evaluator shall verify that these attempts succeed. The evaluator shall verify that only the records intended for modification and deletion are modified and deleted.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <f-element id="fau_stg-2-2">
            <title>
              The TSF shall be able to
              <selectables onlyone="yes">
                <selectable id="fau_stg.2.2_1">prevent</selectable>
                <selectable id="fau_stg.2.2_2">detect</selectable>
              </selectables>
              unauthorized modifications to the stored audit data in the audit trail.
            </title>
          </f-element>
          <audit-event/>
        </f-component>
      </section>
      <!-- 5.1.2 Communication (FCO) -->
      <section id="fco" title="Communication (FCO)">
        <ext-comp-def title="Component Registration Channel Definition" fam-id="FCO_CPC_EXT">
          <fam-behavior>This family describes the registration process, including the capability for the administrator to enable or disable communications between a distributed TOE and other components of the TOE.</fam-behavior>
        </ext-comp-def>
        <!-- FCO_CPC_EXT.1 Component Registration Channel Definition -->
        <f-component cc-id="fco_cpc_ext.1" id="fco-cpc-ext-1" name="Component Registration Channel Definition" status="objective">
          <comp-lev>defines requirements for the registration process for distributed TOEs.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>
            The following actions should be auditable if FAU_GEN security audit data generation
          is included in the PP or ST.
            <h:ul>
              <h:li>Enabling or disabling communications between a pair of components.</h:li>
              <h:li>Identities of the endpoint's pairs enabled or disabled.</h:li>
            </h:ul>
          </audit>
          <dependencies>
            <no-link>FPT_ITT.1</no-link>
            TSF Data Transfer
            <h:br/>
            <no-link>FTP_TRP.1</no-link>
            Trusted Path
          </dependencies>
          <f-element id="fel-cpc">
            <title>
              The TSF shall
              <selectables>
                <selectable id="fco_cpc_ext.1.1_1">invoke platform-provided functionality</selectable>
                <selectable id="fco_cpc_ext.1.1_2">implement functionality</selectable>
              </selectables>
              to require an Administrator to enable communications between any pair of TOE components before such communication can take place.
            </title>
          </f-element>
          <f-element id="fel-cpc-func">
            <title>
              The TSF shall
              <selectables>
                <selectable id="fco_cpc_ext.1.2_1">invoke platform-provided functionality</selectable>
                <selectable id="fco_cpc_ext.1.2_2">implement functionality</selectable>
              </selectables>
              to implement a registration process in which components establish and use a communications channel that uses
              <selectables>
                <selectable id="fco_cpc_ext.1.2_3">A channel that meets the secure channel requirements in <selectables><selectable id="fco_cpc_ext.1.2_4">FTP_ITC.1</selectable><selectable id="fco_cpc_ext.1.2_5">FPT_ITT.1/INTER_XFER</selectable><selectable id="fco_cpc_ext.1.2_6">FPT_ITT.1/INTER_XFER_AGENT</selectable></selectables></selectable>
                <selectable id="fco_cpc_ext.1.2_7">A channel that meets the secure registration channel requirements in <selectables><selectable id="fco_cpc_ext.1.2_8">FTP_TRP.1/TRUSTPATH_ENROLL</selectable><selectable id="fco_cpc_ext.1.2_9">FTP_TRP.1/TRUSTPATH_JOIN</selectable></selectables></selectable>
                <selectable id="fco_cpc_ext.1.2_10">No channel</selectable>
              </selectables>
              for at least TSF data.
            </title>
          </f-element>
          <f-element id="fel-cpc-disablecomms">
            <title>The TSF shall  <selectables><selectable id="fco_cpc_ext.1.3_1">invoke platform-provided functionality</selectable><selectable id="fco_cpc_ext.1.3_2">implement functionality</selectable></selectables>  to enable an administrator to disable communications between any pair of TOE components.</title>
            <note role="application">
              This SFR is only applicable if the TOE is distributed and therefore has multiple components that need to communicate via an internal 
		    TSF channel. When creating the TSF from the initial pair of components, either of these components may be identified as the 
		    TSF for the purposes of satisfying the meaning of "TSF" in this SFR.
              <h:br/>
              <h:br/>
              The intention of this requirement is to ensure that there is a registration process that includes a positive enablement step by an administrator 
		    before components joining a distributed TOE can communicate with the other components of the TOE and before the new component can act as
		    part of the TSF. The registration process may itself involve communication with the joining component: many implementations use a bespoke
		    process for this, and the security requirements for the "registration communication" are then defined in
              <xref to="fel-cpc-func"/>.
		    Use of this "registration communication" channel is not deemed inconsistent with the requirement of
              <xref to="fel-cpc"/>
              (i.e., the registration channel can be used before the enablement step, but only in order to complete the registration process).
              <h:br/>
              <h:br/>
              The channel selection (for the registration channel) in
              <xref to="fel-cpc-func"/>
              is essentially a choice between the use of a normal 
		    secure channel that is equivalent to a channel used to communicate with external IT entities (FTP_ITC.1) or existing TOE components
		    (FPT_ITT.1/INTER_XFER and FPT_ITT.1/INTER_XFER_AGENT), or else a separate type of channel that is specific to registration 
		    (FTP_TRP.1/TRUSTPATH_ENROLL or FTP_TRP.1/TRUSTPATH_JOIN). If the TOE does not require a communications channel for registration (e.g., because the registration is
		    achieved entirely by configuration actions by an administrator at each of the components) then the main selection in
              <xref to="fel-cpc-func"/>
              is completed with the "No channel" option.
              <h:br/>
              <h:br/>
              If the ST author selects the FTP_ITC.1 or FPT_ITT.1/INTER_XFER and FPT_ITT.1/INTER_XFER_AGENT channel type in the main selection in
              <xref to="fel-cpc-func"/>
              then the TSS identifies the relevant SFR iteration that specifies the channel used. If the ST author
              selects the FTP_TRP.1/TRUSTPATH_ENROLL or FTP_TRP.1/TRUSTPATH_JOIN channel type, then the TSS (possibly 
              with support from the operational guidance) describes details of the channel and the mechanisms that it uses (and describes how the
              registration process ensures that the channel can only be used by the intended joiner and gatekeeper). Note that the FTP_TRP.1/TRUSTPATH_ENROLL or
              FTP_TRP.1/TRUSTPATH_JOIN channel type may require support from security measures in the operational environment (see the definition of 
              FTP_TRP.1/TRUSTPATH_ENROLL or FTP_TRP.1/TRUSTPATH_JOIN for details).
              <h:br/>
              <h:br/>
              If the ST author selects the FTP_ITC.1 or FPT_ITT.1/INTER_XFER / FPT_ITT.1/INTER_XFER_AGENT channel type in the main selection in
              <xref to="fel-cpc-func"/>
              then the ST identifies the registration channel as a separate iteration of FTP_ITC.1 or
		    FPT_ITT.1/INTER_XFER / FPT_ITT.1/INTER_XFER_AGENT and gives the iteration identifier (e.g., "FPT_ITT.1/Join") in an ST Application Note for
		    FCO_CPC_EXT.1.
              <h:br/>
              <h:br/>
              Note that the channel that is set up and used for registration may be adopted as a continuing internal communication channel (i.e., between
		    different TOE components) provided that the channel meets the requirements of FTP_ITC.1 or FPT_ITT.1/INTER_XFER / FPT_ITT.1/INTER_XFER_AGENT.
		    Otherwise the registration channel is closed after use and a separate channel is used for the internal communications.
              <h:br/>
              <h:br/>
              Specific requirements for Preparative Procedures relating to FCO_CPC_EXT.1 are defined in the Evaluation Activities.
            </note>
            <aactivity>
              <TSS>If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each supported
		      platform) how the audit record protection functionality is invoked (it should be noted that this may be through a mechanism that is not
		      implemented by the MDM server; nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).</TSS>
              <Guidance>The evaluator shall examine the guidance documentation to confirm that it contains instructions for enabling and disabling
		      communications with any individual component of a distributed TOE. The evaluator shall confirm that the method of disabling is such that
		      all other components can be prevented from communicating with the component that is being removed from the TOE (preventing the remaining 
		      components from either attempting to initiate communications to the disabled component, or from responding to communications from the
		      disabled component).</Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall confirm that an IT entity that is not currently a member of the distributed TOE cannot communicate with any component of the TOE until the non-member entity is enabled by an administrator for each of the non-equivalent TOE components that it is required to communicate with (non-equivalent TOE components are as defined in the minimum configuration for the distributed TOE)</test>
                  <test>The evaluator shall confirm that after enablement, an IT entity can communicate only with the components that it has been enabled for. This includes testing that the enabled communication is successful for the enabled component pair, and that communication remains unsuccessful with any other component for which communication is possible but has not been explicitly enabled. <h:br/> Some TOEs may set up the registration channel before the enablement step is carried out, but in such a case the channel must not allow communications until after the enablement step has been completed.</test>
                  <test>The evaluator shall separately disable each TOE component in turn and ensure that the other TOE components cannot then communicate with the disabled component, whether by attempting to initiate communications with the disabled component or by responding to communication attempts from the disabled component. In situations where one component acts as the 'Gatekeeper' for all other components, the test would involve disabling the components in turn on the Gatekeeper and ensuring that the TOE no longer communicates with disabled components.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Enabling or disabling communications between a pair of components.</audit-event-descr>
            <audit-event-info>Identities of the endpoint's pairs enabled or disabled.</audit-event-info>
          </audit-event>
        </f-component>
      </section>
      <!-- 5.1.3 Cryptographic Support (FCS) -->
      <section id="fcs" title="Cryptographic Support (FCS)">
        <ext-comp-def title="Cryptographic Key Management" fam-id="FCS_CKM_EXT">
          <fam-behavior>This family defines requirements for management of cryptographic keys using mechanisms beyond what are specified in CC Part 2.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="HTTPS Protocol" fam-id="FCS_HTTPS_EXT">
          <fam-behavior>This family defines requirements for protecting HTTP communications between the TOE and an external IT entity.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Initialization Vector Generation" fam-id="FCS_IV_EXT">
          <fam-behavior>This family defines requirements for generating IVs in accordance with NIST-approved cipher modes.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Encrypted Cryptographic Key Storage" fam-id="FCS_STG_EXT">
          <fam-behavior>This family defines requirements for ensuring the protection of keys and secrets.</fam-behavior>
        </ext-comp-def>
        <!-- FCS_CKM.1/AKG Cryptographic Key Generation - Asymmetric Key -->
        <f-component cc-id="fcs_ckm.1" id="sfr-fcs-ckm-1-akg" name="Cryptographic Key Generation - Asymmetric Key" iteration="AKG">
          <audit-event/>
        </f-component>
        <!-- FCS_CKM.1/SKG Cryptographic Key Generation - Symmetric Key -->
        <f-component cc-id="fcs_ckm.1" id="sfr-fcs-ckm-1-skg" name="Cryptographic Key Generation - Symmetric Key" iteration="SKG">
          <audit-event/>
        </f-component>
        <!-- FCS_CKM.2 Cryptographic Key Distribution -->
        <f-component cc-id="fcs_ckm.2" id="fcs-ckm-2" name="Cryptographic Key Distribution" status="feat-based">
          <depends on="key-encap-support"/>
          <depends on="wlan-support"/>
          <f-element id="fel-crypt-key-estab">
            <title>
              The TSF shall distribute cryptographic keys in accordance with a specified cryptographic 
              key distribution method
              <selectables>
                <selectable id="sel-ckm-2-encap">key encapsulation</selectable>
                <selectable id="sel-ckm-2-wrap">key wrapping</selectable>
              </selectables>
              that meets the following: [none].
            </title>
            <note role="application">
              <h:p>Key encapsulation is used in support of TLS when ML-KEM is used as the method of key establishment. Key wrapping is used in support of wireless LAN communications.</h:p>
            </note>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS documents that the security strength supported by
                the selected key distribution methods is sufficient for the security strength of the keys
                distributed through those methods.
                <h:p/>
                It is not necessary to identify the services that use each key distribution method here. That
                information should be documented in the requirements for the individual services and
                protocols that invoke key distribution.
              </TSS>
              <Guidance>The evaluator shall verify that the AGD guidance instructs the administrator
                how to configure the TOE to use the selected key distribution methods.</Guidance>
              <Tests>Specific testing for this component is covered by testing for the claimed components in FCS_COP.1/KeyEncap or FCS_COP.1/KeyWrap, depending on selections made.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_CKM.6 Timing and Event of Cryptographic Key Destruction -->
        <f-component cc-id="fcs_ckm.6" id="fcs-ckm-6" name="Timing and Event of Cryptographic Key Destruction">
          <f-element id="fcs-ckm-6e1">
            <title>
              The TSF shall destroy [<h:i>all plaintext keying material and critical security
              parameters (CSPs)</h:i>] when
              <selectables>
                <selectable id="fcs_ckm.6.1_1">no longer needed</selectable>
                <selectable id="fcs_ckm.6.1_3">
                  <assignable>other circumstances for destruction</assignable>
                </selectable>
              </selectables>.
            </title>
          </f-element>
          <f-element id="fcs-ckm-6e2">
            <title>
              The TSF shall destroy
              <h:b>plaintext</h:b>
              keying material
              <h:b>and critical security parameters</h:b>
              by
              <selectables>
                <selectable id="fcs_ckm.6.2_1">invoking platform-provided functionality with the following rules: <h:ul><h:li>For volatile memory, the destruction shall be executed by <selectables><selectable id="fcs_ckm.6.2_2">a single direct overwrite consisting of <selectables><selectable id="fcs_ckm.6.2_3">a pseudo-random pattern using the TSF or platform DRBG (as specified in FCS_RBG.1)</selectable><selectable id="fcs_ckm.6.2_4">zeroes</selectable><selectable id="fcs_ckm.6.2_5">ones</selectable><selectable id="fcs_ckm.6.2_6">a new value of a key</selectable><selectable id="fcs_ckm.6.2_8"><assignable>some value that does not contain any CSP</assignable></selectable></selectables> </selectable><selectable id="fcs_ckm.6.2_9">removal of power to the memory</selectable><selectable id="fcs_ckm.6.2_10">destruction of reference to the key directly followed by a request for garbage collection</selectable></selectables></h:li><h:li>For non-volatile memory that consists of the invocation of an interface provided by the underlying platform that <selectables><selectable id="fcs_ckm.6.2_11">logically addresses the storage location of the key and performs a <selectables><selectable id="fcs_ckm.6.2_12">single</selectable><selectable id="fcs_ckm.6.2_14"><assignable>ST author defined multi-pass</assignable></selectable></selectables> direct overwrite consisting of <selectables><selectable id="fcs_ckm.6.2_15">a pseudo-random pattern using the TSF or platform DRBG (as specified in FCS_RBG.1)</selectable><selectable id="fcs_ckm.6.2_16">zeroes</selectable><selectable id="fcs_ckm.6.2_17">ones</selectable><selectable id="fcs_ckm.6.2_18">a new value of a key</selectable><selectable id="fcs_ckm.6.2_20"><assignable>some value that does not contain any CSP</assignable></selectable></selectables> </selectable><selectable id="fcs_ckm.6.2_21">instructs the underlying platform to destroy the abstraction that represents the key</selectable></selectables></h:li></h:ul></selectable>
                <selectable id="fcs_ckm.6.2_22">implementing key destruction in accordance with the following rules: <h:ul><h:li>For volatile memory, the destruction shall be executed by a single direct overwrite consisting of <selectables><selectable id="fcs_ckm.6.2_23">a pseudo-random pattern using the TSF or platform DRBG (as specified in FCS_RBG.1)</selectable><selectable id="fcs_ckm.6.2_24">zeroes</selectable></selectables></h:li><h:li>For non-volatile EEPROM, the destruction shall be executed by a single direct overwrite consisting of a pseudo-random pattern using the TSF or platform DRBG (as specified in FCS_RBG.1), followed by a read-verify.</h:li><h:li>For non-volatile flash memory, that is not wear-leveled, the destruction shall be executed <selectables><selectable id="fcs_ckm.6.2_25">by a single direct overwrite consisting of zeroes followed by a read-verify</selectable><selectable id="fcs_ckm.6.2_26">by a block erase that erases the reference to memory that stores data as well as the data itself</selectable></selectables></h:li><h:li>For non-volatile flash memory that is wear-leveled, the destruction shall be executed by a <selectables><selectable id="fcs_ckm.6.2_27">single direct overwrite consisting of zeroes</selectable><selectable id="fcs_ckm.6.2_28">block erase</selectable></selectables></h:li><h:li>For non-volatile memory other than EEPROM and flash, the destruction shall be executed by a single direct overwrite with a random pattern that is changed before each write</h:li></h:ul></selectable>
              </selectables>.
            </title>
            <note role="application">
              <h:p>For the purposes of this requirement, keying material refers to authentication data, passwords, secret/private symmetric keys, private asymmetric keys, data used to derive keys, values derived from passwords, etc. Plaintext keying material may refer to a KEK that is used to encrypt other keying material. Destruction of encrypted keying material may be accomplished by destroying the KEK used to encrypt it. If different mechanisms are used for destroying different keying material, all relevant claims should be selected and the TSS should identify which keying material is destroyed by which mechanism.</h:p>
              <h:p>Key storage areas in non-volatile storage can be overwritten with any value that renders the keys unrecoverable. The value used can be all zeroes, all ones, or any other pattern or combination of values significantly different than the value of the key itself. When a value that does not contain any CSP is chosen, it means that the TOE uses some other specified data not drawn from a source that may contain keying material or reveal information about it or any other TSF-protected data. In other words, the data used for overwriting is carefully selected and not taken from a general pool that might contain current or residual data that itself requires confidentiality protection. If multiple copies exist, all copies must be destroyed.</h:p>
              <h:p>Since this is a software-only TOE, the hardware controllers that manage non-volatile storage media are necessarily outside the TOE boundary. Thus, the TOE developer is likely to have little control overor insight intothe functioning of these storage devices. The TOE must make a best-effort to destroy disused cryptographic keys by invoking the appropriate hardware interfacesrecognizing that the specific actions taken by the hardware are out of the TOEs control. But in cases where the TOE has insight into the non-volatile storage technologies used by the hardware, or where the TOE can specify a preference or method for destroying keys, the destruction should be executed by a single, direct overwrite consisting of pseudorandom data or a new key, by a repeating pattern of any static value, or by a block erase.</h:p>
              <h:p>The interface referenced in the requirement could take different forms, the most likely of which is an API to an OS kernel. There may be various levels of abstraction visible. For instance, in a given implementation that overwrites a key stored in non-volatile memory, the application may have access to the file system details and may be able to logically address specific memory locations. In another implementation where an application instructs the underlying platform to destroy the representation of a key stored in non-volatile memory, the application may simply have a handle to a resource and can only ask the platform to delete the resource, as may be the case with a platforms secure key store. The latter implementation should only be used for the most restricted access. The level of detail to which the TOE has access should be described in the TSS.</h:p>
            </note>
            <aactivity>
              <TSS>
                <h:p>The evaluator shall verify that the TSS identifies all plaintext keying material and CSPs stored by the TOE, the type of memory in which it is stored, and when and how the keying material is erased. If the TOE uses one or more KEKs to protect stored keying material, the evaluator shall verify that the TSS describes the destruction of that keying material, either directly or by destruction of the KEK used to encrypt it.</h:p>
                <h:p>If different types of memory are used to store the materials to be protected, the evaluator shall check to ensure that the TSS describes the clearing procedure in terms of the memory in which the data are stored (for example, "secret keys stored on flash are cleared by overwriting once with zeros, while secret keys stored on the internal persistent storage device are cleared by overwriting one time with a random pattern that is changed before each write"). For block erases, the evaluator shall also ensure that the TSS identifies the block erase command that is used and shall verify that the command used also addresses any copies of the plaintext key material that may be created, e.g. in order to optimize the use of Flash memory.</h:p>
                <h:p>If platform-provided functionality is invoked for key destruction, the evaluator shall verify that the TSS identifies the platform functions used for this.</h:p>
              </TSS>
              <Guidance/>
              <Tests>
                <h:p>
                  <h:b>Evaluation Activity Note:</h:b>
                  The following tests likely require the TOE developer to
                  provide access to a test platform that provides the evaluator with tools that are
                  typically not found on the end consumer version of the TOE.
                </h:p>
                <h:p>The evaluator shall perform the following tests for all keys and key material subject to destruction by the TOE, whether the TSF destroys this key material itself or invokes the platform to do so.</h:p>
                <h:p>For these tests, the evaluator shall utilize an
                  appropriate development environment (e.g., a virtual machine) and development tools
                  (debuggers, simulators, etc.) to test that keys are cleared, including all copies of
                  the key that may have been created internally by the TOE during normal cryptographic
                  processing with that key.</h:p>
                <testlist>
                  <test>Applied to each key held as plaintext in volatile memory and subject to destruction by overwrite by the TOE (whether or not the plaintext value is subsequently encrypted for storage in volatile or non-volatile memory). In the case where the only selection made for the destruction method key was removal of power, then this test is unnecessary. The evaluator shall: <h:br/>  <h:ol><h:li>Record the value of the key in the TOE subject to clearing.</h:li> <h:li>Cause the TOE to perform a normal cryptographic processing with the
                        key from Step #1.</h:li> <h:li>Cause the TOE to clear the key.</h:li> <h:li>Cause the TOE to stop the execution but not exit.</h:li> <h:li>Cause the TOE to dump the entire memory of the TOE into a binary
                        file.</h:li> <h:li>Search the content of the binary file created in Step #5 for instances
                        of the known key value from Step #1.</h:li> <h:li>Break the key value from Step #1 into 3 similar sized pieces and
                        perform a search using each piece.</h:li></h:ol>  <h:br/> Steps 1-6 ensure that the complete key does not exist anywhere in volatile memory. If a copy is found, then the test fails. <h:br/>  <h:br/> Step 7 ensures that partial key fragments do not remain in memory. If a fragment is found, there is a minuscule chance that it is not within the context of a key (e.g., some random bits that happen to match). If this is the case the test should be repeated with a different key in Step #1. If a fragment is found the test fails. <h:br/>  <h:br/></test>
                  <test>Applied to each key held in non-volatile memory and subject to destruction by overwrite by the TOE. The evaluator shall use special tools (as needed), provided by the TOE developer if necessary, to view the key storage location: <h:br/>  <h:ol><h:li>Record the value of the key in the TOE subject to clearing.</h:li> <h:li>Cause the TOE to perform a normal cryptographic processing with the
                        key from Step #1.</h:li> <h:li>Cause the TOE to clear the key.</h:li> <h:li>Search the non-volatile memory the key was stored in for instances of
                        the known key value from Step #1. If a copy is found, then the test
                        fails.</h:li> <h:li>Break the key value from Step #1 into 3 similar sized pieces and
                        perform a search using each piece. If a fragment is found then the test is
                        repeated (as described for test 1 above), and if a fragment is found in the
                        repeated test then the test fails.</h:li></h:ol>  <h:br/>  <h:br/></test>
                  <test>Applied to each key held as non-volatile memory and subject to destruction by overwrite by the TOE. The evaluator shall use special tools (as needed), provided by the TOE developer if necessary, to view the key storage location: <h:br/>  <h:ol><h:li>Record the storage location of the key in the TOE subject to
                        clearing.</h:li> <h:li>Cause the TOE to perform a normal cryptographic processing with the
                        key from Step #1.</h:li> <h:li>Cause the TOE to clear the key.</h:li> <h:li>Read the storage location in Step #1 of non-volatile memory to ensure
                        the appropriate pattern is utilized. </h:li></h:ol>  <h:br/> The test succeeds if correct pattern is used to overwrite the key in the memory location. If the pattern is not found the test fails.</test>
                </testlist>
                <h:p>In cases where testing reveals that third-party software modules or programming language run-time environments do not properly overwrite keys, this fact must be documented. Likewise, it must be documented if there is no practical way to determine whether such modules or environments destroy keys properly.</h:p>
                <h:p>
                  In cases where it is impossible or impracticable to perform the above tests, the evaluator shall describe how keys are destroyed in such cases, to include:
                  <h:ul>
                    <h:li>Which keys are affected</h:li>
                    <h:li>The reasons why testing is impossible or impracticable</h:li>
                    <h:li>Evidence that keys are destroyed appropriately (e.g., citations to component documentation, component developer/vendor attestation, component vendor test results)</h:li>
                    <h:li>Aggravating and mitigating factors that may affect the timeliness or execution of key destruction (e.g., caching, garbage collection, operating system memory management)</h:li>
                  </h:ul>
                </h:p>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_CKM_EXT.7 Cryptographic Key Agreement -->
        <f-component cc-id="fcs_ckm_ext.7" id="sfr-fcs-ckm-ext-7" name="Cryptographic Key Agreement" status="feat-based">
          <depends on="key-agreement-support"/>
          <comp-lev>requires that cryptographic key agreement be performed in accordance with specified standards.</comp-lev>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is
            included in the PP, PP-Module, functional package or ST:
            <h:br/>
            <h:ul>
              <h:li>minimal: Success and failure of the activity;</h:li>
              <h:li>basic: The object attribute(s), and object value(s) excluding any sensitive information.</h:li>
            </h:ul>
          </audit>
          <dependencies>
            <h:br/>
            <h:br/>
            [FDP_ITC.1 Import of user data without security attributes, or
            <h:br/>
            FDP_ITC.2 Import of user data with security attributes, or
            <h:br/>
            FCS_CKM.1 Cryptographic key generation, or
            <h:br/>
            FCS_CKM.5 Cryptographic key derivation, or
            <h:br/>
            FCS_CKM_EXT.8 Password-based key derivation],
            <h:br/>
            [FCS_CKM.2 Cryptographic key distribution, or
            <h:br/>
            FCS_COP.1 Cryptographic operation]
            <h:br/>
            FCS_CKM.6 Timing and event of cryptographic key destruction
            <h:br/>
            FCS_COP.1 Cryptographic operation
          </dependencies>
          <f-element id="fcs-ckm-ext-7e1">
            <title>
              The TSF shall derive shared cryptographic keys with input from multiple parties in accordance 
              with specified cryptographic key agreement algorithms
              <selectables>
                <tabularize id="fcs-ckm-ext-7-sels" title="Allowable choices for FCS_CKM_EXT.7">
                  <textcol>Identifier</textcol>
                  <selectcol>Cryptographic algorithm</selectcol>
                  <reqtext>and specified cryptographic parameters</reqtext>
                  <selectcol>Cryptographic parameters</selectcol>
                  <reqtext>that meet the following:</reqtext>
                  <selectcol>List of standards</selectcol>
                  <reqtext>
                    <h:p/>
                    <h:p/>
                    The following table provides the allowable choices for
                    completion of the selection operations of FCS_CKM_EXT.7.
                  </reqtext>
                </tabularize>
                <selectable id="sel-fcs-ckm-kat-kas2">
                  <col>KAS2</col>
                  <col>RSA</col>
                  <col>Modulus size <selectables><selectable id="fcs_ckm_ext.7.1_1">3072</selectable><selectable id="fcs_ckm_ext.7.1_2">4096</selectable><selectable id="fcs_ckm_ext.7.1_3">6144</selectable><selectable id="fcs_ckm_ext.7.1_4">8192</selectable></selectables> bits</col>
                  <col>NIST SP 800-56B Revision 2 (Section 8.3) [KAS2]</col>
                </selectable>
                <selectable id="sel-fcs-ckm-kat-dh">
                  <col>DH</col>
                  <col>Finite Field Cryptography Diffie-Hellman</col>
                  <col>Static domain parameters approved for <selectables><selectable id="fcs_ckm_ext.7.1_5">IKE Groups <selectables><selectable id="sel-kat-ffc-modp3072">MODP-3072</selectable><selectable id="sel-kat-ffc-modp4096">MODP-4096</selectable><selectable id="sel-kat-ffc-modp6144">MODP-6144</selectable><selectable id="sel-kat-ffc-modp8192">MODP-8192</selectable></selectables> </selectable><selectable id="fcs_ckm_ext.7.1_6">TLS Groups <selectables><selectable id="sel-kat-ffc-ffdhe3072">ffdhe3072</selectable><selectable id="sel-kat-ffc-ffdhe4096">ffdhe4096</selectable><selectable id="sel-kat-ffc-ffdhe6144">ffdhe6144</selectable><selectable id="sel-kat-ffc-ffdhe8192">ffdhe8192</selectable></selectables> </selectable></selectables></col>
                  <col>NIST SP 800-56A Revision 3 (Section 5.7.1.1) [DH]<h:p/><selectables><selectable id="fcs_ckm_ext.7.1_7">RFC 3526 [IKE groups]</selectable><selectable id="fcs_ckm_ext.7.1_8">RFC 7919 [TLS groups]</selectable></selectables></col>
                </selectable>
                <selectable id="sel-fcs-ckm-kat-ecdh">
                  <col>ECDH</col>
                  <col>Elliptic Curve Diffie-Hellman</col>
                  <col>Elliptic Curve <selectables><selectable id="sel-exp-kat-ecdh-P384">P-384</selectable><selectable id="sel-exp-kat-ecdh-P521">P-521</selectable></selectables></col>
                  <col>NIST SP 800-56A Revision 3 (Section 5.7.1.2) [ECDH]<h:p/>NIST SP 800-186 (Section 3.2.1) [NIST Curves]</col>
                </selectable>
              </selectables>
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall derive shared cryptographic keys with input from multiple parties in accordance 
                with specified cryptographic key agreement algorithms
                <assignable>cryptographic algorithm</assignable>
                and specified cryptographic parameters
                <assignable>cryptographic parameters</assignable>
                that meet the
                following:
                <assignable>list of standards</assignable>
              </title>
            </ext-comp-def-title>
            <note role="application">
              This SFR is claimed if the TSF supports key agreement schemes as a method of key establishment for trusted channels. This will generally apply to all conformant TOEs, except in the rare (but possible) case where only key encapsulation is used.
              <h:p/>
              All of the above algorithms with the selectable parameters are CNSA 1.0 compliant.
              <h:p/>
              This SFR must be included in the ST if key agreement or transport is a service provided by the TOE to 
              tenant software, or if they are used by the TOE itself to support or implement PP-specified security 
              functionality.
              <h:p/>
            </note>
            <aactivity>
              <TSS>The evaluator shall ensure that the TSS documents that the security strength of the
                material contributed by the TOE is sufficient for the security strength of the key and the
                agreement method.</TSS>
              <Guidance>There are no additional Guidance evaluation activities for this component.</Guidance>
              <Tests>The following tests are conditional based upon the selections made in the SFR. The evaluator shall perform the following test or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/> <h:br/> <h:b>KAS2</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">KAS2</h:td><h:td valign="top">RSA</h:td><h:td valign="top">Modulus Size [<h:b>selection:</h:b> 3072, 4096,
                      6144, 8192] bits</h:td><h:td valign="top">NIST SP 800-56B Revision 2 (Section 8.3) [KAS2]</h:td></h:tr></h:table> <h:p/>To test the TOEs implementation of the of the KAS2 RSA Key Agreement scheme, the evaluator shall perform the Algorithm Functional Test and Validation Test using the following input parameters: <h:ul><h:li>RSA Private key format [Basic, Prime Factor, Chinese Remainder Theorem]</h:li> <h:li>Modulo value [3072, 4096, 6144, 8192]</h:li> <h:li>Role [initiator, responder]</h:li></h:ul> <h:p/>The evaluator shall generate a test group (i.e. set of tests) for each parameter value of the above parameter type with the largest number of supported values. For example, if the TOE supports all five Modulo values, then the evaluator shall generate five test groups. Each of the above supported parameter values must be included in at least one test group. <h:p/>Regardless of how many parameter values are supported, there must be at least two test groups. <h:p/>Half of the test groups are designated as Algorithm Functional Tests (AFT) and the remainder are designated as Validation Tests (VAT). If there is an odd number of groups, then the extra group is designated randomly as either AFT or VAT. <h:p/> <h:br/> <h:i><h:b>Algorithm Functional Test</h:b></h:i> <h:br/>For each test group designated as AFT, the evaluator shall generate 10 test cases using random data (except for a fixed public exponent, if supported). The resulting shared secrets shall be compared with those generated by a known-good implementation using the same inputs. <h:p/> <h:br/> <h:i><h:b>Validation Test</h:b></h:i> <h:br/>For each test group designated as VAT, the evaluator shall generate 25 test cases are using random data (except for a fixed public exponent, if supported). Of the 25 test cases: <h:ul><h:li>Two test cases must have a shared secret with a leading nibble of 0s,</h:li> <h:li>Two test cases have modified derived key material,</h:li> <h:li>Two test cases have modified tags, if key confirmation is supported,</h:li> <h:li>Two test cases have modified MACs, if key confirmation is supported, and</h:li> <h:li>The remaining test cases are not modified.</h:li></h:ul> <h:p/>To determine correctness, the evaluator shall confirm that the resulting 25 shared secrets correspond as expected for both the modified and unmodified values. <h:p/> <h:br/> <h:b>FFC Diffie-Hellman Key Agreement</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">DH</h:td><h:td valign="top">Finite Field Cryptography Diffie-Hellman</h:td><h:td valign="top">Static domain parameters approved for [<h:b>selection:</h:b>
                      IKE groups [<h:b>selection:</h:b> MODP-3072, MODP-4096,
                      MODP-6144, MODP-8192], TLS groups [<h:b>selection:</h:b> 
                      ffdhe3072, ffdhe4096, ffdhe6144, ffdhe8192]]]</h:td><h:td valign="top">NIST SP 800-56A Revision 3 (Section 5.7.1.1) [DH]<h:p/>
                      [<h:b>selection:</h:b> RFC 3526 [IKE Groups], RFC 7919 [TLS Groups]]</h:td></h:tr></h:table> <h:p/>To test the TOEs implementation of FFC Diffie-Hellman Key Agreement, the evaluator shall perform the Algorithm Functional Test and Validation Test using the following input parameters: <h:ul><h:li>Domain Parameter Group [MODP-3072, MODP-4096, MODP-6144, MODP-8192, 
                    ffdhe3072, ffdhe4096, ffdhe6144, ffdhe8192]</h:li></h:ul> <h:p/> <h:br/> <h:i><h:b>Algorithm Functional Test</h:b></h:i> <h:br/>For each supported domain parameter group, the evaluator shall generate 10 test cases by generating the initiator and responder secret keys using random data, calculating the responder public key, and creating the shared secret. The resulting shared secrets shall be compared with those generated by a known-good implementation using the same inputs. <h:p/> <h:br/> <h:i><h:b>Validation Test</h:b></h:i> <h:br/>For each supported combination of the above parameters the evaluator shall generate 15 Diffie Hellman initiator/responder key pairs using the key generation function of a known-good implementation. For each set of key pairs, the evaluator shall modify five initiator private key values. The remaining key values are left unchanged (i.e., correct). To determine correctness, the evaluator shall confirm that the 15 shared secrets correspond as expected for both the modified and unmodified inputs. <h:p/> <h:br/> <h:b>Elliptic Curve Diffie-Hellman Key Agreement</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">ECDH</h:td><h:td valign="top">Elliptic Curve Diffie-Hellman</h:td><h:td valign="top">Elliptic Curve [<h:b>selection:</h:b> P-384, P-521</h:td><h:td valign="top">NIST SP 800-56A Revision 3 (Section 5.7.1.2) [ECDH]<h:p/>
                      NIST SP 800-186 (Section 3.2.1) [NIST Curves]</h:td></h:tr></h:table> <h:p/>To test the TOEs implementation of Elliptic Curve Diffie-Hellman Key Agreement, the evaluator shall perform the Algorithm Functional Test and Validation Test using the following input parameters: <h:ul><h:li>Elliptic Curve [P-384, P-521]</h:li></h:ul> <h:p/> <h:br/> <h:i><h:b>Algorithm Functional Test</h:b></h:i> <h:br/>For each supported Elliptic Curve the evaluator shall generate 10 test cases by generating the initiator and responder secret keys using random data, calculating the responder public key, and creating the shared secret. The resulting shared secrets shall be compared with those generated by a known-good implementation using the same inputs. <h:p/> <h:br/> <h:i><h:b>Validation Test</h:b></h:i> <h:br/>For each supported Elliptic Curve the evaluator shall generate 15 Diffie Hellman initiator/responder key pairs using the key generation function of a known-good implementation. For each set of key pairs, the evaluator shall modify five initiator private key values. The remaining key values are left unchanged (i.e., correct). To determine correctness, the evaluator shall confirm that the 15 shared secrets correspond as expected for the modified and unmodified values. <h:p/></Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/AEAD Cryptographic Operation  Authenticated Encryption with Associated Data -->
        <f-component cc-id="fcs_cop.1" id="sfr-fcs-cop-1-aead" name="Cryptographic Operation  Authenticated Encryption with Associated Data" iteration="AEAD">
          <f-element id="fcs-cop-1e1-aead">
            <title>
              The TSF shall perform [<h:i>authenticated encryption with associated data</h:i>] in accordance with a specified 
              cryptographic algorithm
              <selectables>
                <tabularize id="fcs-cop-aead-sels" title="Allowable choices for FCS_COP.1/AEAD">
                  <textcol>Identifier</textcol>
                  <reqtext></reqtext>
                  <selectcol>Cryptographic Algorithm</selectcol>
                  <reqtext>and cryptographic key sizes</reqtext>
                  <selectcol>Cryptographic Key Sizes</selectcol>
                  <reqtext>that meet the following:</reqtext>
                  <selectcol>List of Standards</selectcol>
                  <reqtext>
                    <h:p/>
                    <h:p/>
                    The following table provides the allowable choices for
                    completion of the selection operations of FCS_COP.1/AEAD.
                  </reqtext>
                </tabularize>
                <selectable id="sel-fcs-cop-aead-aes-gcm">
                  <col>AES-GCM</col>
                  <col>AES in GCM mode with non-repeating IVs using <selectables><selectable id="fcs_cop.1.1_AEAD_1">deterministic</selectable><selectable id="fcs_cop.1.1_AEAD_2">RBG-based</selectable></selectables>, IV construction; the tag must be of length <selectables><selectable id="fcs_cop.1.1_AEAD_3">96</selectable><selectable id="fcs_cop.1.1_AEAD_4">104</selectable><selectable id="fcs_cop.1.1_AEAD_5">112</selectable><selectable id="fcs_cop.1.1_AEAD_6">120</selectable><selectable id="fcs_cop.1.1_AEAD_7">128</selectable></selectables> bits.</col>
                  <col>256 bits</col>
                  <col><selectables><selectable id="fcs_cop.1.1_AEAD_8">ISO/IEC 18033-3:2010 (Subclause 5.2)</selectable><selectable id="fcs_cop.1.1_AEAD_9">FIPS PUB 197</selectable></selectables> [AES]<h:p/><selectables><selectable id="fcs_cop.1.1_AEAD_10">ISO/IEC 19772:2020 (Clause 10)</selectable><selectable id="fcs_cop.1.1_AEAD_11">NIST SP 800-38D</selectable></selectables> [GCM]</col>
                </selectable>
              </selectables>
            </title>
            <note role="application">
              This SFR is claimed when the TOE has wireless LAN client functionality so that the TSF can provide AEAD algorithms in support of wireless communications.
              <h:p/>
              The use of 256-bit keys for AES encryption is required by CNSA 1.0 and 2.0.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to ensure that it describes the construction of any IVs,
                nonces, and tags in conformance with the relevant specifications.
                <h:p/>
                If a CCM mode algorithm is selected, then the evaluator shall examine the TOE summary
                specification to confirm that it describes how the nonce is generated and that the same nonce is
                never reused to encrypt different plaintext pairs under the same key.
                <h:p/>
                If a GCM mode algorithm is selected, then the evaluator shall examine the TOE summary
                specification to confirm that it describes how the IV is generated and that the same IV is never
                reused to encrypt different plaintext pairs under the same key. The evaluator shall also confirm
                that for each invocation of GCM, the length of the plaintext is at most (2
                <h:sup>32</h:sup>)-2 blocks.
              </TSS>
              <Guidance/>
              <Tests>The following tests may require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on factory products. <h:p/>The following tests are conditional based upon the selections made in the SFR. The evaluator shall perform the following test or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/> <h:br/> <h:b>AES-GCM</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">AES-GCM </h:td><h:td valign="top">AES in GCM mode with nonrepeating IVs using 
                      [<h:b>selection:</h:b> deterministic, RBG-based] IV construction; 
                      the tag must be of length [<h:b>selection:</h:b> 96, 104, 112, 120, or 128] bits.</h:td><h:td valign="top">256 bits</h:td><h:td valign="top">
                      [<h:b>selection:</h:b> ISO/IEC 18033-3:2010 (Subclause 5.2),
                      FIPS PUB 197] [AES]<h:p/>
                      [<h:b>selection:</h:b>  ISO/IEC 19772:2020 (Clause 10), NIST SP 800-38D] [GCM]</h:td></h:tr></h:table> <h:p/>To test the TOEs implementation of AES-GCM authenticated encryption functionality the evaluator shall perform the Encryption Algorithm Functional Tests and Decryption Algorithm Functional Tests as described below using the following input parameters: <h:ul><h:li>Key Size [256] bits</h:li> <h:li>Associated data size [0-65536] bits</h:li> <h:li>Payload size [0-65536] bits</h:li> <h:li>IV size [96] bits</h:li> <h:li>Tag size [96, 104, 112, 120, 128] bits</h:li></h:ul> <h:p/> <h:br/> <h:b>Encryption Algorithm Functional Tests</h:b> <h:p/>The evaluator shall generate 15 test cases using random data for each combination of the above parameters as follows: <h:p/> <h:ul><h:li>Each claimed key size,</h:li> <h:li>Each supported tag size,</h:li> <h:li>Four supported non-zero payload sizes, such that two are multiples of 128 bits
                    and two are not multiples of 128 bits,</h:li> <h:li>Four supported non-zero associated data sizes, such that two are multiples of 
                    128 bits and two are not multiples of 128 bits, and</h:li> <h:li>An associated data size of zero, if supported.</h:li></h:ul> <h:p/>Note that the IV size is always 96 bits. <h:p/>The evaluator shall compare the output from each test case against results generated by a known- good implementation with the same input parameters. <h:p/> <h:br/> <h:b><h:i>Decryption Algorithm Functional Tests</h:i></h:b> <h:p/>The evaluator shall test the authenticated decrypt functionality of AES-GCM by supplying 15 test cases for the supported combinations of the parameters as described above. For each parameter combination the evaluator shall introduce an error into either the Ciphertext or the Tag such that approximately half of the cases are correct and half the cases contain errors.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/Hash Cryptographic Operation - Hashing -->
        <f-component cc-id="fcs_cop.1" id="fcs-cop-1-hash" name="Cryptographic Operation - Hashing" iteration="Hash">
          <f-element id="fel-hash">
            <title>
              The TSF shall
              <selectables>
                <selectable id="fcs_cop.1.1_Hash_1">invoke platform-provided functionality</selectable>
                <selectable id="fcs_cop.1.1_Hash_2">implement functionality</selectable>
              </selectables>
              <h:b>to</h:b>
              perform
              <h:b>cryptographic hashing</h:b>
              in accordance with specified cryptographic algorithm
              <selectables>
                <selectable id="sel-cop1-sha256">SHA-256</selectable>
                <selectable id="sel-cop1-sha384">SHA-384</selectable>
                <selectable id="sel-cop1-sha512">SHA-512</selectable>
                <selectable id="sel-cop1-sha3-384">SHA3-384</selectable>
                <selectable id="sel-cop1-sha3-512">SHA3-512</selectable>
              </selectables>
              that meet the following:
              <selectables>
                <selectable id="fcs_cop.1.1_Hash_3">ISO/IEC 10118-3:2018 [SHA, SHA3]</selectable>
                <selectable id="fcs_cop.1.1_Hash_4">FIPS PUB 180-4 [SHA]</selectable>
                <selectable id="fcs_cop.1.1_Hash_5">FIPS PUB 202 [SHA3]</selectable>
              </selectables>.
            </title>
            <note role="application">
              In accordance with CNSA 1.0 and 2.0:
              <h:ul>
                <h:li>SHA-1 hash is no longer permitted to be used as a hash function, </h:li>
                <h:li>SHA3 hashes may be used only for internal hardware functionality such as
                boot integrity checks, and</h:li>
                <h:li>SHA-256 is permitted only for use as a PRF or MAC as part of a key derivation function,
                or as part of LMS or XMSS.</h:li>
              </h:ul>
              <h:p/>
              The hash selection should be consistent with the overall strength of the 
              algorithm used for signature generation. For example, the TOE should choose SHA-384 for 3072-bit RSA, 
              4096-bit RSA, or ECC with P-384; and SHA-512 for ECC with P-521.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to verify that if SHA-256 is selected, that it is being 
                  used only as a PRF or MAC step in a key derivation function or as part of LMS, and not as a hash algorithm.
                <h:br/>
                <h:br/>
                If "invoke platform-provided functionality" is selected:
                <h:br/>
                <h:br/>
                The evaluator shall examine the TSS to verify that it describes (for each 
			            supported platform) how the hash functionality is invoked for each digest size selected 
			            in the MDM server's ST (it should be noted that this may be through a mechanism that is not
			            implemented by the MDM server; nonetheless, that mechanism will be identified in the TSS as
			            part of this evaluation activity).
                <h:br/>
                <h:br/>
                If "implement functionality" is selected:
                <h:br/>
                <h:br/>
                The evaluator shall check that the association of the hash function with other
                  TSF cryptographic functions (for example, the digital signature
                  verification function) is documented in the TSS. The evaluator shall
                  check the AGD documents to determine that any configuration that is required to be
                  done to configure the functionality for the required hash sizes is present. The
                  TSF hashing functions can be implemented in one of two modes.
                <h:br/>
                <h:br/>
                The first mode is the byte-oriented mode. In this mode the TSF
                  only hashes messages that are an integral number of bytes in length (i.e., the
                  length (in bits) of the message to be hashed is divisible by 8).
                <h:br/>
                <h:br/>
                The second mode is the bit-oriented mode. In this mode the TSF hashes messages of
                  arbitrary length. As there are different tests for each mode, an indication is given
                  in the following sections for the bit-oriented vs. byte-oriented TestMAC.
              </TSS>
              <Guidance/>
              <Tests>The following tests may require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on factory products. <h:p/>The following tests are conditional based upon the selections made in the SFR. The evaluator shall perform the following test or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/> <h:br/> <h:b>SHA-256, SHA-384, SHA-512</h:b> <h:p/>To test the TOEs ability to generate hash digests using SHA2 the evaluator shall perform the Algorithm Functional Test, Monte Carlo Test, and Large Data Test for each claimed SHA2 algorithm. <h:p/> <h:br/> <h:b>Algorithm Functional Test</h:b> <h:p/>The evaluator shall generate a number of test cases equal to the block size of the hash (512 for SHA2-256; 1024 for the other SHA2 algorithms). <h:p/>Each test case is to consist of random data of a random length between 0 and 65536 bits, or the largest size supported. <h:p/>Each test case is to consist of random data of a random length between 0 and 65536 bits, or the largest size supported. <h:p/> <h:br/> <h:b>Monte Carlo Test</h:b> <h:p/>Monte Carlo tests begin with a single seed and run 100 iterations of the chained computation. <h:p/>There are two versions of the Monte Carlo test for SHA-1 and SHA-2. Either one is acceptable. For the Standard Monte Carlo test the message hashed is always three times the length of the initial seed. <h:p/> <h:pre>
                  For j = 0 to 99
                  A = B = C = SEED
                  For i = 0 to 999
                  MSG = A || B || C
                  MD = SHA(MSG)
                  A = B
                  B = C
                  C = MD
                  Output MD
                  SEED = MD
                </h:pre> <h:p/>For the alternate version of the Monte Carlo Test, the hashed message is always the same length as the seed. <h:p/> <h:pre>
                  INITIAL_SEED_LENGTH = LEN(SEED)
                  For j = 0 to 99
                  A = B = C = SEED
                  For i = 0 to 999
                  MSG = A || B || C
                  if LEN(MSG) >= INITIAL_SEED_LENGTH:
                  MSG = leftmost INITIAL_SEED_LENGTH bits of MSG
                  else:
                  MSG = MSG || INITIAL_SEED_LENGTH - LEN(MSG) 0 bits
                  MD = SHA(MSG)
                  A = B
                  B = C
                  C = MD
                  Output MD
                  SEED = MD	
                </h:pre> <h:p/>The evaluator shall compare the output against results generated by a known-good implementation with the same input. <h:p/> <h:br/> <h:b>Large Data Test</h:b> <h:p/>The implementation must be tested against one test case each on large data messages of 1GB, 2GB, 4GB, and 8GB of data as supported. The data need not be random. It may, for example, consist of a repeated pattern of 64 bits. <h:p/>The evaluator shall compare the output against results generated by a known-good implementation with the same input. <h:p/> <h:br/> <h:b>SHA3-384, SHA3-512</h:b>To test the TOEs ability to generate hash digests using SHA3 the evaluator shall perform the Algorithm Functional Test, Monte Carlo Test, and Large Data Tests for each claimed SHA3 algorithm. <h:br/> <h:b>Algorithm Functional Test</h:b> <h:p/>Generate a test case consisting of random data for every message length from 0 bits (or the smallest supported message size) to rate bits, where rate equals <h:ul><h:li>832 for SHA3-384 and</h:li> <h:li>576 for SHA3-512.</h:li></h:ul> <h:p/>Additionally, generate tests cases of random data for messages of every multiple of (rate+1) bits starting at length rate, and continuing until 65535 is exceeded. <h:p/>The evaluator shall compare the output against results generated by a known-good implementation with the same input. <h:p/> <h:br/> <h:b>Monte Carlo Test</h:b> <h:p/>Monte Carlo tests begin with a single seed and run 100 iterations of the chained computation. <h:p/>For this Monte Carlo Test, the hashed message is always the same length as the seed. <h:p/> <h:pre>
                  MD[0] = SEED
                  INITIAL_SEED_LENGTH = LEN(SEED)
                  For 100 iterations
                  For i = 1 to 1000
                  MSG = MD[i-1];
                  if LEN(MSG) >= INITIAL_SEED_LENGTH:
                  MSG = leftmost INITIAL_SEED_LENGTH bits of MSG
                  else:
                  MSG = MSG || INITIAL_SEED_LENGTH - LEN(MSG) 0 bits
                  MD[i] = SHA3(MSG)
                  MD[0] = MD[1000]
                  Output MD[0]
                </h:pre> <h:p/>The evaluator shall compare the output against results generated by a known-good implementation with the same input. <h:p/> <h:br/> <h:b>Large Data Test</h:b> <h:p/>The implementation must be tested against one test case each on large data messages of 1GB, 2GB, 4GB, and 8GB of data as supported. The data need not be random. It may, for example, consist of a repeated pattern of 64 bits. <h:p/>The evaluator shall compare the output against results generated by a known-good implementation with the same input.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/KeyedHash Cryptographic Operation - Keyed-Hash -->
        <f-component cc-id="fcs_cop.1" id="fcs-cop-1-keyedhash" name="Cryptographic Operation - Keyed-Hash" iteration="KeyedHash">
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/KeyEncap Cryptographic Operation - Key Encapsulation -->
        <f-component cc-id="fcs_cop.1" id="sfr-fcs-cop-1-keyencap" name="Cryptographic Operation - Key Encapsulation" iteration="KeyEncap" status="sel-based">
          <f-element id="fcs-cop-1e1-keyencap">
            <title>
              The TSF shall perform [key encapsulation] in accordance with a specified cryptographic algorithm
              <selectables>
                <tabularize id="tab-fcs-cop-keyencap-sels" title="Allowable choices for FCS_COP.1/KeyEncap">
                  <textcol>Identifier</textcol>
                  <reqtext></reqtext>
                  <selectcol>Cryptographic algorithm</selectcol>
                  <reqtext>and cryptographic key sizes</reqtext>
                  <selectcol>Cryptographic key sizes</selectcol>
                  <reqtext>that meet the following:</reqtext>
                  <selectcol>List of standards</selectcol>
                  <reqtext>
                    <h:p/>
                    <h:p/>
                    The following table provides the allowable choices for
                    completion of the selection operations of FCS_COP.1/KeyEncap.
                  </reqtext>
                </tabularize>
                <selectable id="sel-fcs-cop-keyencap-mlkem">
                  <col>ML-KEM</col>
                  <col>ML-KEM</col>
                  <col>Parameter set = ML-KEM-1024</col>
                  <col>NIST FIPS 203</col>
                </selectable>
              </selectables>
            </title>
            <note role="application">For this PP, the only anticipated use of key encapsulation is the use of ML-KEM as part of key establishment for trusted communications.</note>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS documents that the selection of the key size is
                sufficient for the security strength of the key encapsulated.
                <h:p/>
                The evaluator shall examine the TSS to verify that any one-time values such as nonces or masks
                are constructed and used in accordance with the relevant standards.
              </TSS>
              <Guidance/>
              <Tests>The following test may require the developer to provide access to a test platform that provides the evaluator with tools that are typically not found on factory products. <h:p/>The following tests are conditional based upon the selections made in the SFR. The evaluator shall perform the following test or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/> <h:br/> <h:b>ML-KEM Key Encapsulation</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">ML-KEM</h:td><h:td valign="top">ML-KEM</h:td><h:td valign="top">Parameter set = ML-KEM-1024</h:td><h:td valign="top">NIST FIPS PUB 203</h:td></h:tr></h:table> <h:p/>To test the TOEs implementation of ML-KEM key encapsulation/decapsulation, the evaluator shall perform the Encapsulation Test and the Decapsulation Test using the following input parameters: <h:ul><h:li>Encapsulation Parameters:<h:ul><h:li>Parameter set [ML-KEM-1024]</h:li> <h:li>Previously generated encapsulation key (<h:i>ek</h:i>)</h:li> <h:li>Random value (<h:i>m</h:i>) [32 bytes]</h:li></h:ul></h:li> <h:li>Decapsulation Parameters:<h:ul><h:li>Parameter set [ML-KEM-1024]</h:li> <h:li>Previously generated decapsulation key (<h:i>dk</h:i>)</h:li> <h:li>Previously generated ciphertext (<h:i>c</h:i>) [32 bytes]</h:li></h:ul></h:li></h:ul> <h:p/> <h:br/> <h:b>Encapsulation Test</h:b> <h:p/>For each supported parameter set the evaluator shall generate 25 test cases consisting of an encapsulation key ek and random value m. For each test case the valuator shall require the implementation under test to generate the corresponding shared secret k and ciphertext c. To determine correctness, the evaluator shall compare the resulting values with those generated using a known-good implementation using the same inputs. <h:p/> <h:br/> <h:b>Encapsulation Key Check (if supported)</h:b> <h:p/>The evaluator shall generate 10 encapsulation keys such that: <h:ul><h:li>Five of the encapsulation keys are valid, and</h:li> <h:li>Five of the encapsulation keys are modified such that a value in the noisy linear 
                    system is encoded into the key as a value greater than Q.</h:li></h:ul> <h:p/>The evaluator shall invoke the TOEs Encapsulation Key Check functionality to determine the validity of the 10 keys. The unmodified keys should be determined valid, and the modified keys should be determined invalid. <h:p/> <h:br/> <h:b>Decapsulation Key Check (if supported)</h:b> <h:p/>The evaluator shall generate 10 decapsulation keys such that: <h:ul><h:li>Five of the decapsulation keys are valid, and</h:li> <h:li>Five of the decapsulation keys are modified such that the concatenated
                    values ek||H(ek) will no longer match by modifying H(ek) to be a different value.</h:li></h:ul> <h:p/>The evaluator shall invoke the TOEs Decapsulation Key Check functionality to determine the validity of the 10 keys. The unmodified keys should be determined valid, and the modified keys should be determined invalid. <h:p/> <h:br/> <h:b>Decapsulation Test</h:b> <h:p/>For each supported parameter set the evaluator shall use a single previously generated decapsulation key <h:i>dk</h:i>and generate 10 test cases consisting of valid and invalid ciphertexts c. For each test case the evaluator shall require the implementation under test to generate the corresponding shared secret <h:i>k</h:i>whether or not the ciphertext is valid. To determine correctness, the evaluator shall compare the resulting values with those generated using a known-good implementation using the same inputs. <h:p/></Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/KeyWrap Cryptographic Operation - Key Wrapping -->
        <f-component cc-id="fcs_cop.1" id="sfr-fcs-cop-1-kw" name="Cryptographic Operation - Key Wrapping" iteration="KeyWrap" status="sel-based">
          <f-element id="fcs-cop-1e1-kw">
            <title>
              The TSF shall perform [key wrapping] in accordance with a specified cryptographic algorithm
              <selectables>
                <tabularize id="fcs-cop-kw-sels" title="Allowable choices for FCS_COP.1/KeyWrap">
                  <textcol>Identifier</textcol>
                  <reqtext></reqtext>
                  <selectcol>Cryptographic algorithm</selectcol>
                  <reqtext>and cryptographic key sizes</reqtext>
                  <selectcol>Cryptographic key sizes</selectcol>
                  <reqtext>that meet the following:</reqtext>
                  <selectcol>List of standards</selectcol>
                  <reqtext>
                    <h:p/>
                    <h:p/>
                    The following table provides the allowable choices for
                    completion of the selection operations of FCS_COP.1/KeyWrap.
                  </reqtext>
                </tabularize>
                <selectable id="sel-fcs-cop-kw-aes-kw">
                  <col>AES-KW</col>
                  <col>AES in KW mode</col>
                  <col>256 bits</col>
                  <col><selectables><selectable id="fcs_cop.1.1_KeyWrap_1">ISO/IEC 18033-3:2010 (Subclause 5.2)</selectable><selectable id="fcs_cop.1.1_KeyWrap_2">FIPS PUB 197</selectable></selectables> [AES]<h:p/><selectables><selectable id="fcs_cop.1.1_KeyWrap_3">ISO/IEC 19772:2020 (clause 6)</selectable><selectable id="fcs_cop.1.1_KeyWrap_4">NIST SP 800-38F (Section 6.2)</selectable></selectables> [KW mode]</col>
                </selectable>
                <selectable id="sel-fcs-cop-kw-aes-kwp">
                  <col>AES-KWP</col>
                  <col>AES in KWP mode</col>
                  <col>256 bits</col>
                  <col><selectables><selectable id="fcs_cop.1.1_KeyWrap_5">ISO/IEC 18033-3:2010 (Subclause 5.2)</selectable><selectable id="fcs_cop.1.1_KeyWrap_6">FIPS PUB 197</selectable></selectables> [AES]<h:p/>NIST SP 800-38F (Section 6.3) [KWP mode]</col>
                </selectable>
                <selectable id="sel-fcs-cop-kw-aes-ccm">
                  <col>AES-CCM</col>
                  <col>AES in CCM mode with unpredictable, non-repeating nonce, minimum size of 64 bits</col>
                  <col>256 bits</col>
                  <col><selectables><selectable id="fcs_cop.1.1_KeyWrap_7">ISO/IEC 18033-3:2010 (Subclause 5.2)</selectable><selectable id="fcs_cop.1.1_KeyWrap_8">FIPS PUB 197</selectable></selectables> [AES]<h:p/><selectables><selectable id="fcs_cop.1.1_KeyWrap_9">ISO/IEC 19772:2020 (Clause 7)</selectable><selectable id="fcs_cop.1.1_KeyWrap_10">NIST SP 800-38C</selectable></selectables> [CCM]</col>
                </selectable>
                <selectable id="sel-fcs-cop-kw-aes-gcm">
                  <col>AES-GCM</col>
                  <col>AES in GCM mode with non-repeating IVs using <selectables><selectable id="fcs_cop.1.1_KeyWrap_11">deterministic</selectable><selectable id="fcs_cop.1.1_KeyWrap_12">RBG-based</selectable></selectables>, IV construction; the tag must be of length <selectables><selectable id="fcs_cop.1.1_KeyWrap_13">96</selectable><selectable id="fcs_cop.1.1_KeyWrap_14">104</selectable><selectable id="fcs_cop.1.1_KeyWrap_15">112</selectable><selectable id="fcs_cop.1.1_KeyWrap_16">120</selectable><selectable id="fcs_cop.1.1_KeyWrap_17">128</selectable></selectables> bits.</col>
                  <col>256 bits</col>
                  <col><selectables><selectable id="fcs_cop.1.1_KeyWrap_18">ISO/IEC 18033-3:2010 (Subclause 5.2)</selectable><selectable id="fcs_cop.1.1_KeyWrap_19">FIPS PUB 197</selectable></selectables> [AES]<h:p/><selectables><selectable id="fcs_cop.1.1_KeyWrap_20">ISO/IEC 19772:2020 (Clause 10)</selectable><selectable id="fcs_cop.1.1_KeyWrap_21">NIST SP 800-38D</selectable></selectables> [GCM]</col>
                </selectable>
              </selectables>
            </title>
            <note role="application">NIST 800-57p1rev5 sec. 5.6.2 specifies that the size of key used to protect the key being 
              transported should be at least the security strength of the key it is protecting.</note>
            <aactivity>
              <TSS>
                The evaluator shall ensure that the TSS documents that the selection of the key size is
                sufficient for the security strength of the key wrapped.
                <h:p/>
                The evaluator shall examine the TSS to ensure that it describes the construction of any IVs,
                nonces, and MACs in conformance with the relevant specifications.
              </TSS>
              <Guidance/>
              <Tests>For tests of AES-GCM and AES-CCM, see testing for FCS_COP.1/AEAD. <h:p/>The following tests are conditional based upon the selections made in the SFR. The evaluator shall perform the following test or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/> <h:br/> <h:b>AES-KW</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">AES-KW</h:td><h:td valign="top">AES in KW mode</h:td><h:td valign="top">256 bits</h:td><h:td valign="top">[<h:b>selection:</h:b> ISO/IEC 18033-3:2010 (Subclause 5.2),
                      FIPS PUB 197] [AES]<h:p/>
                      [<h:b>selection:</h:b> ISO/IEC 19772:2020 (clause 6), 
                      NIST SP 800-38F (Section 6.2)] [KW mode] </h:td></h:tr></h:table> <h:p/>To test the TOEs ability to wrap keys using AES in Key Wrap mode the evaluator shall perform the Algorithm Functional Tests using the following input parameters: <h:ul><h:li>Key size [256] bits</h:li> <h:li>Keyword cipher type [cipher, inverse]</h:li> <h:li>Payload sizes [128-4096] bits by 64s</h:li></h:ul> <h:p/> <h:br/> <h:b>Algorithm Functional Test</h:b> <h:p/>The evaluator shall generate 100 encryption test cases using random data for each combination of claimed key size, keyword cipher type, and six supported payload sizes such that the payload sizes include the minimum, the maximum, two that are divisible by 128, and two that are not divisible by 128. <h:p/>The results shall be compared with those generated by a known-good implementation using the same inputs. <h:p/>The evaluator shall generate 100 decryption test cases using the same parameters as above, but with 20 of each 100 test cases having modified ciphertext to produce an incorrect result. To determine correctness, the evaluator shall confirm that the results correspond as expected for both the modified and unmodified values. <h:p/> <h:br/> <h:b>AES-KWP</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Identifier</h:td><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Cryptographic Key Sizes</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">AES-KWP</h:td><h:td valign="top">AES in KWP mode</h:td><h:td valign="top">256 bits</h:td><h:td valign="top">[<h:b>selection:</h:b> ISO/IEC 18033-3:2010 (Subclause 5.2),
                      FIPS PUB 197] [AES]<h:p/>
                      NIST SP 800-38F (Section 6.3) [KWP mode] </h:td></h:tr></h:table> <h:p/>To test the TOEs ability to wrap keys using AES in Key Wrap with Padding mode with padding the evaluator shall perform the Algorithm Functional Tests using the following input parameters: <h:ul><h:li>Key size [256] bits</h:li> <h:li>Keyword cipher type [cipher, inverse]</h:li> <h:li>Payload sizes [8-4096] bits by 8s</h:li></h:ul> <h:p/> <h:br/> <h:b>Algorithm Functional Test</h:b> <h:p/>The evaluator shall generate 100 encryption test cases using random data for each combination of claimed key size, keyword cipher type, and six supported payload sizes such that the payload sizes include the minimum, the maximum, two that are divisible by 128, and two that are not divisible by 128. <h:p/>The results shall be compared with those generated by a known-good implementation using the same inputs. <h:p/>The evaluator shall generate 100 decryption test cases using the same parameters as above, but with 20 of each 100 test cases having modified ciphertext to produce an incorrect result. To determine correctness, the evaluator shall confirm that the results correspond as expected for both the modified and unmodified values. <h:p/></Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/SigGen Cryptographic Operation -
                  Signature Generation -->
        <f-component cc-id="fcs_cop.1" id="fcs-cop-1-siggen" name="Cryptographic Operation -
                  Signature Generation" iteration="SigGen">
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/SigVer Cryptographic Operation - Signature Verification -->
        <f-component cc-id="fcs_cop.1" id="fcs-cop-1-sigver" name="Cryptographic Operation - Signature Verification" iteration="SigVer">
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/SKC Cryptographic Operation -
          Encryption/Decryption -->
        <f-component cc-id="fcs_cop.1" id="fcs-cop-1-skc" name="Cryptographic Operation -
          Encryption/Decryption" iteration="SKC" status="sel-based">
          <audit-event/>
        </f-component>
        <!-- FCS_COP.1/XOF Cryptographic Operation - Extendable-Output Function -->
        <f-component cc-id="fcs_cop.1" id="sfr-fcs-cop-1-xof" name="Cryptographic Operation - Extendable-Output Function" iteration="XOF" status="sel-based">
          <f-element id="fcs-cop-1e1-xof">
            <title>
              The TSF shall perform [<h:i>extendable-output function</h:i>] in accordance with a specified cryptographic algorithm
              <selectables>
                <tabularize id="fcs-cop-xof-sels" title="Allowable choices for FCS_COP.1/XOF">
                  <selectcol>Cryptographic Algorithm</selectcol>
                  <reqtext>and parameters</reqtext>
                  <selectcol>Parameters</selectcol>
                  <reqtext>that meet the following:</reqtext>
                  <selectcol>List of Standards</selectcol>
                  <reqtext>
                    <h:p/>
                    <h:p/>
                    The following table provides the allowable choices for
                    completion of the selection operations of FCS_COP.1/XOF.
                  </reqtext>
                </tabularize>
                <selectable id="sel-fcs-cop-xof-shake">
                  <col>SHAKE</col>
                  <col>Functions = [SHAKE128, SHAKE256]</col>
                  <col>NIST FIPS PUB 202 Section 6.2 [SHAKE]</col>
                </selectable>
              </selectables>
            </title>
            <note role="application">
              In accordance with CNSA 2.0, SHAKE is permitted to be used only as a component of LMS or XMSS. 
              Therefore this component is claimed only if LMS or XMSS is claimed in FCS_COP.1/SigVer.
              <h:p/>
              Since LMS and XMSS use both SHAKE128 and SHAKE256 internally, claiming and testing of both
              functions is mandatory.
            </note>
            <aactivity>
              <TSS/>
              <Guidance/>
              <Tests>The following tests are conditional based on the selections made in the SFR. The evaluator shall perform the following tests or witness respective tests executed by the developer. The tests must be executed on a platform that is as close as practically possible to the operational platform (but which may be instrumented in terms of, for example, use of a debug mode). Where the test is not carried out on the TOE itself, the test platform shall be identified and the differences between test environment and TOE execution environment shall be described. <h:p/> <h:br/> <h:b>SHAKE</h:b> <h:p/> <h:table border="1"><h:tr class="header" bgcolor="#cccccc"><h:td valign="top">Cryptographic Algorithm</h:td><h:td valign="top">Parameters</h:td><h:td valign="top">List of Standards</h:td></h:tr><h:tr><h:td valign="top">SHAKE</h:td><h:td valign="top">Function = [SHAKE128, SHAKE256]</h:td><h:td valign="top">NIST FIPS PUB 202 Section 6.2 [SHAKE]</h:td></h:tr></h:table> <h:p/>To test the TOEs implementation of the SHAKE Extendable Output Function the evaluator shall perform the Algorithm Functional Test, Monte Carlo Test, and Variable Output Test using the following input parameters: <h:ul><h:li>Function [SHAKE128, SHAKE256]</h:li> <h:li>Output length [16-65536] bits</h:li></h:ul> <h:p/> <h:br/> <h:b><h:i>Algorithm Functional Test</h:i></h:b> <h:p/>For each supported function, generate test cases consisting of random data for every message length from 0 bits (if supported) to <h:i>rate</h:i>-1 bits, where <h:i>rate</h:i>equals <h:p/> <h:ul><h:li>1344 for SHAKE128, and</h:li> <h:li>1088 for SHAKE256.</h:li></h:ul> <h:p/>Additionally, generate tests cases of random data for messages of every multiple of (rate+1) bits starting at length rate, and continuing until 65535 is exceeded. For SHAKE128, this should result in a total of 1391 test cases. <h:p/> <h:br/> <h:b><h:i>Monte Carlo Test</h:i></h:b> <h:p/>The Monte Carlos test takes in a single 128-bit message (SEED) and desired output length in bits, and runs 100 iterations of the chained computation. MaxOutBytes and MinOutBytes are the largest and smallest supported input and output sizes in bytes, respectively. <h:p/> <h:pre>
                  Range = maxOutBytes - minOutBytes + 1
                  OutputLen = maxOutBytes
                  For j = 0 to 99
                  MD[0] = SEED
                  For i = 1 to 1000
                  MSG[i] = 128 leftmost bits of MD[i-1]
                  if (MSG[i] &lt; 128 bits)
                  Append 0 bits on rightmost side of MSG[i] til MSG[i] is 128 bits
                  MD[i] = SHAKE(MSG[i], OutputLen * 8)
                  
                  RightmostOutputBits = 16 rightmost bits of MD[i] as an integer
                  OutputLen = minOutBytes + (RightmostOutputBits % Range)
                  Output MD[1000], OutputLen
                  SEED = MD[1000]
                </h:pre> <h:p/> <h:br/> <h:b><h:i>Variable Output Test</h:i></h:b> <h:p/>This test measures the ability of the TOE to generate output digests of varying sizes. <h:p/>The evaluator shall generate 512 test cases such that the input for each test case consists of 128- bits of random data, and the output length includes the minimum supported value, the maximum supported value, and 510 random values between the minimum and maximum digest sizes supported by the implementation. <h:p/></Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_HTTPS_EXT.1 HTTPS Protocol -->
        <f-component cc-id="fcs_https_ext.1" id="fcs-https-ext-1" name="HTTPS Protocol" status="sel-based">
          <comp-lev>defines requirements for the implementation of the HTTPS protocol.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>
            The following actions should be auditable if FAU_GEN security audit data generation
            is included in the PP or ST.
            <h:ul>
              <h:li>Failure of the certificate validity check.</h:li>
              <h:li>Issuer Name and Subject Name of certificate.</h:li>
              <h:li>
                <selectables>
                  <selectable>User's authorization decision</selectable>
                  <selectable>No additional information</selectable>
                </selectables></h:li>
            </h:ul>
          </audit>
          <dependencies><no-link>FCS_TLS_EXT.1</no-link> TLS Protocol<h:br/><no-link>[FCS_TLSC_EXT.1 TLS Client Protocol or <h:br/>
              FCS_TLSS_EXT.1 TLS Server Protocol</no-link></dependencies>
          <f-element id="fcs-https-ext-1e1">
            <title>The TSF shall  <selectables><selectable id="fcs_https_ext.1.1_1">invoke platform-provided functionality to implement</selectable><selectable id="fcs_https_ext.1.1_2">implement</selectable></selectables>  the HTTPS protocol that complies with RFC 2818.</title>
          </f-element>
          <f-element id="fcs-https-ext-1e2">
            <title>
              The TSF shall
              <selectables>
                <selectable id="fcs_https_ext.1.2_1">invoke platform-provided functionality to implement</selectable>
                <selectable id="fcs_https_ext.1.2_2">implement</selectable>
              </selectables>
              HTTPS using TLS in accordance with the Functional Package for Transport Layer Security.
            </title>
            <note role="application">The requirement is claimed if the TSF selects HTTPS  in any iteration of FPT_ITT.1, FTP_ITC.1, or FTP_TRP.1. It is expected that if the TOE invokes platform-provided functionality to perform HTTPS, that the platform implementation of HTTPS is conformant to the functional package.</note>
            <aactivity>
              <TSS>The evaluator shall verify that the TSS describes whether the TOE's HTTPS functionality is implemented by the TOE or invoked from the TOE platform. If the TOE implements HTTPS, the evaluator shall verify that the corresponding claims from the TLS Functional Package (client, server, or both) are present.</TSS>
              <Guidance/>
              <Tests>
                <testlist>
                  <test>The evaluator shall attempt to establish an HTTPS connection with a web server, observe the traffic with a packet analyzer, and verify that the connection succeeds and that the traffic is identified as TLS or HTTPS.</test>
                  <h:br/>
                  <h:br/>
                  Other tests are performed in conjunction with the TLS evaluation activities.
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Failure of the certificate validity check</audit-event-descr>
            <audit-event-info>Issuer Name and Subject Name of certificate</audit-event-info>
            <audit-event-info>
              <selectables onlyone="yes">
                <selectable>User's authorization decision</selectable>
                <selectable>No additional information</selectable>
              </selectables>
            </audit-event-info>
          </audit-event>
        </f-component>
        <!-- FCS_IV_EXT.1 Initialization Vector Generation -->
        <f-component cc-id="fcs_iv_ext.1" id="fcs-iv-ext-1" name="Initialization Vector Generation" status="sel-based">
          <comp-lev>defines requirements for generating IVs.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fcs-iv-est-1e1">
            <title>The TSF shall  <selectables><selectable id="fcs_iv_ext.1.1_1">invoke platform-provided functionality</selectable><selectable id="fcs_iv_ext.1.1_2">implement functionality</selectable></selectables>  to generate IVs in accordance with  <xref to="iv"/>.</title>
            <note role="application">
              This requirement must be included in the ST
              if the selection in FCS_STG_EXT.1 indicates that the TSF is protecting private keys
              and persistent secrets with encryption rather than the platform-provided key
              storage.
              <h:br/>
              <h:br/>
              <xref to="iv"/>
              lists the requirements for composition of IVs according to
              the corresponding NIST Special Publications for each cipher mode. The composition of
              IVs generated for encryption according to a cryptographic protocol is addressed by the
              protocol. Thus, this requirement addresses only IVs generated for key storage encryption.
              <h:br/>
              <h:br/>
              <h:b>
                <ctr ctr-type="Table" pre="Table " id="iv">: References and IV Requirements for NIST-approved Cipher Modes</ctr>
              </h:b>
              <h:table>
                <h:TR>
                  <h:TD>
                    <h:b>Cipher Mode</h:b>
                  </h:TD>
                  <h:TD>
                    <h:b>Reference</h:b>
                  </h:TD>
                  <h:TD>
                    <h:b>IV Requirement</h:b>
                  </h:TD>
                </h:TR>
                <h:tr>
                  <h:td>Electronic Codebook (ECB)</h:td>
                  <h:td>SP800-38A</h:td>
                  <h:td>No IV</h:td>
                </h:tr>
                <h:tr>
                  <h:td>Counter (CTR)</h:td>
                  <h:td>SP800-38A</h:td>
                  <h:td>"Initial Counter" shall be non-repeating. No counter value shall be
                    repeated across multiple messages with the same secret key.</h:td>
                </h:tr>
                <h:tr>
                  <h:td>Cipher Block Chaining (CBC)</h:td>
                  <h:td>SP800-38A</h:td>
                  <h:td>IVs shall be unpredictable. Repeating IVs leak information about whether
                    the first one or more blocks are shared between two messages, so IVs should be
                    non-repeating in such situations.</h:td>
                </h:tr>
                <h:tr>
                  <h:td>Output Feedback (OFB)</h:td>
                  <h:td>SP800-38A</h:td>
                  <h:td>IVs shall be non-repeating and shall not be generated by invoking the
                    cipher on another IV.</h:td>
                </h:tr>
                <h:tr>
                  <h:td>Cipher Feedback (CFB)</h:td>
                  <h:td>SP800-38A</h:td>
                  <h:td>IVs should be non-repeating as repeating IVs leak information about the
                    first plaintext block and about common shared prefixes in messages.</h:td>
                </h:tr>
                <h:tr>
                  <h:td>XOR Encrypt XOR (XEX) Tweakable Block Cipher with Ciphertext
                    Stealing (XTS)</h:td>
                  <h:td>SP800-38E</h:td>
                  <h:td>No IV. Tweak values shall be non-negative integers, assigned
                    consecutively, and starting at an arbitrary non-negative integer.</h:td>
                </h:tr>
                <h:tr>
                  <h:td>Cipher-based Message Authentication Code (CMAC)</h:td>
                  <h:td>SP800-38B</h:td>
                  <h:td>No IV</h:td>
                </h:tr>
                <h:tr>
                  <h:td>Key Wrap and Key Wrap with Padding</h:td>
                  <h:td>SP800-38F</h:td>
                  <h:td>No IV</h:td>
                </h:tr>
                <h:tr>
                  <h:td>Counter with CBC-Message Authentication Code (CCM)</h:td>
                  <h:td>SP800-38C</h:td>
                  <h:td>No IV. Nonces shall be non-repeating.</h:td>
                </h:tr>
                <h:tr>
                  <h:td>Galois Counter Mode (GCM)</h:td>
                  <h:td>SP800-38D</h:td>
                  <h:td>IV shall be non-repeating. The number of invocations of GCM shall not
                    exceed 2^32 for a given secret key unless an implementation only uses 96-bit IVs
                    (default length).</h:td>
                </h:tr>
              </h:table>
            </note>
            <aactivity>
              <TSS>
                If "invoke platform-provided functionality" is selected:
                <h:br/>
                <h:br/>
                The evaluator shall examine the TSS to verify that it describes (for each supported platform) how the IV generation is invoked for each mode
			  selected in the MDM server's ST (it should be noted that this may be through a mechanism that is not implemented by the MDM server; nonetheless, that
			  mechanism will be identified in the TSS as part of this evaluation activity).
                <h:br/>
                <h:br/>
                If "implement functionality" is selected:
                <h:br/>
                <h:br/>
                The evaluator shall examine the TSS to ensure that it details the encryption of user credentials, persistent secrets, and private keys and the 
			  generation of the IVs used for that encryption.
              </TSS>
              <Guidance/>
              <Tests>The evaluator shall ensure that the generation of IVs for each key encrypted by the same KEK meets <xref to="iv"/>.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_RBG.1 Random Bit Generation (RBG) -->
        <f-component cc-id="fcs_rbg.1" id="fel-rbg" name="Random Bit Generation (RBG)">
          <f-element id="fel-rbg-init-seed">
            <title>
              The TSF shall
              <h:b><selectables>
                  <selectable id="fcs_rbg.1.1_1">invoke platform-provided functionality</selectable>
                  <selectable id="tsf-drbg">implement functionality</selectable>
                </selectables></h:b>
              <h:b>to</h:b>
              perform
              <h:b>all</h:b>
              deterministic random bit generation services in accordance with NIST Special Publication 800-90A using
              <selectables linebreak="yes">
                <selectable id="fcs_rbg.1.1_2">Hash_DRBG (any)</selectable>
                <selectable id="fcs_rbg.1.1_3">HMAC_DRBG (any)</selectable>
                <selectable id="fcs_rbg.1.1_4">CTR_DRBG (AES)</selectable>
              </selectables>
              in accordance with [<h:i>NIST SP 800-90A</h:i>] after initialization with a seed.
            </title>
            <note role="application">NIST SP 800-90A contains three different methods of generating random numbers;
              each of these, in turn, depends on underlying cryptographic primitives (hash functions/ciphers).
              The ST author will select the function used and include the specific underlying cryptographic primitives used in the requirement or in the TSS.</note>
            <aactivity level="element">
              <TSS>
                The evaluator shall verify that the TSS identifies the DRBGs used by the TOE.
                <h:br/>
                <h:br/>
                If "invoke platform-provided functionality" is selected:
                <h:br/>
                <h:br/>
                The evaluator shall examine the TSS to verify that it describes (for each supported platform) how the RBG functionality is invoked for each operation they
                  are used for in the MDM server (it should be noted that this may be through a mechanism that is not implemented by the MDM server; nonetheless, that mechanism
                  will be identified in the TSS as part of this evaluation activity).
              </TSS>
              <Guidance>If the DRBG functionality is configurable, the evaluator shall verify that the operational guidance includes instructions on how to configure
                    this behavior.</Guidance>
              <Tests>If "implement functionality" is selected: <h:br/> <h:br/>The evaluator shall perform the following tests. <h:br/> <h:br/>The evaluator shall perform 15 trials for the RNG implementation. If the RNG is configurable, the evaluator shall perform 15 trials for each configuration. The evaluator shall also confirm that the operational guidance contains appropriate instructions for configuring the RNG functionality. <h:br/> <h:br/>If the RNG has prediction resistance enabled, each trial consists of (1) instantiate DRBG, (2) generate the first block of random bits, (3) generate a second block of random bits, and (4) uninstantiate. The evaluator verifies that the second block of random bits is the expected value. The evaluator shall generate eight input values for each trial. The first is a count (0 - 14). The next three are entropy input, nonce, and personalization string for the instantiate operation. The next two are additional input and entropy input for the first call to generate. The final two are additional input and entropy input for the second call to generate. These values are randomly generated. "generate one block of random bits" means to generate random bits with number of returned bits equal to the Output Block Length (as defined in NIST SP 800-90A). <h:br/> <h:br/>If the RNG does not have prediction resistance, each trial consists of (1) instantiate DRBG, (2) generate the first block of random bits (3) reseed, (4) generate a second block of random bits, and (5) uninstantiate. The evaluator verifies that the second block of random bits is the expected value. The evaluator shall generate eight input values for each trial. The first is a count (0 - 14). The next three are entropy input, nonce, and personalization string for the instantiate operation. The fifth value is additional input to the first call to generate. The sixth and seventh are additional input and entropy input to the call to reseed. The final value is additional input to the second generate call. <h:br/> <h:br/>The following paragraphs contain more information on some of the input values to be generated or selected by the evaluator. <h:br/> <h:br/>Entropy input: the length of the entropy input value must equal the seed length. <h:br/> <h:br/>Nonce: If a nonce is supported (CTR_DRBG with no Derivation Function does not use a nonce), the nonce bit length is one-half the seed length. <h:br/> <h:br/>Personalization string: The length of the personalization string must be less than or equal to seed length. If the implementation only supports one personalization string length, then the same length can be used for both values. If more than one string length is support, the evaluator shall use personalization strings of two different lengths. If the implementation does not use a personalization string, no value needs to be supplied. <h:br/> <h:br/>Additional input: the additional input bit lengths have the same defaults and restrictions as the personalization string lengths. <h:br/> <h:br/> <h:p>
                  The evaluator shall perform the following tests:
                </h:p> <h:p>
                  The evaluator shall perform 15 trials for the RNG implementation. If the RNG
                  is configurable, the evaluator shall perform 15 trials for each configuration. The
                  evaluator shall also confirm that the operational guidance contains appropriate
                  instructions for configuring the RNG functionality.
                </h:p> <h:p>
                  If the RNG has  prediction resistance enabled, each trial consists of (1) instantiate DRBG, (2)
                  generate the first block of random bits (3) generate a second block of random bits
                  (4) uninstantiate. The evaluator verifies that the second block of random bits is
                  the expected value. The evaluator shall generate eight input values for each
                  trial. The first is a count (0  14). The next three are entropy input, nonce, and
                  personalization string for the instantiate operation. The next two are additional
                  input and entropy input for the first call to generate. The final two are
                  additional input and entropy input for the second call to generate. These values
                  are randomly generated. "generate one block of random bits" means to generate
                  random bits with number of returned bits equal to the Output Block Length (as
                  defined in NIST SP 800-90A).
                </h:p> <h:p>
                  If the RNG does not have prediction resistance,
                  each trial consists of (1) instantiate DRBG, (2) generate the first block of
                  random bits (3) reseed, (4) generate a second block of random bits (5)
                  uninstantiate. The evaluator verifies that the second block of random bits is the
                  expected value. The evaluator shall generate eight input values for each trial.
                  The first is a count (0  14). The next three are entropy input, nonce, and
                  personalization string for the instantiate operation. The fifth value is
                  additional input to the first call to generate. The sixth and seventh are
                  additional input and entropy input to the call to reseed. The final value is
                  additional input to the second generate call.
                </h:p> <h:p>
                  The following list contains more information on some of the input values to be generated/selected by the evaluator.
                  <h:ul><h:li><h:b>Entropy input:</h:b> The length of the entropy input value must equal the seed
                      length.</h:li> <h:li><h:b>Nonce:</h:b> If a nonce is supported (CTR_DRBG with no Derivation Function does
                      not use a nonce), the nonce bit length is one-half the seed length. </h:li> <h:li><h:b>Personalization string:</h:b> The length of the personalization string must be
                      less than or equal to seed length. If the implementation only supports one
                      personalization string length, then the same length can be used for both values.
                      If more than one string length is support, the evaluator shall use personalization
                      strings of two different lengths. If the implementation does not use a
                      personalization string, no value needs to be supplied. </h:li> <h:li><h:b>Additional input:</h:b> The additional input bit lengths have the same defaults
                      and restrictions as the personalization string lengths.</h:li></h:ul></h:p></Tests>
            </aactivity>
          </f-element>
          <f-element id="fel-rbg-init-seed-how">
            <title>
              The TSF shall use a
              <selectables>
                <selectable id="internal-seed">TSF noise source <assignable>name of noise source</assignable></selectable>
                <selectable id="internal-seeds">
                  <h:b>multiple TSF noise sources <assignable>names of noise sources</assignable></h:b>
                </selectable>
                <selectable id="external-seed">TSF interface for seeding</selectable>
              </selectables>
              for initialized seeding.
            </title>
            <note role="application">
              <h:p>For the 
                selection in this requirement, the ST author selects "TSF noise source" if
                a single noise source is used as input to the DRBG. The ST author selects "multiple TSF noise sources" if a seed is formed from a combination of two or more noise sources within the TOE boundary. If the TSF implements two or more separate DRBGs that are seeded in separate manners, this SFR should be iterated for each DRBG. It multiple distinct noise sources exist such that each DRBG only uses one of them, then each iteration would select "TSF noise source"; "multiple TSF noise sources" is only selected if a single DRBG uses multiple noise sources for its seed. The ST author selects "TSF interface for seeding" if noise source data is generated outside the TOE boundary.</h:p>
              <h:p>If "TSF noise source" is selected, FCS_RBG.3 must be claimed.</h:p>
              <h:p>If "multiple TSF noise sources" is selected, FCS_RBG.4 and FCS_RBG.5 must be claimed.</h:p>
              <h:p>If "TSF interface for seeding" is selected, FCS_RBG.2 must be claimed.</h:p>
            </note>
            <aactivity level="element">
              <h:p>
                Documentation will be produced - and the evaluator shall perform the
                activities - in accordance with
                <xref to="entropyappendix"/>
                and
                the
                <h:a href="https://niap-ccevs.org/Documents_and_Guidance/ccevs/Entropy%20Documentation%20and%20Assessment%20Clarification.pdf">Clarification to the Entropy Documentation and Assessment Annex</h:a>.
              </h:p>
              <TSS/>
              <Guidance/>
              <Tests/>
            </aactivity>
          </f-element>
          <f-element id="fel-rbg-init-seed-when">
            <title>
              The TSF shall update the RBG state by
              <selectables>
                <selectable id="fcs_rbg.1.3_1">reseeding</selectable>
                <selectable id="fcs_rbg.1.3_2">uninstantiating and reinstantiating</selectable>
              </selectables>
              using a
              <selectables>
                <selectable id="fcs_rbg.1.3_3">TSF noise source <assignable>name of noise source</assignable></selectable>
                <selectable id="fcs_rbg.1.3_5">TSF interface for seeding</selectable>
              </selectables>
              in the following situations:
              <selectables linebreak="yes">
                <selectable id="fcs_rbg.1.3_6">never</selectable>
                <selectable id="fcs_rbg.1.3_7">on demand</selectable>
                <selectable id="fcs_rbg.1.3_8">on the condition: <assignable>condition</assignable></selectable>
                <selectable id="fcs_rbg.1.3_10">after <assignable>time</assignable></selectable>
              </selectables>
              in accordance with
              <assignable>list of standards</assignable>.
            </title>
            <aactivity level="element">
              <TSS>The evaluator shall verify that the TSS identifies how the DRBG state is updated, and the situations under which this may occur.</TSS>
              <Guidance>If the ST claims that the DRBG state can be updated on demand, the evaluator shall verify that the operational guidance has instructions for how to perform this operation.</Guidance>
              <Tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_RBG.2 Random Bit Generation (External Seeding) -->
        <f-component cc-id="fcs_rbg.2" id="fcs-rbg-2" name="Random Bit Generation (External Seeding)" status="sel-based">
          <f-element id="fe1-rbg-seed">
            <title>
              The TSF shall be able to accept a minimum input of
              <assignable>minimum input length greater than zero</assignable>
              from a TSF interface for the purpose of seeding.
            </title>
            <note role="application">
              This requirement is claimed when a DRBG is seeded with entropy from one or more noise sources that is outside the TOE
              boundary. Typically the entropy produced by an environmental noise source is conditioned such that the input length has
              full entropy and is therefore  usable as the seed. However, if this is not the case, it should be noted what the minimum
              entropy rate of the noise source is so that the TSF can collect a sufficiently large sample of noise data to be
              conditioned into a seed value.
              <h:br/>
              <h:br/>
              This requirement is claimed if "TSF interface for seeding" is selected in
              <xref to="fel-rbg-init-seed-how"/>.
            </note>
            <aactivity>
              <h:p>The evaluator shall examine the entropy documentation required by FCS_RBG.1.2 to verify that it identifies, for each DRBG function implemented by the TOE, the TSF external interface used to seed the TOE's DRBG. The evaluator shall verify that this includes the amount of sampled data and the min-entropy rate of the sampled data such that it can be determined that sufficient entropy can be made available for the highest strength keys that the TSF can generate (e.g., 256 bits). If the seed data cannot be assumed to have full entropy (e.g., the min-entropy of the sampled bits is less than 1), the evaluator shall ensure that the entropy documentation describes the method by which the TOE estimates the amount of entropy that has been accumulated to ensure that sufficient data is collected and any conditioning that the TSF applies to the output data to create a seed of sufficient size with full entropy.</h:p>
              <TSS/>
              <Guidance/>
              <Tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_RBG.3 Random Bit Generation (Internal Seeding - Single Source) -->
        <f-component cc-id="fcs_rbg.3" id="fcs-rbg-3" name="Random Bit Generation (Internal Seeding - Single Source)" status="sel-based">
          <f-element id="fel-rbg-seed-int-sing">
            <title>
              The TSF shall be able to seed the RBG using a
              <selectables onlyone="yes">
                <selectable id="fcs_rbg.3.1_1">TSF software-based noise source</selectable>
                <selectable id="fcs_rbg.3.1_2">TSF hardware-based noise source <assignable>name of noise source</assignable></selectable>
              </selectables>
              with a minimum of
              <assignable>number of bits</assignable>
              bits of min-entropy.
            </title>
            <note role="application">
              This requirement is claimed when a DRBG is seeded with entropy from a single noise source that is within the TOE boundary. Min-entropy should be expressed as a ratio of entropy bits to sampled bits so that the total amount of data needed to ensure full entropy is known, as well as the conditioning function by which that data is reduced in size to the seed.
              <h:br/>
              <h:br/>
              This requirement is claimed if "TSF noise source..." is selected in
              <xref to="fel-rbg-init-seed-how"/>.
            </note>
            <aactivity>
              <h:p>The evaluator shall examine the entropy documentation required by FCS_RBG.1.2 to verify that it identifies, for each DRBG function implemented by the TOE, the TSF noise source used to seed the TOE's DRBG. The evaluator shall verify that this includes the amount of sampled data and the min-entropy rate of the sampled data such that it can be determined that sufficient entropy can be made available for the highest strength keys that the TSF can generate (e.g., 256 bits). If the seed data cannot be assumed to have full entropy (e.g., the min-entropy of the sampled bits is less than 1), the evaluator shall ensure that the entropy documentation describes the method by which the TOE estimates the amount of entropy that has been accumulated to ensure that sufficient data is collected and any conditioning that the TSF applies to the output data to create a seed of sufficient size with full entropy.</h:p>
              <TSS/>
              <Guidance/>
              <Tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_RBG.4 Random Bit Generation (Internal Seeding - Multiple Sources) -->
        <f-component cc-id="fcs_rbg.4" id="fcs-rbg-4" name="Random Bit Generation (Internal Seeding - Multiple Sources)" status="sel-based">
          <f-element id="fel-rbg-seed-int-mult">
            <title>
              The TSF shall be able to seed the RBG using
              <selectables>
                <selectable id="fcs_rbg.4.1_1"><assignable>number</assignable> TSF software-based noise sources</selectable>
                <selectable id="fcs_rbg.4.1_3"><assignable>number</assignable> TSF hardware-based noise sources</selectable>
              </selectables>.
            </title>
            <note role="application">
              This requirement is claimed when a DRBG is seeded with entropy from multiple noise sources that are within the TOE boundary. 
              FCS_RBG.5 defines the mechanism by which these sources are combined to ensure sufficient minimum entropy.
              <h:br/>
              <h:br/>
              This requirement is claimed if "multiple TSF noise sources..." is selected in
              <xref to="fel-rbg-init-seed-how"/>.
            </note>
            <aactivity>
              <h:p>The evaluator shall examine the entropy documentation required by FCS_RBG.1.2 to verify that it identifies, for each DRBG function implemented by the TOE, each TSF noise source used to seed the TOE's DRBG. The evaluator shall verify that this includes the amount of sampled data and the min-entropy rate of the sampled data from each data source.</h:p>
              <TSS/>
              <Guidance/>
              <Tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_RBG.5 Random Bit Generation (Combining Noise Sources) -->
        <f-component cc-id="fcs_rbg.5" id="fcs-rbg-5" name="Random Bit Generation (Combining Noise Sources)" status="sel-based">
          <f-element id="fel-rbg-comb">
            <title>
              The TSF shall
              <assignable>combining operation</assignable>
              <selectables>
                <selectable id="fcs_rbg.5.1_2">output from TSF noise sources</selectable>
                <selectable id="fcs_rbg.5.1_3">input from TSF interfaces for seeding</selectable>
              </selectables>
              to create the entropy input into the derivation function as defined in
              <assignable>list of standards</assignable>, resulting
              in a minimum of
              <assignable>number of bits</assignable>
              bits of min-entropy.
            </title>
            <note role="application">This requirement is claimed if "multiple TSF noise sources..." is selected in <xref to="fel-rbg-init-seed-how"/>.</note>
            <aactivity>
              <h:p>Using the entropy sources specified in FCS_RBG.4, the evaluator shall examine the entropy documentation required by FCS_RBG.1.2 to verify that it describes the method by which the various entropy sources are combined into a single seed. This should include an estimation of the rate at which each noise source outputs data and whether this is dependent on any system-specific factors so that each source's relative contribution to the overall entropy is understood. The evaluator shall verify that the resulting combination of sampled data and the min-entropy rate of the sampled data is described in sufficient detail to determine that sufficient entropy can be made available for the highest strength keys that the TSF can generate (e.g., 256 bits). If the seed data cannot be assumed to have full entropy (e.g., the min-entropy of the sampled bits is less than 1), the evaluator shall ensure that the entropy documentation describes the method by which the TOE estimates the amount of entropy that has been accumulated to ensure that sufficient data is collected and any conditioning that the TSF applies to the output data to create a seed of sufficient size with full entropy.</h:p>
              <TSS/>
              <Guidance/>
              <Tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_STG_EXT.1 Cryptographic Key Storage -->
        <f-component cc-id="fcs_stg_ext.1" id="fcs-stg-ext-1" name="Cryptographic Key Storage">
          <comp-lev>defines requirements for the security of persistent secrets and private keys.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT.
            <h:ul>
              <h:li>Import keys or secrets into the secure key storage (MDF Function 9)</h:li>
            </h:ul>
          </management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fel-crypto-key-store">
            <title>The TSF shall use  <selectables><selectable id="fcs_stg_ext.1.1_1">platform-provided key storage</selectable><selectable id="fcs_stg_enc">encryption as specified in FCS_STG_EXT.2</selectable></selectables>  for all persistent secrets and private keys.</title>
            <note role="application">
              This requirement ensures that persistent secrets (credentials, secret keys) and private keys are stored securely when not in 
			use. If some secrets or keys are manipulated by the TOE and others are manipulated by the platform, then both of the selections can be specified by the ST 
			author and the ST author must identify in the TSS those keys which are manipulated by the TOE and those by the platform.
              <h:br/>
              <h:br/>
              If "encryption as specified in FCS_STG_EXT.2" is selected then FCS_STG_EXT.2 and FCS_IV_EXT.1 must be included in the ST.
              <h:br/>
              <h:br/>
              If the TSF is an application, and not a dedicated server, then it should store its private keys in the platform-provided key storage.
              <h:br/>
              <h:br/>
              The ST author is responsible for selecting the manner in which the keys are stored and where they are stored in the selections above.
            </note>
            <aactivity>
              <TSS>
                Regardless of whether this requirement is met by the TSF or the TOE platform, the evaluator will check the TSS to ensure that it lists each 
			  persistent secret (credential, secret key) and private key needed to meet the requirements in the ST. For each of these items, the evaluator will 
			  confirm that the TSS lists for what purpose it is used, and how it is stored. The evaluator then performs the following actions.
                <h:br/>
                <h:br/>
                Persistent secrets and private keys manipulated by the TOE platform:
                <h:br/>
                <h:br/>
                The evaluator shall examine the TSS to verify that it describes (for each supported platform) how the key storage functionality is invoked for each 
			  persistent secret and private key described in the TSS (it should be noted that this may be through a mechanism that is not implemented by the MDM 
			  Server; nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).
                <h:br/>
                <h:br/>
                Persistent secrets and private keys manipulated by the TSF:
                <h:br/>
                <h:br/>
                The evaluator reviews the TSS to determine that it makes a case that, for each item listed as being manipulated by the TOE, it is not written
			  unencrypted to persistent memory, and that the item is stored by the platform.
              </TSS>
              <Guidance/>
              <Tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FCS_STG_EXT.2 Encrypted Cryptographic Key Storage -->
        <f-component cc-id="fcs_stg_ext.2" id="fcs-stg-ext-2" name="Encrypted Cryptographic Key Storage" status="sel-based">
          <comp-lev>defines requirements for preventing access to private keys and persistent
            secrets.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fcs-stg-ext-2e1">
            <title>The TSF shall  <selectables><selectable id="fcs_stg_ext.2.1_1">invoke platform-provided functionality</selectable><selectable id="fcs_stg_ext.2.1_2">implement functionality</selectable></selectables>  to encrypt all keys using AES in the  <selectables><selectable id="fcs_stg_ext.2.1_3">Key Wrap (KW) mode</selectable><selectable id="fcs_stg_ext.2.1_4">Key Wrap with Padding (KWP) mode</selectable><selectable id="fcs_stg_ext.2.1_5">GCM</selectable><selectable id="fcs_stg_ext.2.1_6">CCM</selectable><selectable id="fcs_stg_ext.2.1_7">CBC mode</selectable></selectables>.</title>
            <note role="application">
              This requirement states that keys used by the TSF shall not be kept in plaintext. The intent of this requirement is to ensure 
			that the private keys, credentials, and persistent secrets cannot be accessed in the TOE in an unencrypted state, allowing an attacker to access keys 
			without having to exhaust the AES key space.
              <h:br/>
              <h:br/>
              This requirement must be included in the ST if the selection in FCS_STG_EXT.1 indicates that the TSF is protecting private keys and persistent secrets
			  with encryption rather than the platform-provided key storage.
              <h:br/>
              <h:br/>
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to ensure it describes in detail how user credentials, persistent secret and private keys are stored and
			  encrypted. The evaluator shall review the TSS to determine that it makes a case that key material is not written unencrypted to persistent memory 
			  and that it identifies the mode of encryption.
                <h:br/>
                <h:br/>
                If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each supported platform)
			  how the key encryption functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the MDM server; 
			  nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).
              </TSS>
              <Guidance/>
              <Tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
      </section>
      <!-- 5.1.4 Identification and Authentication (FIA) -->
      <section id="fia" title="Identification and Authentication (FIA)">
        <ext-comp-def title="Client Authorization" fam-id="FIA_CLI_EXT">
          <fam-behavior>This family defines requirements for unique certificate or token use.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Enrollment" fam-id="FIA_ENR_EXT">
          <fam-behavior>This family defines requirements for authenticating remote users and limiting user enrollment.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Client Tokens" fam-id="FIA_TOK_EXT">
          <fam-behavior>This family defines requirements for using a unique device to generate unique tokens for client devices.</fam-behavior>
        </ext-comp-def>
        <!-- FIA_CLI_EXT.1 Client Authorization -->
        <f-component cc-id="fia_cli_ext.1" id="fia-cli-ext-1" name="Client Authorization">
          <comp-lev>defines requirements for a unique certificate or token for each client device.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fia_cli_ext-1-1">
            <title>The TSF shall require a unique  <selectables><selectable id="fia_cli_ext.1.1_1">certificate</selectable><selectable id="token">token as defined in FIA_TOK_EXT.1</selectable></selectables>  for each client device.</title>
            <note role="application">Token is used here in a generic way to be some form of unique identifier that is not certificate-based as defined in
              FIA_TOK_EXT.1. If "token as defined in FIA_TOK_EXT.1" is selected, FIA_TOK_EXT.1 must be included in the ST.</note>
            <aactivity>
              <TSS>The evaluator shall ensure that the TSS describes how the client is uniquely identified.</TSS>
              <Guidance>None.</Guidance>
              <Tests>None.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FIA_ENR_EXT.1 Enrollment -->
        <f-component cc-id="fia_enr_ext.1" id="fia-enr-ext-1" name="Enrollment">
          <comp-lev>defines requirements for authenticating and limiting user actions.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT.
            <h:ul>
              <h:li>Configure the specific device models.</h:li>
              <h:li>Configure the specific time period.</h:li>
            </h:ul>
          </management>
          <audit>
            The following actions should be auditable if FAU_GEN security audit data generation
          is included in the PP or ST.
            <h:ul>
              <h:li>Failure of MD user authentication.</h:li>
              <h:li>Presented username.</h:li>
            </h:ul>
          </audit>
          <dependencies>
            <no-link>FIA_UAU.4</no-link>
            Single-Use Authentication Mechanisms
            <h:br/>
            <no-link>FMT_SMF.1</no-link>
            Specification of Management Functions
          </dependencies>
          <f-element id="fel-enr-tsf">
            <title>The TSF shall authenticate the remote users over a trusted channel during the enrollment of a MD.</title>
            <note role="application">The MDM server may use its own directory or a directory server to perform the authentication decision for users performing
			the remote enrollment of a MD.</note>
            <aactivity level="element">
              <TSS>The evaluator shall examine the TSS and verify that it describes the process of enrollment for each MDM agent or platform listed as supported 
			  in the ST. This description shall include the trusted path used for enrollment (FTP_TRP.1/TRUSTPATH_ENROLL), the method of user authentication
			  (username or password, token, etc.), the method of authentication decision (local or remote authentication services), and the actions performed on
			  the MDM server upon successful authentication.</TSS>
              <Guidance>The evaluator shall examine the operational guidance to verify that it describes the process by which the TOE enrolls mobile devices into management.</Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall attempt to enroll a device without providing correct credentials. The evaluator shall verify that the device is not enrolled and that the described enrollment actions are not taken.</test>
                  <test>The evaluator shall attempt to enroll the device providing correct credentials. The evaluator shall verify that the device is enrolled and that the described enrollment actions are taken.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <f-element id="fel-enr-limit">
            <title>The TSF shall limit the user's enrollment of devices to devices specified by  <selectables><selectable id="fia_enr_ext.1.2_1">IMEI</selectable><selectable id="fia_enr_ext.1.2_3"><assignable>a unique device ID</assignable></selectable></selectables>  and  <selectables><selectable id="fia_enr_ext.1.2_4">specific device models</selectable><selectable id="fia_enr_ext.1.2_5">a number of devices</selectable><selectable id="fia_enr_ext.1.2_6">specific time period</selectable><selectable id="fia_enr_ext.1.2_8"><assignable>other features</assignable></selectable><selectable id="fia_enr_ext.1.2_9">no other features</selectable></selectables>. </title>
            <note role="application">This requirement is designed to permit the enterprise to restrict users' enrollment of devices. A unique device ID is required
			to limit the user's enrollment. The unique device ID can be the IMEI or an ID specific to a particular platform.</note>
            <aactivity level="element">
              <TSS>The evaluator shall examine the TSS and verify that it implements a policy to limit the user's enrollment of devices.</TSS>
              <Guidance>
                The evaluator shall ensure that the administrative guidance describes the methods of restricting user enrollment and that it instructs 
			  the administrator how to configure the restrictions.
                <h:br/>
                <h:br/>
              </Guidance>
              <Tests>
                For each type of policy selected, the evaluator shall perform the following:
                <testlist>
                  <test>The evaluator shall attempt to configure the MDM server according to the administrative guidance in order to prevent enrollment. The evaluator shall verify that the user cannot enroll a device outside of the configured limitation. (For example, the evaluator may try to enroll a disallowed device, or may try to enroll additional devices beyond the number allowed.)</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Failure of MD user authentication</audit-event-descr>
            <audit-event-info>Presented username</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FIA_TOK_EXT.1 Client Tokens -->
        <f-component cc-id="fia_tok_ext.1" id="fia-tok-ext-1" name="Client Tokens" status="sel-based">
          <comp-lev>defines requirements for generating unique tokens.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fia_tok_ext-1-1">
            <title>
              The TSF shall
              <selectables>
                <selectable id="fia_tok_ext.1.1_1">invoke platform-provided functionality</selectable>
                <selectable id="fia_tok_ext.1.1_2">implement functionality</selectable>
              </selectables>
              to use
              <selectables>
                <selectable id="fia_tok_ext.1.1_3">IMEI</selectable>
                <selectable id="fia_tok_ext.1.1_5">
                  <assignable>other unique device ID</assignable>
                </selectable>
              </selectables>
              to generate a unique token for each client device.
            </title>
            <note role="application">This SFR is included in the ST if "token as defined in FIA_TOK_EXT.1" is selected in FIA_CLI_EXT.1.</note>
            <aactivity>
              <TSS>
                The evaluator shall review the TSS and verify that the TSF uses either unique identifiers from the client device
                or a server-specific mechanism to generate a unique token that will be used for verifying the identity of the 
                client device. If the server generates the token using cryptographic functions, it must use algorithms in
                FCS_COP.1(ANY) (specific algorithms as needed by the vendor).
                <h:br/>
                <h:br/>
                If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it 
                describes (for each supported platform) how this functionality is invoked (it should be noted that this may be 
                through a mechanism that is not implemented by the MDM server; nonetheless, that mechanism will be identified in
                the TSS as part of this evaluation activity).
                <h:br/>
                <h:br/>
                If "implement functionality" is selected, the evaluator shall examine the TSS to verify that it describes the
                methods to generate the token.
              </TSS>
              <Guidance>None.</Guidance>
              <Tests>
                For each MDM agent or platform listed as supported in the ST:
                <testlist>
                  <test>The evaluator shall use appropriate combinations of specialized operational environment and development tools (debuggers, simulators, etc.) for the TOE and instrumented TOE builds as needed to perform this test.</test>
                  <test>The evaluator shall concurrently enroll 10 devices and ensure that the token for each is unique, per the methods described in the TSS.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FIA_UAU.1 Timing of Authentication -->
        <f-component cc-id="fia_uau.1" id="fia-uau-1" name="Timing of Authentication">
          <f-element id="fia-uau-1e1">
            <title>
              The TSF shall
              <selectables>
                <selectable id="fia_uau.1.1_1">
                  <h:b>invoke platform-provided functionality</h:b>
                </selectable>
                <selectable id="fia_uau.1.1_2">
                  <h:b>implement functionality</h:b>
                </selectable>
              </selectables>
              <h:b>to</h:b>
              allow
              <assignable>list of TSF mediated actions</assignable>
              on behalf of the user to be performed before the user is authenticated
              <h:b>with the server</h:b>.
            </title>
          </f-element>
          <f-element id="fel-uau-func">
            <title>The TSF shall  <selectables><selectable id="fia_uau.1.2_1"><h:b>invoke platform-provided functionality</h:b></selectable><selectable id="fia_uau.1.2_2"><h:b>implement functionality</h:b></selectable></selectables> <h:b>that</h:b> requires each user to be successfully authenticated <h:b>with the
                server</h:b> before allowing any other TSF-mediated actions on behalf of that user.</title>
            <note role="application">
              This requirement ensures that any user attempting to access the TSF must be authenticated. These users may be administrators
			attempting to administer the TOE or ordinary users attempting to enroll for management by the MDM system. The ST author is responsible for assigning 
			the list of actions that can take place before this authentication. The TSF or TOE platform may
			use enterprise authentication to meet this 
			requirement.
              <h:br/>
              <h:br/>
              For distributed TOEs, at least one TOE component has to support the authentication of administrators but not necessarily all TOE components. In case not 
			  all TOE components support authentication for administrators the TSS must describe how administrators are authenticated and identified.
            </note>
            <aactivity>
              <TSS>If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each supported platform)
                how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the MDM server; nonetheless, that
                mechanism will be identified in the TSS as part of this evaluation activity).</TSS>
              <Guidance>The evaluator shall examine the operational guidance to verify that it describes the process by which users authenticate to the TOE.</Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <h:br/>
                <h:br/>
                <testlist>
                  <test>The evaluator shall attempt to perform the prohibited actions before authentication. The evaluator shall verify the actions cannot be performed.</test>
                  <test>The evaluator shall attempt to perform the prohibited actions after authentication. The evaluator shall verify the actions can be performed.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FIA_UAU.4 Single-Use Authentication Mechanisms -->
        <f-component cc-id="fia_uau.4" id="fia-uau-4" name="Single-Use Authentication Mechanisms" status="objective">
          <f-element id="fia-uau-4e1">
            <title>The TSF shall prevent reuse of authentication data related to  <assignable>identified authentication mechanisms</assignable>.</title>
            <note role="application">
              This requirement references the authentication mechanisms
              used to authenticate the user for enrollment in
              <xref to="fel-enr-tsf"/>. If a username and
              password is used to authenticate the user for enrollment, the password must not be
              reused. Thus if the user has two devices enrolled in management or needs to re-enroll
              the same device (i.e., after a device wipe), the password must be different for each
              enrollment. Additionally, if two different users are enrolling the password must be
              different for each user.
            </note>
            <aactivity>
              <TSS>The evaluator shall verify that the TSS contains a description
                of the process of enrollment for each MDM agent or platform listed as
                supported in the ST. This description shall include the method of
                user authentication (username or password, token, etc.) and how reuse of the
                authentication data is prevented.</TSS>
              <Guidance>The evaluator shall ensure that the administrative guidance describes the methods
          of restricting user enrollment and that it instructs the administrator on how to configure
          the restrictions.</Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall enroll a device providing correct credentials. The evaluator shall attempt to enroll a second device using the same credentials used to enroll the first device. The evaluator shall verify that the second device could not enroll.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Attempt to reuse enrollment data</audit-event-descr>
            <audit-event-info>Enrollment data</audit-event-info>
          </audit-event>
        </f-component>
      </section>
      <!-- 5.1.5 Security Management (FMT) -->
      <section id="fmt" title="Security Management (FMT)">
        <ext-comp-def title="Trusted Policy Update" fam-id="FMT_POL_EXT">
          <fam-behavior>This family describes how to use digitally signed policies and updates by using private keys, and validating the policy is appropriate.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Security Attribute Expiration" fam-id="FMT_SAE_EXT">
          <fam-behavior>This family defines the requirements for using expiration time for enrollment and denying enrollment if that time has passed.</fam-behavior>
        </ext-comp-def>
        <!-- FMT_MOF.1/FUNCBE Management of Security Functions Behavior -->
        <f-component cc-id="fmt_mof.1" id="fmt-mof-1-funcbe" name="Management of Security Functions Behavior" iteration="FUNCBE">
          <f-element id="fel-gen-mas">
            <title>The TSF shall restrict the ability to <h:b>perform</h:b> the functions <h:ul><h:li>listed in FMT_SMF.1/SERVER_CONF_AGENT</h:li> <h:li>enable, disable, and modify policies listed in FMT_SMF.1/SERVER_CONF_AGENT</h:li> <h:li>listed in FMT_SMF.1/SERVER_CONF_SERVER</h:li> <h:li><selectables><selectable id="mas">enable, disable, and modify policies listed in FMT_SMF.1/MAS</selectable><selectable id="fmt_mof.1.1_FUNCBE_1">no other functions</selectable></selectables></h:li></h:ul> to [<h:i>authorized administrators</h:i>].</title>
            <note role="application">
              This requirement outlines the functions that administrators will have the power to enable, disable, modify, and monitor 
			functions and policies listed in FMT_SMF.1/SERVER_CONF_AGENT. It also includes functions necessary to maintain and configure the MDM server itself.
              <h:br/>
              <h:br/>
              You must select "enable, disable, and modify policies listed in FMT_SMF.1/MAS" if the TOE includes MAS functionality and FMT_SMF.1/MAS, 
			  FAU_GEN.1/MAS_SERVER, FMT_MOF.1/MANAGEMENT_MAS, FMT_SMR.1/SECMAN_ROLES_MAS must be included in
			  the ST.
              <h:br/>
              <h:br/>
              If "enable, disable, and modify policies listed in FMT_SMF.1/MAS" is chosen,
              <xref to="fmt-smr-1e1-sr"/>
              must be included in the ST.
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to ensure that it describes what security management functions are restricted to the
			  administrator and what actions can be taken for each management function. The evaluator shall verify that the security management functions are 
			  restricted to authorized administrators.</TSS>
              <Guidance>The evaluator shall examine the operational guidance to verify that it describes the management functions that are available to authorized administrators and how administrators are authorized to perform those particular functions (e.g. default for the account, role membership, group membership).</Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall attempt to access the functions and policies in FMT_SMF.1/SERVER_CONF_AGENT as an unauthorized user and verify that the attempt fails.</test>
                  <test>[conditional] The evaluator shall attempt to access the functions and policies in FMT_SMF.1/MAS as an unauthorized user and verify that the attempt fails.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Issuance of command to perform function</audit-event-descr>
            <audit-event-info>Command sent and identity of MDM agent recipients</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>Change of policy settings</audit-event-descr>
            <audit-event-info>Policy changed and value or full policy</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FMT_MOF.1/MANAGEMENT_ENROLL Management of Security Functions Behavior (Enrollment) -->
        <f-component cc-id="fmt_mof.1" id="fmt-mof-1-management-enroll" name="Management of Security Functions Behavior (Enrollment)" iteration="MANAGEMENT_ENROLL">
          <f-element id="fmt-mof-1e1">
            <title>
              The
              <h:b>MDM server</h:b>
              shall restrict the ability to
              [<h:b>
                <h:i>initiate the enrollment process</h:i>
              </h:b>] to [<h:i>authorized 
			administrators and MD users</h:i>].
            </title>
            <note role="application">
              This requirement outlines the enrollment functions that both administrators and MD users may perform.
	      The enrollment actions are identified in the TSS as a part of FIA_ENR_EXT.1.
              <h:br/>
              <h:br/>
              The authorized administrator does not remotely initiate enrollment of the MDs that are in the possession of users but may enroll
		MDs when they are in the possession of the administrator, for example, before distributing the MDs to the users.
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS and verify that it describes how unauthorized users are prevented from enrolling in the MDM services.</TSS>
              <Guidance>The evaluator shall examine the operational guidance to verify that it describes the enrollment process and any restrictions that may prevent unauthorized enrollment.</Guidance>
              <Tests>The test of this function is performed in conjunction with FIA_ENR_EXT.1.</Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Enrollment by a user</audit-event-descr>
            <audit-event-info>Identity of user</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FMT_MOF.1/MANAGEMENT_MAS Management of Functions in (MAS Server Downloads) -->
        <f-component cc-id="fmt_mof.1" id="fmt-mof-1-management-mas" name="Management of Functions in (MAS Server Downloads)" iteration="MANAGEMENT_MAS" status="sel-based">
          <f-element id="fmt-mof-1e1-mas">
            <title>
              The
              <h:b>MAS Server</h:b>
              shall restrict the ability to [<h:i>enable, modify the
              behavior of</h:i>] the functions [<h:i>downloading applications</h:i>] to
              [<h:i>enrolled MDs that are compliant with MDM policies and assigned to a
                user in the application access group</h:i>].
            </title>
            <note role="application">This requirement is claimed if "enable, disable, and modify policies listed in
              FMT_SMF.1/MAS" is selected in FMT_MOF.1.1/FUNCBE.</note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to determine that all methods of initiating an application download or update push are specified.</TSS>
              <Guidance>The evaluator shall confirm that the operational guidance contains how to initiate an application download or update push.</Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall ensure that the MAS Server verifies that the MD is enrolled in the MDM Server and is in a compliant state. The evaluator shall verify that either none, or only those applications needed for enrollment, can be downloaded from the MAS Server prior to enrolling the MD with the MDM.</test>
                  <test>The evaluator shall ensure that the MAS Server verifies that the MD is enrolled in the MDM Server and is in a compliant state. The evaluator shall make policy changes to make the enrolled MD non-compliant. The evaluator shall verify that either none, or only those applications needed to bring the MD back into compliance, are able to be downloaded.</test>
                  <test>The evaluator shall ensure that the MAS Server verifies that the MD is enrolled in the MDM Server and is in a compliant state. The evaluator shall unenroll the MD and verify that an application can not be downloaded from the MAS Server after unenrollment.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FMT_POL_EXT.1 Trusted Policy Update -->
        <f-component cc-id="fmt_pol_ext.1" id="fmt-pol-ext-1" name="Trusted Policy Update">
          <comp-lev>defines requirements for using digitally signed policies and policy updates.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>
            The following actions should be auditable if FAU_GEN security audit data generation
            is included in the PP or ST.
            <h:ul>
              <h:li>Attempt to reuse enrollment data.</h:li>
              <h:li>Enrollment data.</h:li>
            </h:ul>
          </audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fmt-pol-ext-1e1">
            <title>The TSF shall provide digitally signed policies and policy updates to the  <selectables><selectable id="fmt_pol_ext.1.1_1">MDM agent</selectable><selectable id="fmt_pol_ext.1.1_2">subordinate MDM server</selectable></selectables>.</title>
            <note role="application">The intent of this requirement is to cryptographically tie the policies to the enterprise that mandated the policy, not to
              protect the policies in transit (as they are already protected by FPT_ITT.1/INTER_XFER / FPT_ITT.1/INTER_XFER_AGENT or FTP_ITC.1/INTER_TSF_XFER_AGENT). This is especially critical for users who connect to multiple enterprises.</note>
          </f-element>
          <f-element id="fmt-pol-ext-1e2">
            <title>
              The TSF shall sign policies and policy updates using a private key associated with
              <selectables>
                <selectable id="fmt_pol_ext.1.2_1">an X509 certificate</selectable>
                <selectable id="fmt_pol_ext.1.2_2">a public key provisioned to the agent or subordinate MDM server</selectable>
              </selectables>
              trusted by the agent or subordinate MDM server for policy verification.
            </title>
            <note role="application">If "an X509 certificate" is selected, the "policy signing" option in FIA_X509_EXT.2 is also claimed.</note>
          </f-element>
          <f-element id="fmt-pol-ext-1e3">
            <title>
              For each unique policy managed by the TSF, the TSF shall validate that the policy is appropriate for an 
          agent or subordinate MDM server using
              <selectables>
                <selectable id="fmt_pol_ext.1.3_1">client authentication via an X509 certificate representing the agent or subordinate MDM server</selectable>
                <selectable id="fmt_pol_ext.1.3_2">a token issued to the agent or subordinate MDM server and associated with a policy signing key uniquely associated to the policy</selectable>
              </selectables>.
            </title>
            <note role="application">If "client authentication via an X509 certificate representing the agent subordinate MDM server" is claimed, the appropriate protocol in 
            FIA_X509_EXT.2 is also claimed. If "a token issued to the agent or subordinate MDM server and associated with a unique policy signing key 
            uniquely associated to the policy" is claimed, FIA_TOK_EXT.1.1 is also claimed and the TSF maintains the 
            association of the key pairs and the agent or subordinate MDM server tokens. When multiple policies are supported, a unique policy signing
            key for each policy is used.</note>
            <aactivity>
              <TSS>The evaluator shall verify that the ST describes how policies are signed, to include whether the private 
                key used for signing is associated with an X509 certificate or public key, the method for distributing the 
                policy verification material (a certificate or provisioned public key) to the agent or subordinate MDM server, and the method for 
                distinguishing whether a policy is appropriate for an agent or subordinate MDM server. If tokens are claimed in FMT_POL_EXT.1.3, 
                the evaluator shall verify the ST describes how tokens are established and
                distributed to the agent or subordinate MDM server.</TSS>
              <Guidance>If applicable, the evaluator shall verify that the operational guidance
                instructs administrators on configuring the enterprise certificate to be used for signing policies or signing the policies before applying them.</Guidance>
              <Tests>The evaluator shall perform a policy update in accordance with FMT_SMF.1/SERVER_CONF_AGENT. The evaluator shall examine the policy either at the TOE, in transmission, or at the MDM agent, and verify the TSF signs the update and provides it to the MDM agent or subordinate MDM server.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FMT_POL_EXT.3 Subordinate MDM Trusted Policy Update -->
        <f-component cc-id="fmt_pol_ext.3" id="fmt-pol-ext-3" name="Subordinate MDM Trusted Policy Update" status="sel-based">
          <comp-lev>defines requirements for using digitally signed policies and policy updates by the subordinate MDM server.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>
            The following actions should be auditable if FAU_GEN security audit data generation
            is included in the PP or ST.
            <h:ul>
              <h:li>Attempt to reuse enrollment data.</h:li>
              <h:li>Enrollment data.</h:li>
            </h:ul>
          </audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fmt-pol-ext-3e1">
            <title>The TSF shall only accept policies and policy updates that are digitally signed by a private key that has been authorized for policy updates by the primary MDM server.</title>
            <note role="application">The intent of this requirement is to cryptographically tie the policies to the enterprise that mandated the policy, not to
              protect the policies in transit (as they are already protected by FTP_ITC.1/INTER_XFER_IT). This is especially critical for users who connect to multiple enterprises.</note>
          </f-element>
          <f-element id="fmt-pol-ext-3e2">
            <title>The TSF shall not process policies for the MDM agent if the signature check fails.</title>
            <aactivity>
              <TSS>The evaluator ensures that the TSS describes how the candidate policies are obtained by the subordinate MDM server, the processing associated with verifying the digital signature of the policy updates, and the actions that take place for successful (signature was verified) and unsuccessful (signature could not be verified) cases. The software components that are performing the processing must also be identified in the TSS and verified by the evaluators.</TSS>
              <Guidance/>
              <Tests>
                This evaluation activity is performed in conjunction with the evaluation activity for FIA_X509_EXT.1/CERTVAL_MAN and FIA_X509_EXT.2
                <testlist>
                  <test>The evaluator shall perform a policy update from an available configuration interface (such as through a test primary MDM Server). The evaluator shall verify the update is signed and is provided to the subordinate MDM server. The evaluator shall verify the subordinate MDM server accepts the digitally signed policy.</test>
                  <test>The evaluator shall perform a policy update from an available configuration interface (such as through a test primary MDM Server). The evaluator shall provide an unsigned and an incorrectly signed policy to the subordinate MDM server. The evaluator shall verify the subordinate MDM server does not accept the digitally signed policy.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FMT_SAE_EXT.1 Security Attribute Expiration -->
        <f-component cc-id="fmt_sae_ext.1" id="fmt-sae-ext-1" name="Security Attribute Expiration" status="objective">
          <comp-lev>defines requirements for the expiration time for enrollment authentication.</comp-lev>
          <management>
            The following action could be considered for the management functions in FMT.
            <h:ul>
              <h:li>Configure the length of time the enrollment authenticator is valid.</h:li>
            </h:ul>
          </management>
          <audit>
            The following actions should be auditable if FAU_GEN security audit data generation
            is included in the PP or ST.
            <h:ul>
              <h:li>Enrollment attempted after expiration of authentication data.</h:li>
              <h:li>Identity of user.</h:li>
            </h:ul>
          </audit>
          <dependencies>
            <no-link>FIA_ENR_EXT.1</no-link>
            Enrollment
            <h:br/>
            <no-link>FIA_UAU.4</no-link>
            Single-Use Authentication Mechanisms
          </dependencies>
          <f-element id="fmt-sae-ext-1e1">
            <title>The TSF shall be able to specify a configurable expiration time for enrollment authentication data. </title>
          </f-element>
          <f-element id="fmt_sae_ext-1-2">
            <title>The TSF shall be able to deny enrollment after the expiration time for the enrollment authentication data has passed.</title>
            <note role="application">
              This requirement references the user authenticator used for device enrollment in management in
              <xref to="fel-enr-tsf"/>. The user
              authenticator must only be valid for a configurable time limit. If the authenticator is expired, even if entered correctly, enrollment must not occur.
              <h:br/>
              <h:br/>
              The length of the time the authenticator is valid for is configured per function c.5 in FMT_SMF.1/SERVER_CONF_SERVER. If FMT_SAE_EXT.1 is included in the ST, then 
              function g must be selected in FMT_SMF.1/SERVER_CONF_SERVER.
            </note>
            <aactivity>
              <TSS>The evaluator shall verify that the TSS contains a description of the process of
                enrollment for each MDM agent or platform listed as supported in the ST. This
                description shall be the method of user authentication (username or password, token, etc.).</TSS>
              <Guidance>The evaluator shall check to ensure that the operational guidance contains instructions to configure the expiration time for each method of user authentication listed in the TSS.</Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall configure the MDM server according to the administrative guidance to set an expiration time for the enrollment authentication data. For each method of user authentication listed in the TSS, the evaluator shall attempt to enroll using authentication data that has expired. The evaluator shall verify that enrollment was unsuccessful.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Enrollment attempted after expiration of authentication data</audit-event-descr>
            <audit-event-info>Identity of user</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FMT_SMF.1/MAS Specification of Management Functions (MAS Server) -->
        <f-component cc-id="fmt_smf.1" id="fmt-smf-1-mas" name="Specification of Management Functions (MAS Server)" iteration="MAS" status="sel-based">
          <f-element id="fmt-smf-1e1-mas">
            <title>
              The
              <h:b>MAS Server</h:b>
              shall be capable of performing the following management functions:
              [<h:i>
                <h:ul>
                  <h:li>Configure application access groups</h:li>
                  <h:li>Download applications</h:li>
                  <h:li><selectables>
                      <selectable id="fmt_smf.1.1_MAS_2">
                        <assignable>other MAS management functions</assignable>
                      </selectable>
                      <selectable id="fmt_smf.1.1_MAS_3">no other functions</selectable>
                    </selectables></h:li>
                </h:ul>
              </h:i>]
            </title>
            <note role="application">
              This requirement captures all the configuration functionality in the MAS Server to configure the underlying MAS Server. The ST author can add more commands and configuration policies by completing the assignment statement.
              <h:br/>
              <h:br/>
              The MAS Server must be able to create groups to configure which applications a user can access based on which group they are in. If the MAS Server uses the groups defined by the MDM, then it must communicate with the MDM server (if separate server) to determine which applications the user can access.
              <h:br/>
              <h:br/>
              This requirement is claimed if "enable, disable, and modify policies listed in FMT_SMF.1/MAS" is selected in FMT_MOF.1.1/FUNCBE.
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to ensure that it describes each management function listed.<h:br/><h:br/>The evaluator shall examine the TSS to determine if the MAS Server creates its own groups or relies on the groups specified by the MDM server.</TSS>
              <Guidance>
                The evaluator shall confirm that the operational guidance contains how to create and define user groups and how to specify which applications are accessible by which group.
                <h:br/>
                <h:br/>
                The evaluator shall verify the operational guidance includes detailed instructions of what options are available and how to configure each management functional capability listed.
              </Guidance>
              <Tests>The evaluator shall ensure that the MAS client can only access the applications specified for the group they are enrolled in. The evaluator shall create a user group, making sure that the MAS client user is excluded from the group. Verify that an application accessible to that group cannot be accessed. The evaluator shall include the MAS client user in the group and assure that the application can be accessed.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FMT_SMF.1/SERVER_CONF_AGENT Specification of Management Functions (Server configuration of Agent) -->
        <f-component cc-id="fmt_smf.1" id="fmt-smf-1-server-conf-agent" name="Specification of Management Functions (Server configuration of Agent)" iteration="SERVER_CONF_AGENT">
          <f-element id="fel-smf-man-agnt">
            <title>
              The
              <h:b>MDM server</h:b>
              shall be capable of
              <h:b>communicating the following commands to the MDM agent: </h:b>
              <h:ul style="list-style-type:none">
                <h:li><ctr id="smf1" ctr-type="mgmt" pre=""/>. Transition to the locked state (MDF Function 6)</h:li>
                <h:li><ctr id="smf2" ctr-type="mgmt" pre=""/>. Full wipe of protected data (MDF Function 7)</h:li>
                <h:li><ctr id="smf3" ctr-type="mgmt" pre=""/>. Unenroll from management</h:li>
                <h:li><ctr id="smf4" ctr-type="mgmt" pre=""/>. Install policies</h:li>
                <h:li><ctr id="smf5" ctr-type="mgmt" pre=""/>. Query connectivity status</h:li>
                <h:li><ctr id="smf6" ctr-type="mgmt" pre=""/>. Query the current version of the MD firmware or software</h:li>
                <h:li><ctr id="smf7" ctr-type="mgmt" pre=""/>. Query the current version of the hardware model of the device</h:li>
                <h:li><ctr id="smf8" ctr-type="mgmt" pre=""/>. Query the current version of installed applications</h:li>
                <h:li><ctr id="smf9" ctr-type="mgmt" pre=""/>. Import X.509v3 certificates into the Trust Anchor Database (MDF Function 11)</h:li>
                <h:li><ctr id="smf10" ctr-type="mgmt" pre=""/>. Install applications (MDF Function 16)</h:li>
                <h:li><ctr id="smf11" ctr-type="mgmt" pre=""/>. Update system software (MDF Function 15)</h:li>
                <h:li><ctr id="smf12" ctr-type="mgmt" pre=""/>. Remove applications (MDF Function 14)</h:li>
              </h:ul>
              <selectables>
                <selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_1"><ctr id="smf13" ctr-type="mgmt" pre=""/>. Remove enterprise applications (MDF Function 17)</selectable>
                <selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_2"><ctr id="smf14" ctr-type="mgmt" pre=""/>. Wipe enterprise data (MDF Function 28)</selectable>
                <selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_3"><ctr id="smf15" ctr-type="mgmt" pre=""/>. Remove imported X.509v3 certificates and <selectables linebreak="yes"><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_4">no other X.509v3 certificates</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_6"><assignable>list of other categories of X.509v3 certificates</assignable></selectable></selectables> in the Trust Anchor Database (MDF Function 12)</selectable>
                <selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_7"><ctr id="smf16" ctr-type="mgmt" pre=""/>. Alert the user</selectable>
                <selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_8"><ctr id="smf17" ctr-type="mgmt" pre=""/>. Import keys or secrets into the secure key storage (MDF Function 9)</selectable>
                <selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_9"><ctr id="smf18" ctr-type="mgmt" pre=""/>. Destroy imported keys or secrets and <selectables linebreak="yes"><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_10">no other keys or secrets</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_12"><assignable>list of other categories of keys or secrets</assignable></selectable></selectables> in the secure key storage (MDF Function 10)</selectable>
                <selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_13"><ctr id="smf19" ctr-type="mgmt" pre=""/>. Read audit logs kept by the MD (MDF Function 32)</selectable>
                <selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_14"><ctr id="smf20" ctr-type="mgmt" pre=""/>. Retrieve MD-software integrity verification values (MDF Function 38)</selectable>
                <selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_15"><ctr id="smf21" ctr-type="mgmt" pre=""/>. Approve exceptions for sharing data between <selectables linebreak="yes"><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_16">application processes</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_17">group of application processes</selectable></selectables> (MDF Function 42)</selectable>
                <selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_18"><ctr id="smf22" ctr-type="mgmt" pre=""/>. Place applications into application process groups based on <assignable>application characteristics</assignable> (MDF Function 43)</selectable>
                <selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_20"><ctr id="smf23" ctr-type="mgmt" pre=""/>. Revoke Biometric template (MDF Function 46)</selectable>
                <selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_21"><ctr id="smf24" ctr-type="mgmt" pre=""/>. <assignable>list of other management functions to be provided by the MD</assignable></selectable>
                <selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_23">no other management functions</selectable>
              </selectables>
              <h:b>and the following MD configuration policies</h:b>
              :
              <h:ul style="list-style-type:none">
                <h:li><ctr id="smf25" ctr-type="mgmt" pre=""/>. Password policy: <h:ol type="a"><h:li>minimum password length</h:li> <h:li>minimum password complexity</h:li> <h:li>maximum password lifetime (MDF Function 1)</h:li></h:ol></h:li>
                <h:li><ctr id="smf26" ctr-type="mgmt" pre=""/>. Session locking policy: <h:ol type="a"><h:li>screen-lock enabled and disabled</h:li> <h:li>screen lock timeout</h:li> <h:li>number of authentication failures (MDF Function 2)</h:li></h:ol></h:li>
                <h:li><ctr id="smf27" ctr-type="mgmt" pre=""/>. Wireless networks (SSIDs) to which the MD may connect (WLAN Client PP-Module Function WL-2)</h:li>
                <h:li>
                  <ctr id="smf28" ctr-type="mgmt" pre=""/>. Security policy for each wireless network:
                  <h:ol type="a">
                    <h:li>
                      <selectables linebreak="yes">
                        <selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_24">specify the CAs from which the MD will accept WLAN authentication server certificates</selectable>
                        <selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_25">specify the FQDNs of acceptable WLAN authentication server certificates</selectable>
                      </selectables></h:li>
                    <h:li>ability to specify security type</h:li>
                    <h:li>ability to specify authentication protocol</h:li>
                    <h:li>specify the client credentials to be used for authentication</h:li>
                    <h:li><assignable>any additional WLAN management functions</assignable>  (WLAN Client PP-Module Function WL-1)</h:li>
                  </h:ol>
                </h:li>
                <h:li><ctr id="smf29" ctr-type="mgmt" pre=""/>. Application installation policy by  <selectables linebreak="yes"><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_27">specifying authorized application repositories</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_28">specifying a set of allowed applications and versions (an application allowlist)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_29">denying application installation</selectable></selectables>, (MDF Function 8)</h:li>
                <h:li><ctr id="smf30" ctr-type="mgmt" pre=""/>. Enable and disable policy for <assignable>list of audio or visual collection devices</assignable>  across device,  <selectables linebreak="yes"><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_31">on a per-app basis</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_32">on a per-group of applications processes basis</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_33">no other method</selectable></selectables>, (MDF Function 5)</h:li>
              </h:ul>
              <h:ul style="list-style-type:none"><selectables linebreak="yes"><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_34"><ctr id="smf31" ctr-type="mgmt" pre=""/>. Enable and disable policy for the VPN protection across MD, <selectables linebreak="yes"><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_35">on a per-app basis</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_36">on a per-group of application processes basis</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_37">no other method</selectable></selectables> (MDF Function 3)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_38"><ctr id="smf32" ctr-type="mgmt" pre=""/>. Enable and disable policy for <assignable>list of radios</assignable>, (MDF Function 4)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_40"><ctr id="smf33" ctr-type="mgmt" pre=""/>. Enable and disable policy for data signaling over <assignable>list of externally accessible hardware ports</assignable>, (MDF Function 24)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_42"><ctr id="smf34" ctr-type="mgmt" pre=""/>. Enable and disable policy for <assignable>list of protocols where the device acts as a server</assignable>, (MDF Function 25)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_44"><ctr id="smf35" ctr-type="mgmt" pre=""/>. Enable and disable policy for developer modes, (MDF Function 26)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_45"><ctr id="smf36" ctr-type="mgmt" pre=""/>. Enable policy for data-at-rest protection, (MDF Function 19)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_46"><ctr id="smf37" ctr-type="mgmt" pre=""/>. Enable policy for removable media's data-at-rest protection, (MDF Function 20)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_47"><ctr id="smf38" ctr-type="mgmt" pre=""/>. Enable and disable policy for local authentication bypass, (MDF Function 27)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_48"><ctr id="smf39" ctr-type="mgmt" pre=""/>. The Bluetooth trusted channel policy:<h:br/><h:ol type="a"><h:li>Disable/enable the Discoverable (for BR/EDR) and Advertising (for LE) modes (Bluetooth PP-Module Function BT-1)</h:li><h:li>change the Bluetooth device name (Bluetooth PP-Module Function BT-2), <selectables linebreak="yes"><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_49">Provide separate controls for turning the BR/EDR and LE radios on and off (Bluetooth PP-Module Function BT-3)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_50">allow and disallow additional wireless technologies to be used with Bluetooth (Bluetooth PP-Module Function BT-4)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_51">configure allowable methods of Out of Band pairing (Bluetooth PP-Module Function BT-5)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_52">disable and enable Discoverable (for BR/EDR) and Advertising (for LE) modes separately (Bluetooth PP-Module Function BT-6)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_53">disable and enable the Connection mode (Bluetooth PP-Module Function BT-7)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_54">disable and enable the Bluetooth services or profiles available on the device (Bluetooth PP-Module Function BT-8)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_55">specify minimum level of security for each pairing (Bluetooth PP-Module Function BT-9)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_56">no other Bluetooth configuration</selectable></selectables></h:li></h:ol></selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_57"><ctr id="smf40" ctr-type="mgmt" pre=""/>. Enable and disable policy for display notification in the locked state of <h:br/><h:ol type="a"><selectables linebreak="yes"><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_58">email notifications</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_59">calendar appointments</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_60">contact associated with phone call notification</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_61">text message notification</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_62">other application-based notifications</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_63">none</selectable></selectables> (MDF Function 18) </h:ol></selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_64"><ctr id="smf41" ctr-type="mgmt" pre=""/>. Policy for establishing a trusted channel or disallowing establishment if the MD cannot establish a connection to determine the validity of a certificate, (MDF Function 30)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_65"><ctr id="smf42" ctr-type="mgmt" pre=""/>. Enable and disable policy for the cellular protocols used to connect to cellular network base stations, (MDF Function 31)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_66"><ctr id="smf43" ctr-type="mgmt" pre=""/>. Policy for import and removal by applications of X.509v3 certificates in the Trust Anchor Database, (MDF Function 29)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_67"><ctr id="smf44" ctr-type="mgmt" pre=""/>. <selectables linebreak="yes"><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_68">certificate</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_69">public-key</selectable></selectables> used to validate digital signature on applications, (MDF Function 33)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_70"><ctr id="smf45" ctr-type="mgmt" pre=""/>. Policy for exceptions for shared use of keys or secrets by multiple applications, (MDF Function 34)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_71"><ctr id="smf46" ctr-type="mgmt" pre=""/>. Policy for exceptions for destruction of keys or secrets by applications that did not import the key or secret, (MDF Function 35)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_72"><ctr id="smf47" ctr-type="mgmt" pre=""/>. The unlock banner policy, (MDF Function 36)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_73"><ctr id="smf48" ctr-type="mgmt" pre=""/>. Configure the auditable items (MDF Function 37)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_74"><ctr id="smf49" ctr-type="mgmt" pre=""/>. Enable and disable <selectables linebreak="yes"><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_75">USB mass storage mode</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_76">USB data transfer without user authentication</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_77">USB data transfer without authentication of the connection system</selectable></selectables> (MDF Function 39)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_78"><ctr id="smf50" ctr-type="mgmt" pre=""/>. Enable and disable backup of <selectables linebreak="yes"><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_79">all applications</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_80">selected applications</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_81">selected groups of applications</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_82">configuration data</selectable></selectables> to <selectables><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_83">locally connected system</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_84">remote system</selectable></selectables> (MDF Function 40)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_85"><ctr id="smf51" ctr-type="mgmt" pre=""/>. Enable and disable <selectables linebreak="yes"><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_86">Hotspot functionality authenticated by <selectables><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_87">pre-shared key</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_88">passcode</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_89">no authentication</selectable></selectables> </selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_90">USB tethering authenticated by <selectables><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_91">pre-shared key</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_92">passcode</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_93">no authentication</selectable></selectables> </selectable></selectables> (MDF Function 41)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_94"><ctr id="smf52" ctr-type="mgmt" pre=""/>. Enable and disable location services:<h:br/> <selectables linebreak="yes"><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_95">across device</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_96">on a per-app basis</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_97">on a per-group of application processes basis</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_98">no other method</selectable></selectables> (MDF Function 21)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_99"><ctr id="smf53" ctr-type="mgmt" pre=""/>. Enable and disable policy for user unenrollment</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_100"><ctr id="smf54" ctr-type="mgmt" pre=""/>. Enable and disable policy for the Always-On VPN protection across device (MDF Function 45)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_101"><ctr id="smf55" ctr-type="mgmt" pre=""/>. Enable and disable policy for use of Biometric Authentication Factor (MDF Function 22)</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_102"><ctr id="smf56" ctr-type="mgmt" pre=""/>. Connectivity timeout policy: <selectables linebreak="yes"><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_103">allowed <selectables><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_104">number of missed reachability events</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_105">length of time without server connectivity</selectable></selectables> </selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_106">when server connectivity timeout is exceeded agent shall <selectables><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_107">disable user password</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_108">wipe device</selectable></selectables> and <selectables><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_110"><assignable>other action</assignable></selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_111">none</selectable></selectables> </selectable></selectables> </selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_112"><ctr id="smf57" ctr-type="mgmt" pre=""/>. Enable and disable multi-user modes</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_113"><ctr id="smf58" ctr-type="mgmt" pre=""/>. Enable and disable automatic updates of system software</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_114"><ctr id="smf59" ctr-type="mgmt" pre=""/>. Enable and disable removable media</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_AGENT_115"><ctr id="smf60" ctr-type="mgmt" pre=""/>. <assignable>list of other policies to be provided by the MD</assignable>, no other policies</selectable></selectables>.</h:ul>
            </title>
            <note role="application">
              This requirement captures all the configuration functionality the TSF provides the administrator to configure the MDM
		    agent. This requirement is broken into two configurable areas: MDM agent commands and MDM agent policies. The ST author can add more
		    commands and configuration policies by completing the appropriate assignment statements.
              <h:br/>
              <h:br/>
              Function-specific Application Notes:
              <h:br/>
              <h:br/>
              Function-specific application notes reference Mobile Device Fundamentals (MDF) PP v4.0.
              <h:br/>
              <h:br/>
              Function
              <xref to="smf12"/>
              may be satisfied for the BYOD use case by application denylisting or disabling. In the case of BYOD, an enterprise may not want to remove "personal" applications, thus for that use case disabling the application rather than removing it would allow the user to not lose any information they might have in the application.
              <h:br/>
              <h:br/>
              Function
              <xref to="smf16"/>
              provides the MDM server to display an alert to the user of the MD.
              <h:br/>
              <h:br/>
              The audit data read according to Function
              <xref to="smf19"/>
              are to be transmitted to an external audit server according to FAU_STG.1. The MDM server is not expected to retain those logs.
              <h:br/>
              <h:br/>
              Function
              <xref to="smf34"/>
              provides the ability to enable and disable policy for the list of protocols where the device acts as a server, such as a mobile hotspot.
              <h:br/>
              <h:br/>
              Function
              <xref to="smf56"/>
              corresponds to FPT_NET_EXT.1.1 in agent. If the MDM agent has not had a successful reachability event with the MDM server in the amount of time specified in 'a', then the agent must perform the action selected in 'b'. It is feasible, but not required, that if multiple actions are selected in 'b', each action could be associated with a different timeout in 'a'. If function
              <xref to="smf56"/>
              is included in the ST, than FPT_NET_EXT.1.1 must be included in the agent ST.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to ensure that it describes each management function claimed. The evaluator shall examine the TSS to
		      ensure that it identifies the management functions implemented for each supported MDM agent or platform, which are likely to be subsets of 
		      all of the management functions available to the administrator on the MDM server. The evaluator shall examine the TSS to verify that any
		      differences between management functions and policies for each supported MDM agent or platform are clearly indicated.
                <h:br/>
                <h:br/>
                The evaluator shall determine if the MD has been evaluated. If so, the evaluator shall examine the TSS to verify that it 
		      clearly identifies which management functions match the selections and assignments of the
		      evaluated MD and which management 
		      functions were not evaluated.
              </TSS>
              <Guidance>For each command that the TSF can issue to an MDM agent and for each mobile device configuration policies that can be applied, the evaluator shall examine the operational guidance to verify that it includes instructions on how to perform these actions, and what particular parameters or options can be specified for them.</Guidance>
              <Tests>
                For each MDM agent or platform listed as supported in the ST:
                <testlist>
                  <test>The evaluator shall verify the ability to command each MDM agent functional capability and configure each MDM agent policy listed above.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FMT_SMF.1/SERVER_CONF_SERVER Specification of Management Functions (Server Configuration of Server) -->
        <f-component cc-id="fmt_smf.1" id="fmt-smf-1-server-conf-server" name="Specification of Management Functions (Server Configuration of Server)" iteration="SERVER_CONF_SERVER">
          <f-element id="fmt-smf-1e1">
            <title>
              The TSF shall be capable of performing the following management functions.
              <h:ol type="a">
                <h:li>Configure the  <selectables><selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_1">devices specified by <selectables><selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_2">IMEI</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_4"><assignable>a unique device ID</assignable></selectable></selectables> </selectable><selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_5">specific device models</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_6">a number of devices</selectable><selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_7">specific time period</selectable></selectables>  and  <selectables><selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_9"><assignable>other features</assignable></selectable><selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_10">no other features</selectable></selectables>  allowed for enrollment</h:li>
                <h:li>
                  <selectables>
                    <selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_11"><h:br/>1. Choose X.509v3 certificates for MDM server use</selectable>
                    <selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_12"><h:br/>2. Allow the administrator to choose whether to accept the certificate when connection cannot be made to establish validity</selectable>
                    <selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_13"><h:br/>3. Configure the TOE unlock banner</selectable>
                    <selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_14"><h:br/>4. Configure periodicity of the following commands to the agent: <assignable>list of commands</assignable></selectable>
                    <selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_16"><h:br/>5. Configure the privacy-sensitive information that will and will not be collected from particular MDs</selectable>
                    <selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_17"><h:br/>6. Configure the length of time the enrollment authenticator is valid</selectable>
                    <selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_18"><h:br/>7. Configure the interaction between TOE components</selectable>
                    <selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_19"><h:br/>8. Configure the cryptographic functionality</selectable>
                    <selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_20"><h:br/>9. Configure the interaction with the primary MDM server</selectable>
                    <selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_21"><h:br/>10. Configure the interaction with the subordinate MDM server</selectable>
                    <selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_22"><h:br/>11. <assignable>other management functions</assignable></selectable>
                    <selectable id="fmt_smf.1.1_SERVER_CONF_SERVER_24"><h:br/>12. No other management functions</selectable>
                  </selectables></h:li>
              </h:ol>
            </title>
            <note role="application">
              This requirement captures all the configuration functionality in the MDM server to configure 
			the underlying MDM server. The ST author can add more commands and configuration policies by completing the assignment
			statement.
              <h:br/>
              <h:br/>
              Function b1 is selection-based under the very limited circumstances when certificate management is both 
              performed solely by platform-provided functionality and the platform uses cloud services; for all other
              instances it is mandatory. This requirement will be made fully mandatory again in a future version of 
              the PP. Function b1 can be met by relying on the platform to configure the certificates used by the MDM
              server, however, the MDM server must allow the administrator to choose which certificate is used for a 
              specific functionality. The selection in a corresponds to the selection in
              <xref to="fel-enr-limit"/>.
              The selection in b.2 includes a function that corresponds to the selection in
              <xref to="fel-x509-fail"/>.
              Function b.4 allows the administrator to configure
			        periodicity of assigned commands, for example "read audit logs kept by the MD." In this way the 
			        administrator can configure the MDM system to retrieve audit logs from the MD on a periodic, such as
			        daily, basis in order to ensure freshness of log data and to minimize loss of audit logs.
			        Function b.5 allows the
			        administrator to configure the privacy-sensitive information that will and will not be collected from particular
			        MDs to handle BYOD environments where some information may not be appropriate to collect. Privacy
			        sensitive information may include items such as device physical location and lists of installed personal
			        applications, and would vary depending on the particular capabilities of the TOE and MDM agent. The TOE should
			        provide the capability to group enrolled devices into categories such as enterprise-owned and personal-owned and 
			        define the information that will be collected from devices in each category. Function b.6 corresponds to 
			        configuring the length of time the user authenticator for enrollment is valid in FMT_SAE_EXT.1. This function
			        must be included in the ST if and only if FMT_SAE_EXT.1 is included in the ST.
              <h:br/>
              <h:br/>
              For distributed TOEs, the interaction between TOE components will be configurable (see FCO_CPC_EXT.1). Therefore,
			  the ST author includes the selection "Ability to configure the interaction between TOE components" for distributed 
			  TOEs. A simple example would be the change of communication protocol according to FPT_ITT.1/INTER_XFER. Another
			  example would be changing the management of a TOE component from direct remote administration to remote
			  administration through another TOE component. A more complex use case would be if the realization of an SFR is 
			  achieved through two or more TOE components and the responsibilities between the two or more components could 
			  be modified.
              <h:br/>
              <h:br/>
              For distributed TOEs, that implement a registration channel (as described in
              <xref to="fel-cpc-func"/>), the ST
			  author uses the selection "configure the cryptographic functionality" in this SFR, and its corresponding mapping 
			  in the TSS, to describe the configuration of any cryptographic aspects of the registration channel that can be
			  modified by the operational environment in order to improve the channel security.
              <h:br/>
              <h:br/>
              Functions b.9 and b.10 allow the administrator to configure the use of a subordinate MDM server to pass MDM policy files 
              to an MDM agent on a managed device. This includes configuring the authentication and communication mechanisms 
              necessary to establish secure channels between the primary MDM server and subordinate MDM server. If the TOE acts as the
              primary MDM server, then
              <h:i>"Configure the interaction with the subordinate MDM server"</h:i>
              should be selected. If the
              TOE acts as a subordinate MDM server then
              <h:i>"Configure the interaction with the primary MDM server" should be selected.</h:i>
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to ensure that it describes each management
                function listed. For function b.5, the evaluator shall examine the TSS to ensure that it describes the privacy-sensitive information that the TOE has the capability to collect from enrolled MDs.</TSS>
              <Guidance> The evaluator shall verify the operational guidance includes detailed instructions of what options are available and how to configure each management functional capability listed.</Guidance>
              <Tests>
                The tests of functions a, b.2, b.3, and b.6 are performed in conjunction with the use of the function. Test 3 also covers function b.5. The evaluator shall perform the following tests:
                <testlist>
                  <test>The evaluator shall configure the TSF authentication certificates and verify that the correct certificate is used in established trusted connections (FPT_ITT.1/INTER_XFER, FPT_ITT.1/INTER_XFER_AGENT, FTP_ITC.1/INTER_XFER_IT, and FTP_TRP.1/TRUSTPATH_ENROLL).</test>
                  <test>(conditional) The evaluator shall configure the periodicity for the assigned list of commands to the agent for several configured time periods and shall verify that the MDM server performs the commands schedule.</test>
                  <test>(conditional) The evaluator shall design and perform tests to demonstrate that the assigned function may be configured and that the intended behavior of the function is enacted by the MDM server.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Success or failure of function</audit-event-descr>
          </audit-event>
        </f-component>
        <!-- FMT_SMR.1/SECMAN_ROLES Security Roles -->
        <f-component cc-id="fmt_smr.1" id="fmt-smr-1-secman-roles" name="Security Roles" iteration="SECMAN_ROLES">
          <f-element id="fmt-smr-1e1-sr">
            <title>The TSF shall maintain the roles <h:b>administrator, MD user, and</h:b><selectables><selectable id="fmt_smr.1.1_SECMAN_ROLES_1"><h:b><assignable>additional authorized identified roles</assignable> </h:b></selectable><selectable id="fmt_smr.1.1_SECMAN_ROLES_3"><h:b>no additional roles</h:b></selectable></selectables>.</title>
          </f-element>
          <f-element id="fel-smr-users-roles">
            <title>The TSF shall be able to associate users with roles.</title>
            <note role="application">
              It is envisioned that the MDM server will be configured and maintained by different user roles. The assignment is used by the ST author to list the roles that are supported. At a minimum, one administrative role must be supported. If no additional roles are supported, then "no additional roles" is selected. The MD user role is used for enrollment of MDs to the MDM according to FIA_ENR_EXT.1.
              <h:br/>
              <h:br/>
              For distributed TOEs, not every TOE component is required to implement its own user management to fulfill this SFR. At least one component has to support authentication and identification of users according to FIA_UAU.1. For the other TOE components authentication can be realized through the use of a trusted channel (either according to FTP_ITC.1 or FPT_ITT.1/INTER_XFER / FPT_ITT.1/INTER_XFER_AGENT) from a component that supports the authentication of users according to FIA_UAU.1. The identification of users according to
              <xref to="fel-uau-func"/>
              and the association of users with roles according to
              <xref to="fel-smr-users-roles"/>
              is done through the components that support the authentication of users according to FIA_UAU.1.
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to verify that it describes the administrator role and the powers granted to and limitations of the role.</TSS>
              <Guidance>The evaluator shall review the operational guidance to ensure that it contains instructions for administering the TOE and which 
				interfaces are supported.</Guidance>
              <Tests>In the course of performing the testing activities for the evaluation, the evaluator shall use all supported interfaces, although it is not necessary to repeat each test involving an administrative action with each interface. The evaluator shall ensure, however, that each supported method of administering the TOE that conforms to the requirements of this PP be tested; for instance, if the TOE can be administered through a local hardware interface or HTTPS then both methods of administration must be exercised during the evaluation team's test activities.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FMT_SMR.1/SECMAN_ROLES_MAS Security Roles (MAS Server) -->
        <f-component cc-id="fmt_smr.1" id="fmt-smr-1-secman-roles-mas" name="Security Roles (MAS Server)" iteration="SECMAN_ROLES_MAS" status="sel-based">
          <f-element id="fmt-smr-1e1-srm">
            <title>The TSF shall <h:b>additionally</h:b> maintain the roles of [<h:i>enrolled managed devices, application access groups, and <assignable>additional authorized identified roles</assignable></h:i>].</title>
          </f-element>
          <f-element id="fmt-smr-1e2-srm">
            <title>The <h:b>MAS Server</h:b> shall be able to associate users with roles.</title>
            <note role="application">
              It is envisioned that the MAS Server will be configured and maintained by different user roles. The assignment is used by the ST author to list the roles that are supported. At a minimum, one administrative role must be supported. If no additional roles are supported, then "no additional roles" is stated. The MD user role is used for enrollment of MDs to the MAS according to FIA_ENR_EXT.1.
              <h:br/>
              <h:br/>
              This requirement is claimed if "enable, disable, and modify policies listed in FMT_SMF.1/MAS" is selected in FMT_MOF.1.1/FUNCBE.
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to verify that it describes the administrator role and the powers granted to and limitations of the role.</TSS>
              <Guidance>The evaluator shall review the operational guidance to ensure that it contains instructions for administering the TOE and which interfaces are supported.</Guidance>
              <Tests>In the course of performing the testing activities for the evaluation, the evaluator shall use all supported interfaces, although it is not necessary to repeat each test involving an administrative action with each interface. The evaluator shall ensure, however, that each supported method of administering the TOE that conforms to the requirements of this PP be tested; for instance, if the TOE can be administered through a local hardware interface or HTTPS then both methods of administration must be exercised during the evaluation team's test activities.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
      </section>
      <!-- 5.1.6 Protection of the TSF (FPT) -->
      <section id="fpt" title="Protection of the TSF (FPT)">
        <ext-comp-def title="Use of Supported Services and APIs" fam-id="FPT_API_EXT">
          <fam-behavior>This family describes document platform APIs when selecting "invoke platform-provided functionality."</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Use of Third-Party Libraries" fam-id="FPT_LIB_EXT">
          <fam-behavior>This family describes packaging third-party libraries when selecting "implement functionality."</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Functionality Testing" fam-id="FPT_TST_EXT">
          <fam-behavior>This family defines requirements for running self-tests and verifying integrity or executable code.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Trusted Update" fam-id="FPT_TUD_EXT">
          <fam-behavior>This family defines requirements for allowing authorized administrators to query software versions, initiate updates, and verify software updates prior to installation.</fam-behavior>
        </ext-comp-def>
        <!-- FPT_API_EXT.1 Use of Supported Services and APIs -->
        <f-component cc-id="fpt_api_ext.1" id="fpt-api-ext-1" name="Use of Supported Services and APIs">
          <comp-lev>defines requirements for API usage.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fpt-api-ext-1e1">
            <title>The TSF shall use only documented platform APIs.</title>
            <note role="application">This requirement applies to the APIs used when "invoke platform-provided
              functionality" is selected in an SFR. The definition of documented may vary depending on whether the MDM software is provided by a third-party 
              (who relies on documented platform APIs) or by a platform vendor who may be able to guarantee support for platform APIs.</note>
            <aactivity>
              <TSS>The evaluator shall verify that the TSS lists the platform APIs used by the MDM software. The evaluator shall then compare the list with the 
			  supported APIs (available through e.g., developer accounts, platform developer groups) and ensure that all APIs listed in the TSS are supported.</TSS>
              <Guidance/>
              <Tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_FLS.1 Failure with Preservation of Secure State -->
        <f-component cc-id="fpt_fls.1" id="fpt-fls-1" name="Failure with Preservation of Secure State" status="sel-based">
          <f-element id="fel-pres-sec-state">
            <title>
              The TSF shall preserve a secure state when the following types of failures occur: [<h:i>DRBG self-test failure</h:i>].
            </title>
            <note role="application">The intent of this requirement is to ensure that cryptographic services requiring random bit generation cannot be performed if a failure of a self-test defined in FPT_TST.1 occurs.</note>
            <aactivity>
              <TSS>The evaluator shall verify that the TSF describes how the TOE enters an error state in the event of a DRBG self-test failure.</TSS>
              <Guidance>The evaluator shall verify that the guidance documentation describes the error state that results from a DRBG self-test failure and the actions that a user or administrator should take in response to attempt to resolve the error state.</Guidance>
              <Tests/>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Failure of the TSF.</audit-event-descr>
            <audit-event-info>None.</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FPT_ITT.1/INTER_XFER Internal TOE TSF Data Transfer -->
        <f-component cc-id="fpt_itt.1" id="fpt-itt-1-inter-xfer" name="Internal TOE TSF Data Transfer" iteration="INTER_XFER" status="sel-based">
          <f-element id="fel-interxfer">
            <title>
              The TSF shall
              <selectables linebreak="yes">
                <selectable id="fpt_itt.1.1_INTER_XFER_1">
                  <h:b>invoke platform-provided functionality to use <selectables linebreak="yes"><selectable id="ITT1_IPSEC_INVOKE">IPsec</selectable><selectable id="ITT1_TLS_INVOKE">mutually authenticated TLS</selectable><selectable id="ITT1_DTLS_INVOKE">mutually authenticated DTLS</selectable><selectable id="ITT1_HTTPS_INVOKE">HTTPS</selectable><selectable id="ITT1_SSH_INVOKE">SSH</selectable></selectables></h:b>
                </selectable>
                <selectable id="fpt_itt.1.1_INTER_XFER_2">
                  <h:b>implement functionality using <selectables linebreak="yes"><selectable id="ITT1_IPSEC_IMPLEMENT">IPsec as defined in the PP-Module for VPN Client</selectable><selectable id="ITT1_TLS_IMPLEMENT">mutually authenticated TLS as defined in the Package for Transport Layer Security</selectable><selectable id="ITT1_DTLS_IMPLEMENT">mutually authenticated DTLS as defined in the Package for Transport Layer Security</selectable><selectable id="ITT1_HTTPS_IMPLEMENT">HTTPS in accordance with FCS_HTTPS_EXT.1</selectable><selectable id="ITT1_SSH_IMPLEMENT">SSH as defined in the Functional Package for Secure Shell</selectable></selectables></h:b>
                </selectable>
              </selectables>
              <h:b>to</h:b>
              protect
              <h:b>all</h:b>
              data from [<h:i>disclosure and modification</h:i>] when it is
              <h:b>transferred</h:b>
              between
              separate parts of the TOE.
            </title>
            <note role="application">
              This requirement ensures all communications between components of a distributed TOE are protected through the use of an encrypted communications channel. The data passed in this trusted communication channel are encrypted as defined in the protocol chosen in the second selection.
              <h:br/>
              <h:br/>
              The trusted channel uses secure protocols that preserve the confidentiality and integrity of MDM communications. The ST author chooses the mechanism or mechanisms supported by the TOE. To support mutual authentication, FIA_X509_EXT.1 from
              <xref to="X509"/>
              should be included in the ST and iterated as "FIA_X509_EXT.1/Internal" per the guidance in
              <xref to="package-usage"/>
              (to distinguish it from TSF validation of certificates presented by entities that are external to the TOE boundary). This channel may also be used as the registration channel for the registration process, as described in section 3.1 and
              <xref to="fel-cpc-func"/>.
              <h:br/>
              <h:br/>
              If "IPsec as defined in the PP-Module for VPN Client" is selected, the TSF must claim conformance to a PP-Configuration that includes the VPN Client PP-Module.
              <h:br/>
              <h:br/>
              If the ST author selects "SSH as defined in the Functional Package for Secure Shell," the TSF must be validated against the FP for Secure Shell with the MDM PP. It should be noted that due to constraints imposed by this PP that SHA-1 cannot be used.
              <h:br/>
              <h:br/>
              If the ST author selects "mutually authenticated TLS as defined in the Package for Transport Layer Security" or "mutually authenticated DTLS as defined in the Package for Transport Layer Security," the TSF must be validated against requirements from the Package for Transport Layer Security, with the following selections made:
              <h:ul>
                <h:li>
                  FCS_TLS_EXT.1:
                  <h:ul>
                    <h:li>either TLS or DTLS is selected depending on the selection made in </h:li>
                    <h:li>either client or server is selected as appropriate</h:li>
                  </h:ul>
                </h:li>
                <h:li>
                  FCS_TLSC_EXT.1.1 or FCS_TLSS_EXT.1.1 (as appropriate):
                  <h:ul>
                    <h:li>The cipher suites selected must correspond with the algorithms and hash functions allowed in FCS_COP.1.</h:li>
                    <h:li>mutual authentication must be selected</h:li>
                  </h:ul>
                </h:li>
              </h:ul>
              Protocol, RBG, Certificate validation, algorithm, and similar services may be met with
             platform-provided services.
              <h:br/>
              <h:br/>
              This requirement is claimed if "FPT_ITT.1/INTER_XFER" is selected in FTP_ITC_EXT.1.
              <h:br/>
              <h:br/>
              If HTTPS is chosen, FCS_HTTPS_EXT.1 must be included in the ST.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to determine that the
                methods and protocols used to protect distributed TOE components
                are described. The evaluator shall also confirm that all protocols listed in the
                TSS in support of TOE administration are
                consistent with those specified in the requirement, and are included in the
                requirements in the ST.
                <h:br/>
                <h:br/>
                If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each supported platform) how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the MDM server; nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).
              </TSS>
              <Guidance>The evaluator shall confirm that the operational guidance contains
                instructions for establishing the communication paths for each supported
                method.</Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall ensure that communications using each specified (in the operational guidance) communication method is tested during the course of the evaluation, setting up the connections as described in the operational guidance and ensuring that communication is successful.</test>
                  <test>The evaluator shall ensure, for each method of communication, the channel data is not sent in plaintext.</test>
                </testlist>
                Further evaluation activities are associated with the specific protocols.
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Initiation and termination of the trusted channel</audit-event-descr>
            <audit-event-info>Trusted channel protocol</audit-event-info>
            <audit-event-info>Identity of initiator and recipient</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FPT_ITT.1/INTER_XFER_AGENT Internal TOE TSF Data
          Transfer (MDM Agent) -->
        <f-component cc-id="fpt_itt.1" id="fpt-itt-1-inter-xfer-agent" name="Internal TOE TSF Data
          Transfer (MDM Agent)" iteration="INTER_XFER_AGENT" status="sel-based">
          <f-element id="fel-interxfer-agent">
            <title>
              The TSF shall
              <selectables>
                <selectable id="fpt_itt.1.1_INTER_XFER_AGENT_1">
                  <h:b>invoke platform-provided functionality to use <selectables linebreak="yes"><selectable id="ITT2_TLS_INVOKE">mutually authenticated TLS</selectable><selectable id="ITT2_DTLS_INVOKE">mutually authenticated DTLS</selectable><selectable id="ITT2_HTTPS_INVOKE">HTTPS</selectable></selectables></h:b>
                </selectable>
                <selectable id="fpt_itt.1.1_INTER_XFER_AGENT_2">
                  <h:b>implement functionality using <selectables linebreak="yes"><selectable id="ITT2_TLS_IMPLEMENT">mutually authenticated TLS as defined in the Package for Transport Layer Security</selectable><selectable id="ITT2_DTLS_IMPLEMENT">mutually authenticated DTLS as defined in the Package for Transport Layer Security</selectable><selectable id="ITT2_HTTPS_IMPLEMENT">HTTPS in accordance with FCS_HTTPS_EXT.1</selectable></selectables></h:b>
                </selectable>
              </selectables>
              <h:b>to</h:b>
              protect all data from [<h:i>disclosure and modification</h:i>] when it is
              <h:b>transferred</h:b>
              between
              <h:b>the TSF and MDM agent.</h:b>
            </title>
            <note role="application">
              This requirement ensures all communications between the TSF and MDM agent are protected through the use of an encrypted communications channel. The data passed in this trusted communication channel are encrypted as defined in the protocol chosen in the second selection.
              <h:br/>
              <h:br/>
              The trusted channel uses secure protocols that preserve the confidentiality and integrity of MDM communications. The ST author chooses the mechanism or mechanisms supported by the TOE. To support mutual authentication, FIA_X509_EXT.1 from
              <xref to="X509"/>
              should be included in the ST and iterated as "FIA_X509_EXT.1/External" per the guidance in
              <xref to="package-usage"/>
              (to distinguish it from TSF validation of certificates presented by entities that are other parts of a distributed TOE). This channel may also be used as the registration channel for the registration process, as described in section 3.1 and
              <xref to="fel-cpc-func"/>.
              <h:br/>
              <h:br/>
              If the ST author selects "mutually authenticated TLS as defined in the Package for Transport Layer Security" or "mutually authenticated DTLS as defined in the Package for Transport Layer Security," the TSF must be validated against requirements from the Package for Transport Layer Security, with the following selections made:
              <h:ul>
                <h:li>
                  FCS_TLS_EXT.1:
                  <h:ul>
                    <h:li>either TLS or DTLS is selected depending on the selection made in FPT_ITT.1.1(2)</h:li>
                    <h:li>either client or server is selected as appropriate</h:li>
                  </h:ul>
                </h:li>
                <h:li>
                  FCS_TLSC_EXT.1.1 or FCS_TLSS_EXT.1.1 (as appropriate):
                  <h:ul>
                    <h:li>The cipher suites selected must correspond with the algorithms and hash functions allowed in FCS_COP.1.</h:li>
                    <h:li>mutual authentication must be selected</h:li>
                  </h:ul>
                </h:li>
              </h:ul>
              Protocol, RBG, Certificate validation, algorithm, and similar services may be met with
              platform-provided services.
              <h:br/>
              <h:br/>
              If HTTPS is chosen, you must include FCS_HTTPS_EXT.1 in the ST.
              This requirement is claimed if "FPT_ITT.1/INTER_XFER_AGENT" is selected in FTP_ITC_EXT.1.
              <h:br/>
              <h:br/>
              If HTTPS is chosen, FCS_HTTPS_EXT.1 must be included in the ST.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to determine that the
              methods and protocols used to protect distributed TOE components
              are described. The evaluator shall also confirm that all protocols listed in the
              TSS in support of TOE administration are
              consistent with those specified in the requirement, and are included in the
              requirements in the ST.
                <h:br/>
                <h:br/>
                If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each supported platform) how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the MDM server; nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).
              </TSS>
              <Guidance>The evaluator shall confirm that the operational guidance contains
              instructions for establishing the communication paths for each supported
              method.</Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall ensure that communications using each specified (in the operational guidance) communication method is tested during the course of the evaluation, setting up the connections as described in the operational guidance and ensuring that communication is successful.</test>
                  <test>The evaluator shall ensure, for each method of communication, the channel data is not sent in plaintext.</test>
                </testlist>
                Further evaluation activities are associated with the specific protocols.
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Initiation and termination of the trusted channel</audit-event-descr>
            <audit-event-info>Trusted channel protocol</audit-event-info>
            <audit-event-info>Identity of initiator and recipient</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FPT_LIB_EXT.1 Use of Third-Party Libraries -->
        <f-component cc-id="fpt_lib_ext.1" id="fpt-lib-ext-1" name="Use of Third-Party Libraries">
          <comp-lev>defines requirements for third-party libraries.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fpt-lib-ext-1e1">
            <title>
              The MDM software shall be packaged with only
              <assignable>list of third-party libraries</assignable>.
            </title>
            <note role="application">The intention of this requirement is for the ST author to document which software
              libraries (including version numbers) the MDM software is including in case 
              vulnerabilities are later discovered with those libraries. For cloud services, the
              assignment can be completed with a reference to a non-public library document as an
              annex for those libraries that are not or cannot be made public.</note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS lists the libraries used by the MDM
                software or the public libraries used by the cloud MDM services. The evaluator
                shall verify that libraries found to be packaged with or employed by the MDM 
                software are limited to those in the assignment.
                <h:br/>
                <h:br/>
                <h:b>Library Document</h:b>
                <h:br/>
                <h:br/>
                (conditional: The TOE is a cloud MDM service) The evaluator shall verify that the
                non-public library document lists the libraries used by the MDM service.
              </TSS>
              <Guidance/>
              <Tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FPT_TDC.1/Policy Inter-TSF Basic TSF Data Consistency (Policy Data) -->
        <f-component cc-id="fpt_tdc.1" id="fpt-tdc-1-policy" name="Inter-TSF Basic TSF Data Consistency (Policy Data)" iteration="Policy" status="sel-based">
          <f-element id="fpt-tdc-interpret">
            <title>
              The TSF shall provide the capability to consistently interpret
              <assignable>MDM policy</assignable>
              when shared between the primary MDM server and the MDM agent.
            </title>
          </f-element>
          <f-element id="fpt-tdc-rules">
            <title>
              The TSF shall use
              <assignable>list of interpretation rules to be applied by the TSF</assignable>
              when interpreting MDM policy from the primary MDM server.
            </title>
            <note role="application">The intent of this requirement is to verify that there are well-defined rules that the subordinate MDM server follows if it modifies/interprets the MDM policy sent from the primary MDM server that is then delivered to the MDM agent on the managed device. For example: a mapping between the command received from the primary MDM server and the matching command delivered to the MDM agent. If the subordinate MDM does not modify the policy for delivery to the MDM agent, then this requirement is implicitly satisfied.</note>
            <aactivity>
              <TSS>The evaluator ensures that the TSS describes how the policies are translated between the policy that is accepted by the subordinate MDM server and the policy that is generated for delivery to the MDM agent on the managed device. This should include a description or mapping for each MDM agent configuration and policy function claimed in FMT_SMF.1/SERVER_CONF_AGENT.</TSS>
              <Guidance/>
              <Tests>The evaluator shall perform a policy update from an available configuration interface (such as through a test primary MDM Server) and retain a copy of the resulting policy. The evaluator then obtains a version of the policy modified by the subordinate MDM for delivery to the MDM agent. The evaluator shall compare the original policy to the modified policy and ensure that the translation rules are valid for each configuration and policy function claimed.</Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-info>None.</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FPT_TST.1 TSF Self-Testing -->
        <f-component cc-id="fpt_tst.1" id="fpt-tst-1" name="TSF Self-Testing" status="sel-based">
          <f-element id="fel-tsf-self-test">
            <title>
              The TSF shall run a suite of the following self-tests
              <selectables>
                <selectable id="fpt_tst.1.1_1">during initial start-up</selectable>
                <selectable id="fpt_tst.1.1_2">periodically during normal operation</selectable>
                <selectable id="fpt_tst.1.1_3">at the request of the authorized user</selectable>
                <selectable id="fpt_tst.1.1_4">at the conditions <assignable>conditions under which self-test should occur</assignable></selectable>
              </selectables>
              to demonstrate the correct operation of [<h:i>TSF DRBG specified in FCS_RBG.1</h:i>].
            </title>
          </f-element>
          <f-element id="fel-tsf-ver-int-data">
            <title>
              The TSF shall provide authorized users with the capability to verify the integrity of [<h:i>[DRBG seed and output data]</h:i>].
            </title>
          </f-element>
          <f-element id="fel-tsf-ver-int">
            <title>
              The TSF shall provide authorized users with the capability to verify the integrity of [<h:i>[TSF DRBG specified in FCS_RBG.1]</h:i>].
            </title>
            <note role="application">This SFR is a required dependency of FCS_RBG.1. It is intended to require that any DRBG implemented by the TOE undergo health testing to ensure that the random bit generation functionality has not been degraded. If the TSF supports multiple DRBGs, this SFR should be iterated to describe the self-test behavior for each.</note>
            <aactivity>
              <TSS>
                <h:p>The	evaluator shall examine the TSS to ensure that it details the self-tests that are run by the TSF along with how they are run. This description should include an outline of what the tests are actually doing. The evaluator shall ensure that the TSS makes an argument that the tests are sufficient to demonstrate that the DRBG is operating correctly.</h:p>
                <h:p>
                  Note that this information may also be placed in the entropy documentation specified by
                  <xref to="entropyappendix"/>.
                </h:p>
              </TSS>
              <Guidance>
                <h:p>If a self-test can be executed at the request of an authorized user, the evaluator shall verify that the operational guidance provides instructions on how to execute that self-test.</h:p>
              </Guidance>
              <Tests>
                <h:p>For each self-test, the evaluator shall verify that evidence is produced that the self-test is executed when specified by FPT_TST.1.1.</h:p>
                <h:p>If a self-test can be executed at the request of an authorized user, the evaluator shall verify that following the steps documented in the operational guidance to perform the self-test will result in execution of the self-test.</h:p>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Execution of self-tests.</audit-event-descr>
            <audit-event-info>None.</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FPT_TST_EXT.1 Functionality Testing -->
        <f-component cc-id="fpt_tst_ext.1" id="fpt-tst-ext-1" name="Functionality Testing">
          <comp-lev>defines requirements for the integrity of self-testing.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>
            The following actions should be auditable if FAU_GEN security audit data generation
          is included in the PP or ST.
            <h:ul>
              <h:li>Initiation of self-test.</h:li>
              <h:li>Failure of self-test.</h:li>
              <h:li>Detected integrity violation</h:li>
            </h:ul>
          </audit>
          <dependencies><no-link>FPT_TST.1</no-link> TSF Self-Testing</dependencies>
          <f-element id="fpt-tst-ext-1e1">
            <title>The TSF shall run a suite of self tests during initial start-up (power on) to demonstrate correct operation of the TSF.</title>
          </f-element>
          <f-element id="fel-tst-ext-impl">
            <title>
              The TSF shall
              <selectables>
                <selectable id="fpt_tst_ext.1.2_1">invoke platform-provided functionality</selectable>
                <selectable id="fpt_tst_ext.1.2_2">implement functionality</selectable>
              </selectables>
              to provide the capability to verify the integrity of stored TSF executable code when it is loaded for execution through the use of the
              <selectables>
                <selectable id="fpt_tst_ext.1.2_3">TSF</selectable>
                <selectable id="fpt_tst_ext.1.2_4">TOE platform</selectable>
              </selectables>
              -provided cryptographic services.
            </title>
            <note role="application">
              While the TOE is typically a software package running in the IT Environment, it is still capable of performing the
		    self-test activities required above. It should be understood, however, that there is a significant dependency on the host environment 
		    in assessing the assurance provided by the tests mentioned above (meaning that if the host environment is compromised, the self-tests will 
		    not be meaningful).
              <h:br/>
              <h:br/>
              For distributed TOEs, all TOE components (except the Agent components) have to perform self-tests. This does not necessarily mean that each 
		    TOE component has to carry out the same self-tests: the ST describes the applicability of the selection (i.e., when self-tests are run) and
		    the final assignment (i.e., which self-tests are carried out) to each TOE component.
            </note>
            <aactivity>
              <TSS>
                If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each 
		      supported platform) how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented
		      by the MDM server; nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).
                <h:br/>
                <h:br/>
                If "implement functionality" is selected, the evaluator shall examine the TSS to ensure that it details the self-tests that are run by the TSF on
		      start-up; this description should include an outline of what the tests are actually doing (e.g., rather than saying "memory is tested," a 
		      description similar to "memory is tested by writing a value to each memory location and reading it back to ensure it is identical to what
		      was written" shall be used). The evaluator shall ensure that the TSS makes an argument that the tests are sufficient to demonstrate that
		      the TSF is operating correctly.
                <h:br/>
                <h:br/>
                The evaluator shall examine the TSS to ensure that it describes how to verify the integrity of stored TSF executable code when it is loaded for
		      execution. The evaluator shall ensure that the TSS makes an argument that the tests are sufficient to demonstrate that the integrity of 
		      stored TSF executable code has not been compromised. The evaluator also ensures that the TSS (or the operational guidance) describes the
		      actions that take place for successful (e.g., hash verified) and unsuccessful e.g., hash not verified) cases.
              </TSS>
              <Guidance>The evaluator shall verify that the operational guidance includes a description of how the administrator can verify that a self-test has failed and any potential corrective actions that can be used to resolve the failure state.</Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                  <test>The evaluator performs the integrity check on a known good TSF executable and verifies that the check is successful.</test>
                  <test>The evaluator modifies the TSF executable, performs the integrity check on the modified TSF executable and verifies that the check fails.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Initiation of self-test</audit-event-descr>
          </audit-event>
          <audit-event>
            <audit-event-descr>Failure of self-test</audit-event-descr>
            <audit-event-info>Algorithm that caused failure</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>Detected integrity violation</audit-event-descr>
            <audit-event-info>The TSF code file that caused the integrity violation</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FPT_TUD_EXT.1 Trusted Update -->
        <f-component cc-id="fpt_tud_ext.1" id="fpt-tud-ext-1" name="Trusted Update">
          <comp-lev>defines requirements for authorized administrators to manage software versions
            and updates.</comp-lev>
          <management>
            The following actions could be considered for the management functions in FMT.
            <h:ul>
              <h:li>Query the current version of the MD firmware or software.</h:li>
              <h:li>Update system software (MDF Function 15).</h:li>
            </h:ul>
          </management>
          <audit>
            The following action should be auditable if FAU_GEN security audit data generation
            is included in the PP or ST.
            <h:ul>
              <h:li>Success or failure of signature verification</h:li>
            </h:ul>
          </audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fpt-tud-ext-1e1">
            <title>The TSF shall provide authorized administrators the ability to query the current version of the software.</title>
            <note role="application">For a distributed TOE, the method of determining the installed versions on each component of the TOE is described in the operational guidance.
		    In the requirement, "software" refers to the component of the distributed TOE to which the requirement is being applied.</note>
            <aactivity level="element">
              <TSS>The evaluator shall verify that the TSS identifies the mechanism by which the current version of the TOE can be identified.</TSS>
              <Guidance>The evaluator shall ensure that the administrator guidance includes instructions for determining the current version of the TOE.</Guidance>
              <Tests>The evaluator shall query the TSF for the current version of the software according to the operational guidance and shall verify that the current version matches that of the documented and installed version.</Tests>
            </aactivity>
          </f-element>
          <f-element id="fpt-tud-ext-1e2">
            <title>The TSF shall  <selectables><selectable id="fpt_tud_ext.1.2_1">invoke platform-provided functionality</selectable><selectable id="fpt_tud_ext.1.2_2">implement functionality</selectable></selectables>  to provide authorized administrators the ability to initiate updates to the TOE.</title>
            <aactivity level="element">
              <TSS>If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each supported platform) how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the MDM server; nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).</TSS>
              <Guidance>The evaluator shall verify that the operational guidance provides instructions for how to initiate an update to the TOE and any restrictions on this function such that only an authorized administrator can perform it.</Guidance>
              <Tests/>
            </aactivity>
          </f-element>
          <f-element id="fel-tud-func">
            <title>The TSF shall  <selectables><selectable id="fpt_tud_ext.1.3_1">invoke platform-provided functionality</selectable><selectable id="fpt_tud_ext.1.3_2">implement functionality</selectable></selectables>  to provide a means to verify software updates to the TSF using a digital signature mechanism prior to installing those updates.</title>
            <note role="application">
              The software on the TSF will occasionally need to be updated. This requirement is intended to ensure that the TSF only installs updates provided by the vendor, as updates provided by another source may contain malicious code. If the server is not an appliance, the update will be verified by the platform on which the server software runs. If the server is an appliance, the update must be verified by the TSF.
              <h:br/>
              <h:br/>
              For distributed TOEs, all TOE components must support Trusted Update. The verification of the signature or hash on the update must either be done by each TOE component itself (signature verification) or for each TOE component (hash verification).
              <h:br/>
              <h:br/>
              Updating a distributed TOE might lead to the situation where different TOE components are running different software versions. Depending on the differences between the different software versions the impact of a mixture of different software versions might be no problem at all or critical to the proper functioning of the TOE. The TSS must detail the mechanisms that support the continuous proper functioning of the TOE during trusted update of distributed TOEs.
            </note>
            <aactivity level="element">
              <TSS>
                If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each supported platform) how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the MDM server; nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).
                <h:br/>
                <h:br/>
                If "implement functionality" is selected, the evaluator shall examine the TSS and verify that it describes the standards by which the updates are digitally signed and how the signature verification process is implemented.
              </TSS>
              <Guidance>The evaluator shall examine the operational guidance to verify that it identifies how the TOE will verify the integrity of an update and how the administrator is made aware of a failure to verify the integrity of the update.</Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                  <test>The evaluator shall attempt to initiate an update digitally signed by the vendor and verify that the update is successfully installed.</test>
                  <test>The evaluator shall attempt to install an update not digitally signed by the vendor and verify that either the signature can be checked (allowing the update to be aborted) or the update is not installed.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Success or failure of signature verification</audit-event-descr>
          </audit-event>
        </f-component>
      </section>
      <!-- 5.1.7 TOE Access (FTA) -->
      <section id="fta" title="TOE Access (FTA)">
        <!-- FTA_TAB.1 Default TOE Access Banners -->
        <f-component cc-id="fta_tab.1" id="fta-tab-1" name="Default TOE Access Banners" status="optional">
          <f-element id="fta-tab-1e1">
            <title>Before establishing a user session, the [<h:i>TSF</h:i>] shall  <selectables><selectable id="fta_tab.1.1_1"><h:b>invoke platform-provided functionality</h:b></selectable><selectable id="fta_tab.1.1_2"><h:b>implement functionality</h:b></selectable></selectables> <h:b>to</h:b> display an [<h:i>administrator-specified advisory notice and
              consent warning</h:i>] message <h:b>regarding use of the TOE.</h:b></title>
            <note role="application">This requirement is to ensure that an advisory notice or consent banner is presented to the user on start-up or unlock of the TSF.</note>
            <aactivity>
              <TSS>
                If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each supported platform) how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the MDM server; nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).
                <h:br/>
                <h:br/>
                If "implement functionality" is selected, the TSS shall describe when the banner is displayed.
              </TSS>
              <Guidance>The evaluator follows the operational guidance to configure a notice and consent warning message.</Guidance>
              <Tests>The evaluator shall also perform the following test: The evaluator shall start up or unlock the TSF. The evaluator shall verify that the notice and consent warning message is displayed in each instance described in the TSS.</Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Change in banner setting</audit-event-descr>
          </audit-event>
        </f-component>
      </section>
      <!-- 5.1.8 Trusted Path/Channels (FTP) -->
      <section id="ftp" title="Trusted Path/Channels (FTP)">
        <ext-comp-def title="Trusted Channel" fam-id="FTP_ITC_EXT">
          <fam-behavior>The family defines requirements for communication channels between itself and other communication channels.</fam-behavior>
        </ext-comp-def>
        <!-- FTP_ITC.1/INTER_TSF_XFER_AGENT Inter-TSF Trusted Channel (MDM agent) -->
        <f-component cc-id="ftp_itc.1" id="ftp-itc-1-inter-tsf-xfer-agent" name="Inter-TSF Trusted Channel (MDM agent)" iteration="INTER_TSF_XFER_AGENT" status="sel-based">
          <f-element id="inter-tsf-xfer-agent">
            <title>
              The TSF shall
              <selectables>
                <selectable id="ftp_itc.1.1_INTER_TSF_XFER_AGENT_1">
                  <h:b>invoke platform-provided functionality to use <selectables linebreak="yes"><selectable id="ITC2_TLS_INVOKE">mutually authenticated TLS</selectable><selectable id="ITC2_DTLS_INVOKE">mutually authenticated DTLS</selectable><selectable id="ITC2_HTTPS_INVOKE">HTTPS</selectable></selectables></h:b>
                </selectable>
                <selectable id="ftp_itc.1.1_INTER_TSF_XFER_AGENT_2">
                  <h:b>implement functionality using <selectables linebreak="yes"><selectable id="ITC2_TLS_IMPLEMENT">mutually authenticated TLS as defined in the Package for Transport Layer Security</selectable><selectable id="ITC2_DTLS_IMPLEMENT">mutually authenticated DTLS as defined in the Package for Transport Layer Security</selectable><selectable id="ITC2_HTTPS_IMPLEMENT">HTTPS in accordance with FCS_HTTPS_EXT.1</selectable></selectables></h:b>
                </selectable>
              </selectables>
              <h:b>to</h:b>
              provide a
              <h:b>trusted</h:b>
              communication channel between itself
              <h:b>(as a server) and the MDM agent</h:b>
              that is logically distinct from other communication channels, provides assured identification of its endpoints,
              <h:b>protects channel data from disclosure, and 
                detects modification of the channel data.</h:b>
            </title>
            <note role="application">
              The intent of the mandatory portion of the above requirement is to use the cryptographic protocols identified in the requirement to establish and maintain a trusted channel between the TOE and the MDM agent. If the TOE includes a separate MAS Server, this requirement also addresses the communication between the MAS Server and the MDM agent.  Only TLS, DTLS, or HTTPS are used in this trusted channel.
              <h:br/>
              <h:br/>
              This requirement is to ensure that the transmission of any audit
              logs, MD information data (software version, hardware model, and
              application versions), and configuration data collected by the MDM
              agent and sent from the MDM agent to the MDM
              Server, when commanded, or at configurable intervals, is properly protected. This
              trusted channel also protects any commands and policies sent by the MDM server to the MDM agent. Either the 
              MDM agent or the MDM server is able to initiate the
              connection.
              <h:br/>
              <h:br/>
              For TLS connections between the MDM server and agent, the MDM server is the Server side of the TLS connection, 
              therefore it is appropriate to include the selection-based FCS_TLSS SFRs in the ST, not FCS_TLSC SFRs. With respect 
              to mutual authentication, in cases where the agent is outside of the TOE, it should be verified 
              that the server can support mutual authentication, meaning that the server includes support for client-side certificates 
              for TLS mutual authentication post-enrollment. However, the client side is not evaluated since the agent is not in 
              the TOE.
              <h:br/>
              <h:br/>
              This trusted channel protects the connection between an enrolled MDM agent and the MDM server. FTP_TRP.1/TRUSTPATH_ENROLL provides a trusted channel to protect the connection between an unenrolled MDM agent and the MDM server during the enrollment operation.
              <h:br/>
              <h:br/>
              The trusted channel uses TLS, DTLS, or HTTPS as the protocol that preserves the confidentiality and integrity of MDM communications. The ST author chooses the mechanism or mechanisms supported by the TOE.
              <h:br/>
              <h:br/>
              If the ST author selects "mutually authenticated TLS as defined in the Package for Transport Layer Security" or "mutually authenticated DTLS as defined in the Package for Transport Layer Security," the TSF must be validated against requirements from the Package for Transport Layer Security, with the following selections made:
              <h:ul>
                <h:li>
                  FCS_TLS_EXT.1:
                  <h:ul>
                    <h:li>either TLS or DTLS is selected depending on the selection made in FTP_ITC.1.1/INTER_TSF_XFER_AGENT</h:li>
                    <h:li>server must be selected</h:li>
                  </h:ul>
                </h:li>
                <h:li>
                  FCS_TLSS_EXT.1.1:
                  <h:ul>
                    <h:li>The cipher suites selected must correspond with the algorithms and hash functions allowed in FCS_COP.1.</h:li>
                    <h:li>mutual authentication must be selected</h:li>
                  </h:ul>
                </h:li>
              </h:ul>
              Protocol, RBG, Certificate validation, algorithm, and similar services may be met with
              platform-provided services.
              <h:br/>
              <h:br/>
              The requirement implies that not only are communications protected when they are initially established, 
              but also on resumption after an outage. It may be the case that some part of the TOE setup 
              involves manually setting up tunnels to protect other communication, and if after an outage the TOE 
              attempts to re-establish the communication automatically with (the necessary) manual intervention, there may be a 
              window created where an attacker might be able to gain critical information or compromise a connection.
              <h:br/>
              <h:br/>
              This requirement is claimed if "FTP_ITC.1/INTER_TSF_XFER_AGENT" is selected in
              FTP_ITC_EXT.1.
              <h:br/>
              <h:br/>
              If HTTPS is chosen, FCS_HTTPS_EXT.1 must be included in the ST.
            </note>
          </f-element>
          <f-element id="ftp-itc-1e2-ixia">
            <title>The TSF shall <h:b><selectables><selectable id="ftp_itc.1.2_INTER_TSF_XFER_AGENT_1">invoke platform-provided functionality</selectable><selectable id="ftp_itc.1.2_INTER_TSF_XFER_AGENT_2">implement functionality</selectable></selectables></h:b><h:b>to</h:b> permit the [<h:i>TSF and MDM agent</h:i>] to initiate communication via the trusted channel.</title>
          </f-element>
          <f-element id="ftp-itc-1e3-ixia">
            <title>The TSF shall <h:b><selectables><selectable id="ftp_itc.1.3_INTER_TSF_XFER_AGENT_1">invoke platform-provided functionality</selectable><selectable id="ftp_itc.1.3_INTER_TSF_XFER_AGENT_2">implement functionality</selectable></selectables>  to</h:b> initiate communication via the trusted channel for [<h:i>all communication between the TSF and the 
                MDM agent</h:i>]</title>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to determine that the
                methods of agent-server communication are indicated, along with how those
                communications are protected. The evaluator shall also confirm that all protocols
                listed in the TSS in support of remote TOE
                administration are consistent with those specified in the requirement, and are
                included in the requirements in the ST.
                <h:br/>
                <h:br/>
                If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS 
                to verify that it describes (for each supported platform) 
                how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by 
                the MDM server; nonetheless, that mechanism will be identified in the TSS as part 
                of this evaluation activity).
              </TSS>
              <Guidance>The evaluator shall confirm that the operational guidance contains
                instructions for configuring the communication channel between the 
                MDM agent and the MDM server for each supported method.</Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall ensure that communications using each specified (in the operational guidance) agent-server communication method is tested during the course of the evaluation, setting up the connections as described in the operational guidance and ensuring that communication is successful.</test>
                  <test>The evaluator shall ensure, for each method of agent-server communication, the channel data is not sent in plaintext.</test>
                  <test>The evaluator shall ensure, for each communication channel with the MDM server, that a protocol analyzer identifies the traffic as the protocol under testing.</test>
                </testlist>
                Further evaluation activities are associated with the specific protocols.
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Initiation and termination of the trusted channel</audit-event-descr>
            <audit-event-info>Trusted channel protocol</audit-event-info>
            <audit-event-info>Non-TOE endpoint of connection</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FTP_ITC.1/INTER_XFER_IT Inter-TSF Trusted Channel (Authorized IT Entities) -->
        <f-component cc-id="ftp_itc.1" id="ftp-itc-1-inter-xfer-it" name="Inter-TSF Trusted Channel (Authorized IT Entities)" iteration="INTER_XFER_IT">
          <f-element id="fel-inter-xfer-it">
            <title>
              The TSF shall
              <selectables>
                <selectable id="ftp_itc.1.1_INTER_XFER_IT_1">
                  <h:b>invoke platform-provided functionality to use <selectables linebreak="yes"><selectable id="ITC1_IPSEC_INVOKE">IPsec</selectable><selectable id="ITC1_SSH_INVOKE">SSH</selectable><selectable id="ITC1_TLS_INVOKE">mutually authenticated TLS</selectable><selectable id="ITC1_DTLS_INVOKE">mutually authenticated DTLS</selectable><selectable id="ITC1_HTTPS_INVOKE">HTTPS</selectable></selectables></h:b>
                </selectable>
                <selectable id="ftp_itc.1.1_INTER_XFER_IT_2">
                  <h:b>implement functionality using <selectables linebreak="yes"><selectable id="ITC1_IPSEC_IMPLEMENT">IPsec as defined in the PP-Module for VPN Client</selectable><selectable id="ITC1_SSH_IMPLEMENT">SSH as defined in the Functional Package for Secure Shell</selectable><selectable id="ITC1_TLS_IMPLEMENT">mutually authenticated TLS as defined in the Package for Transport Layer Security</selectable><selectable id="ITC1_DTLS_IMPLEMENT">mutually authenticated DTLS as defined in the Package for Transport Layer Security</selectable><selectable id="ITC1_HTTPS_IMPLEMENT">HTTPS in accordance with FCS_HTTPS_EXT.1</selectable></selectables></h:b>
                </selectable>
              </selectables>
              <h:b>to</h:b>
              provide a
              <h:b>trusted</h:b>
              communication channel between itself and
              <h:b>authorized</h:b>
              IT
              <h:b>
                entities supporting the following capabilities: audit server,
                <selectables linebreak="yes">
                  <selectable id="ftp_itc.1.1_INTER_XFER_IT_3">authentication server</selectable>
                  <selectable id="ftp_itc.1.1_INTER_XFER_IT_4">primary MDM server</selectable>
                  <selectable id="ftp_itc.1.1_INTER_XFER_IT_5">subordinate MDM server</selectable>
                  <selectable id="ftp_itc.1.1_INTER_XFER_IT_7">
                    <assignable>other capabilities</assignable>
                  </selectable>
                </selectables></h:b>
              that is logically distinct from other communication channels and provides assured identification of its endpoints
              and protection of the channel data from modification or disclosure.
            </title>
            <note role="application">
              The intent of the mandatory portion of the above requirement is to use the cryptographic 
              protocols identified in the requirement to establish and maintain a trusted channel with authorized IT entities 
              that the TOE interacts with to perform its functions.
              <h:br/>
              <h:br/>
              Protection (by one of the listed protocols) is required at least for communications with the server that collects 
              the audit information. If it communicates with an authentication server (e.g., RADIUS), then the ST 
              author chooses "authentication server" in FTP_ITC.1.1/INTER_XFER_IT and this connection must be protected 
              by one of the listed protocols. Likewise if the TOE acts as either a primary or subordinate MDM server, then 
              "primary MDM server" or "subordinate MDM server" is selected for the device it communicates with and those 
              communications are protected by one of the listed protocols. If other authorized IT entities (e.g., NTP server) 
              are protected, the ST author makes the appropriate assignments (for those entities) and selections (for the protocols 
              that are used to protect those connections).
              <h:br/>
              <h:br/>
              To summarize, the connection to an external audit collection server is required to be protected by one of the listed 
              protocols. If an external authentication server is supported, or the TOE interacts
              with a primary or subordinate MDM server, then it is required to protect that connection with one 
              of the listed protocols. For any other external server, external communications are not required to be protected, but 
              if protection is claimed, then it must be protected with one of the identified protocols.
              <h:br/>
              <h:br/>
              For communications with any authorized IT entities outside of the TOE, the MDM server should still 
              be able to support mutual authentication. There are no requirements levied on the external entities, but the MDM server 
              should be able to support mutual authentication. This way if the non-TOE authorized 
              entity does support mutual authentication, the MDM server is in a position to make use of that.
              <h:br/>
              <h:br/>
              The trusted channel uses IPsec, TLS, DTLS, or HTTPS as the protocol that preserves the confidentiality and integrity of MDM communications. The ST 
			  author chooses the mechanism or mechanisms supported by the TOE.
              <h:br/>
              <h:br/>
              If "IPsec as defined in the PP-Module for VPN Client" is selected, the TSF must claim conformance to a PP-Configuration that includes the VPN Client 
			  PP-Module.
              <h:br/>
              <h:br/>
              If HTTPS is chosen, FCS_HTTPS_EXT.1 must be included in the ST.
              <h:br/>
              <h:br/>
              If the ST author selects "SSH as defined in the Functional Package for Secure Shell," the TSF must be validated against the FP for Secure Shell with 
			  the MDM PP. It should be noted that due to constraints imposed by this PP that SHA-1 cannot be used.
              <h:br/>
              <h:br/>
              If the ST author selects "mutually authenticated TLS as defined in the Package for Transport Layer Security" or "mutually authenticated DTLS as 
			  defined in the Package for Transport Layer Security," the TSF must be validated against requirements from the Package for Transport Layer Security,
			  with the following selections made:
              <h:ul>
                <h:li>
                  FCS_TLS_EXT.1:
                  <h:ul>
                    <h:li>either TLS or DTLS is selected depending on the selection made in FTP_ITC.1.1/INTER_XFER_IT</h:li>
                    <h:li>either client or server is selected as appropriate</h:li>
                  </h:ul>
                </h:li>
                <h:li>
                  FCS_TLSC_EXT.1.1 or FCS_TLSS_EXT.1.1 (as appropriate):
                  <h:ul>
                    <h:li>The cipher suites selected must correspond with the algorithms and hash functions allowed in FCS_COP.1.</h:li>
                    <h:li>mutual authentication must be selected</h:li>
                  </h:ul>
                </h:li>
                <h:li>
                  FCS_DTLSC_EXT.1.1 or FCS_DTLSS_EXT.1.1 (as appropriate):
                  <h:ul>
                    <h:li>The cipher suites selected must correspond with the algorithms and hash functions allowed in FCS_COP.1.</h:li>
                    <h:li>mutual authentication must be selected</h:li>
                  </h:ul>
                </h:li>
              </h:ul>
              Protocol, RBG, Certificate validation, algorithm, and similar services may be met with
              platform-provided 
              services.
              <h:br/>
              <h:br/>
              The requirement implies that not only are communications protected when they are initially established, but 
              also on resumption after an outage. It may be the case that some part of the TOE setup involves 
              manually setting up tunnels to protect other communication, and if after an outage the TOE attempts 
              to re-establish the communication automatically with (the necessary) manual intervention, there may be a window created 
              where an attacker might be able to gain critical information or compromise a connection.
              <h:br/>
              <h:br/>
            </note>
          </f-element>
          <f-element id="ftp-itc-1e2-ixi">
            <title>The TSF shall  <selectables><selectable id="ftp_itc.1.2_INTER_XFER_IT_1"><h:b>invoke platform-provided functionality</h:b></selectable><selectable id="ftp_itc.1.2_INTER_XFER_IT_2"><h:b>implement functionality</h:b></selectable></selectables> <h:b>to</h:b> permit <h:b>the MDM server or other authorized IT entities</h:b> to initiate communication via the trusted channel.</title>
          </f-element>
          <f-element id="fel-itc-init">
            <title>
              The TSF shall
              <selectables>
                <selectable id="ftp_itc.1.3_INTER_XFER_IT_1">
                  <h:b>invoke platform-provided functionality</h:b>
                </selectable>
                <selectable id="ftp_itc.1.3_INTER_XFER_IT_2">
                  <h:b>implement functionality</h:b>
                </selectable>
              </selectables>
              <h:b>to</h:b>
              initiate communication via the trusted channel for
              <assignable>list of functions for which a trusted channel is required</assignable>.
            </title>
            <note role="application">
              While there are no requirements on the party initiating the
              communication, the ST author lists in the assignment for
              <xref to="fel-itc-init"/>
              the services for which the TOE can initiate the communication with
              the authorized IT entity.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to determine that the
                methods of communication with authorized IT entities are indicated, along with how
                those communications are protected.
                <h:br/>
                <h:br/>
                If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS 
                to verify that it describes (for each supported platform) 
                how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by 
                the MDM server; nonetheless, that mechanism will be identified in the TSS as part 
                of this evaluation activity).
              </TSS>
              <Guidance>The evaluator shall confirm that the operational guidance contains
                instructions for configuring the communication channel between the MDM server and authorized IT entities for each supported
		            method.</Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall ensure that communications using each specified (in the operational guidance) communication method is tested during the course of the evaluation, setting up the connections as described in the operational guidance and ensuring that communication is successful.</test>
                  <test>The evaluator shall ensure, for each method of communication, the channel data is not sent in plaintext.</test>
                  <test>The evaluator shall ensure, for each communication channel with the MDM server, that a protocol analyzer identifies the traffic as the protocol under testing.</test>
                </testlist>
                Further evaluation activities are associated with the specific protocols.
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Initiation and termination of the trusted channel</audit-event-descr>
            <audit-event-info>Trusted channel protocol</audit-event-info>
            <audit-event-info>Non-TOE endpoint of connection</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FTP_ITC_EXT.1 Trusted Channel -->
        <f-component cc-id="ftp_itc_ext.1" id="ftp-itc-ext-1" name="Trusted Channel">
          <comp-lev>defines requirements for providing logically distinct communication channels.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
            <no-link>FTP_ITC.1</no-link>
            Inter-TSF Trusted Channel
            <h:br/>
            <no-link>FTP_TRP.1</no-link>
            Trusted Path
          </dependencies>
          <f-element id="fel-itc-ext">
            <title>
              The TSF shall provide a communication channel between itself and
              <selectables linebreak="yes">
                <selectable id="ITC_AgentInTOE">an MDM agent that is internal to the TOE</selectable>
                <selectable id="ITC_AgentOutTOE">an MDM agent that is external to the TOE</selectable>
                <selectable id="ftp_itc_ext.1.1_1">a subordinate MDM server</selectable>
                <selectable id="ITC_SUBORDINATE_MDM">a primary MDM server</selectable>
                <selectable id="ITC_DISTRIBUTED_TOE">other components comprising the distributed TOE</selectable>
              </selectables>
              that is logically distinct from other communication channels, as specified in
              <selectables>
                <selectable id="ITC_DISTRIBUTED_TOE_ITT1">FPT_ITT.1/INTER_XFER</selectable>
                <selectable id="ITC_AgentInTOE_ITT2">FPT_ITT.1/INTER_XFER_AGENT</selectable>
                <selectable id="ITC_AgentOutTOE_ITC">FTP_ITC.1/INTER_TSF_XFER_AGENT</selectable>
                <selectable id="ITC_INTER_XFER_IT">FTP_ITC.1/INTER_XFER_IT</selectable>
              </selectables>.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall provide a communication channel between itself and
                <comment>have to update this for subordinate MDM</comment>
                <selectables linebreak="yes">
                  <selectable id="ITC_AgentInTOE">an MDM agent that is internal to the TOE</selectable>
                  <selectable id="ITC_AgentOutTOE">an MDM agent that is external to the TOE</selectable>
                  <selectable id="ITC_DISTRIBUTED_TOE">other components comprising the distributed TOE</selectable>
                </selectables>
                that is logically distinct from other communication channels, as specified in
                <assignable>inter-TSF trusted channel or internal TOE TSF data transfer type</assignable>
              </title>
            </ext-comp-def-title>
            <note role="application">
              This SFR describes the communication channels between the MDM server and an agent that may or may not be in the TOE, and optionally separate
              components comprising a distributed TOE, to determine which selection-based SFRs will need to be included in the ST.
              <h:br/>
              <h:br/>
              If the TOE includes an MDM agent, then the communication channel between the agent and TSF is internal to the TOE and thus "an MDM agent that is
              internal to the TOE" must be selected in the first selection. Additionally FPT_ITT.1/INTER_XFER_AGENT must be selected in the second selection and
              FPT_ITT.1/INTER_XFER_AGENT must be included in the ST.
              <h:br/>
              <h:br/>
              If the TOE interoperates with an evaluated MDM agent built into a mobile device (i.e., the TOE does not include an MDM agent), the communication channel 
              between the agent and TSF is external to the TOE and thus "an MDM agent that is external to the TOE" must be selected in the first selection.
              Additionally FTP_ITC.1/INTER_TSF_XFER_AGENT must be selected in the second selection and FTP_ITC.1/INTER_TSF_XFER_AGENT must be included in the ST.
              <h:br/>
              <h:br/>
              If the TOE acts as a primary MDM server and interoperates with a subordinate MDM server to forward policies to a MDM agent on a managed device, then
              <h:i>"a subordinate MDM server"</h:i>
              must be selected in the first selection. Additionally
              <h:i>"FTP_ITC.1/INTER_XFER_IT"</h:i>
              must be selected in
              the second selection.
              <h:br/>
              <h:br/>
              If the TOE acts as a subordinate MDM server that can accept and forward signed policy files from a primary MDM server, and forward those policies to an MDM agent on a managed device, then
              <h:i>"a primary MDM server"</h:i>
              must be selected in the first selection. Additionally
              <h:i>"FTP_ITC.1/INTER_XFER_IT"</h:i>
              must be selected in the second selection.
              <h:br/>
              <h:br/>
              If "other components comprising the distributed TOE" is selected in the first selection then FPT_ITT.1/INTER_XFER must be selected in the second
              selection. FPT_ITT.1/INTER_XFER must be included in the ST for all internal channels used to transfer TSF data between TOE components other than an 
              MDM agent.
            </note>
            <aactivity>
              <TSS>The evaluator shall ensure that the TSS contains whether the MDM server communication channel is internal or external to the TOE.</TSS>
              <Guidance>TBD</Guidance>
              <Tests>This testing can be completed in conjunction with the testing for FPT_ITT.1/INTER_XFER / FPT_ITT.1/INTER_XFER_AGENT, FTP_ITC.1/INTER_TSF_XFER_AGENT or <h:mark style="background-color:red;">FTP_ITC.1(3)</h:mark>FTP_ITC.1/INTER_XFER_IT.</Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <!-- FTP_TRP.1/TRUSTPATH_ENROLL Trusted Path (for Enrollment) -->
        <f-component cc-id="ftp_trp.1" id="ftp-trp-1-trustpath-enroll" name="Trusted Path (for Enrollment)" iteration="TRUSTPATH_ENROLL">
          <f-element id="trustpath-enroll">
            <title>
              The TSF shall
              <selectables>
                <selectable id="ftp_trp.1.1_TRUSTPATH_ENROLL_1">
                  <h:b>invoke platform-provided functionality to use <selectables linebreak="yes"><selectable id="TRP2_TLS_INVOKE">TLS</selectable><selectable id="TRP2_HTTPS_INVOKE">HTTPS</selectable></selectables></h:b>
                </selectable>
                <selectable id="ftp_trp.1.1_TRUSTPATH_ENROLL_2">
                  <h:b>implement functionality using <selectables linebreak="yes"><selectable id="TRP2_TLS_IMPLEMENT">TLS as defined in the Package for Transport Layer Security</selectable><selectable id="TRP2_HTTPS_IMPLEMENT">HTTPS in accordance with FCS_HTTPS_EXT.1</selectable></selectables></h:b>
                </selectable>
              </selectables>
              <h:b>to</h:b>
              provide a
              <h:b>trusted</h:b>
              communication channel between
              itself and
              <h:b>another trusted IT product</h:b>
              that is logically distinct from other
              communication
              <h:b>channels</h:b>
              and provides assured identification of its endpoints and
              protection of the
              <h:b>channel</h:b>
              data from [<h:i>modification or disclosure</h:i>].
            </title>
          </f-element>
          <f-element id="ftp-trp-1e2-te">
            <title>The TSF shall  <selectables><selectable id="ftp_trp.1.2_TRUSTPATH_ENROLL_1"><h:b>invoke platform-provided functionality</h:b></selectable><selectable id="ftp_trp.1.2_TRUSTPATH_ENROLL_2"><h:b>implement functionality</h:b></selectable></selectables> <h:b>to</h:b> permit   <selectables><selectable id="ftp_trp.1.2_TRUSTPATH_ENROLL_3">the TSF</selectable><selectable id="ftp_trp.1.2_TRUSTPATH_ENROLL_4"><h:b>another trusted IT product</h:b></selectable></selectables>  to initiate communication via the trusted path.</title>
          </f-element>
          <f-element id="ftp-trp-1e3-te">
            <title>
              The TSF shall
              <selectables>
                <selectable id="ftp_trp.1.3_TRUSTPATH_ENROLL_1">
                  <h:b>invoke platform-provided functionality</h:b>
                </selectable>
                <selectable id="ftp_trp.1.3_TRUSTPATH_ENROLL_2">
                  <h:b>implement functionality</h:b>
                </selectable>
              </selectables>
              <h:b> to initiate communication via the trusted channel</h:b>
              for
              <h:b>
                <assignable>list of functions for which a trusted channel is required</assignable>
              </h:b>.
            </title>
            <note role="application">
              This requirement ensures that authorized MD users initiate all communication with 
              the TOE via a trusted path, and that all communications with the TOE by 
              MD users is performed over this path. The purpose of this connection is for enrollment by the MD user. The 
              data passed in this trusted communication channel are encrypted as defined in the protocol chosen in the first 
              selection. The ST author chooses the mechanism or mechanisms supported by the 
              TOE.
              <h:br/>
              <h:br/>
              If the ST author selects "TLS as defined in the Package for Transport Layer Security" the TSF must be validated against requirements from the Package for Transport Layer Security, with the following selections made:
              <h:ul>
                <h:li>
                  FCS_TLS_EXT.1:
                  <h:ul>
                    <h:li>TLS must be selected</h:li>
                    <h:li>server must be selected</h:li>
                  </h:ul>
                </h:li>
                <h:li>
                  FCS_TLSS_EXT.1.1:
                  <h:ul>
                    <h:li>The cipher suites selected must correspond with the algorithms and hash functions allowed in FCS_COP.1.</h:li>
                  </h:ul>
                </h:li>
              </h:ul>
              Protocol, RBG, Certificate validation, algorithm, and similar services may be met with
              platform-provided services.
              <h:br/>
              <h:br/>
              If HTTPS is chosen, FCS_HTTPS_EXT.1 must be included in the ST.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to determine that the methods of remote enrollment are indicated, along with how those communications are protected. The evaluator shall also confirm that all protocols listed in the TSS in support of enrollment are consistent with those specified in the requirement, and are included in the requirements in the ST.
                <h:br/>
                <h:br/>
                If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each supported platform) how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the MDM server; nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).
              </TSS>
              <Guidance>The evaluator shall confirm that the operational guidance contains instructions for establishing the enrollment sessions for each supported method.</Guidance>
              <Tests>
                For each MDM agent or platform listed as supported in the ST:
                <testlist>
                  <test>The evaluator shall ensure that communications using each specified (in the operational guidance) enrollment method is tested during the course of the evaluation, setting up the connections as described in the operational guidance and ensuring that communication is successful.</test>
                  <test>For each method of enrollment supported, the evaluator shall follow the operational guidance to ensure that there is no available interface that can be used by a remote user to establish enrollment sessions without invoking the trusted path.</test>
                  <test>The evaluator shall ensure, for each method enrollment, the channel data is not sent in plaintext.</test>
                </testlist>
                Further evaluation activities are associated with the specific protocols.
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Initiation and termination of the trusted channel</audit-event-descr>
            <audit-event-info>Trusted channel protocol</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FTP_TRP.1/TRUSTPATH_JOIN Trusted Path (for Joining) -->
        <f-component cc-id="ftp_trp.1" id="ftp-trp-1-trustpath-join" name="Trusted Path (for Joining)" iteration="TRUSTPATH_JOIN" status="objective">
          <f-element id="ftp-trp-1e1-tj">
            <title>
              The TSF shall
              <selectables>
                <selectable id="ftp_trp.1.1_TRUSTPATH_JOIN_1">
                  <h:b>invoke platform-provided functionality</h:b>
                </selectable>
                <selectable id="ftp_trp.1.1_TRUSTPATH_JOIN_2">
                  <h:b>implement functionality</h:b>
                </selectable>
              </selectables>
              <h:b>to</h:b>
              provide a communication path between itself and
              <h:b>a joining
              component</h:b>
              that is logically distinct from other communication paths and provides assured identification of
              <selectables>
                <selectable id="ftp_trp.1.1_TRUSTPATH_JOIN_3">
                  <h:b>the TSF endpoint</h:b>
                </selectable>
                <selectable id="ftp_trp.1.1_TRUSTPATH_JOIN_4">
                  <h:b>both joining component and TSF endpoint</h:b>
                </selectable>
              </selectables>
              and protection of the communicated data from
              [<h:i>modification</h:i>]
              <h:b>and</h:b>
              <selectables>
                <selectable id="ftp_trp.1.1_TRUSTPATH_JOIN_5">disclosure</selectable>
                <selectable id="ftp_trp.1.1_TRUSTPATH_JOIN_6">
                  <h:b>none</h:b>
                </selectable>
              </selectables>.
            </title>
          </f-element>
          <f-element id="ftp-trp-1e2-tj">
            <title>The TSF shall  <selectables><selectable id="ftp_trp.1.2_TRUSTPATH_JOIN_1"><h:b>invoke platform-provided functionality</h:b></selectable><selectable id="ftp_trp.1.2_TRUSTPATH_JOIN_2"><h:b>implement functionality</h:b></selectable></selectables> <h:b>to</h:b> permit  <selectables><selectable id="ftp_trp.1.2_TRUSTPATH_JOIN_3">the TSF</selectable><selectable id="ftp_trp.1.2_TRUSTPATH_JOIN_4"><h:b>the joining component</h:b></selectable></selectables>  to initiate communication via the trusted path.</title>
          </f-element>
          <f-element id="fel-trp-func-tsf">
            <title>The TSF shall  <selectables><selectable id="ftp_trp.1.3_TRUSTPATH_JOIN_1"><h:b>invoke platform-provided functionality</h:b></selectable><selectable id="ftp_trp.1.3_TRUSTPATH_JOIN_2"><h:b>implement functionality</h:b></selectable></selectables> <h:b>to</h:b> require the use of the trusted path for [<h:i>joining components to the TSF under environmental constraints identified in <assignable>reference to operational guidance</assignable>]</h:i>.</title>
            <note role="application">
              This SFR implements one of the types of channel identified in the main selection for
              <xref to="fel-cpc-func"/>. The "joining component" in FTP_TRP.1/TRUSTPATH_JOIN is the IT entity that is attempting to join the distributed TOE by using the registration process.
              <h:br/>
              <h:br/>
              The effect of this SFR is to require the ability for components to communicate in a secure manner while the distributed TSF is being created (or when adding components to an existing distributed TSF). When creating the TSF from the initial pair of components, either of these components may be identified as the TSF for the purposes of satisfying the meaning of "TSF" in this SFR.
              <h:br/>
              <h:br/>
              The selection at the end of FTP_TRP.1/TRUSTPATH_JOIN recognizes that in some cases confidentiality (i.e., protection of the data from disclosure) may not be provided by the channel. The ST author distinguishes in the TSS whether in this case the TOE relies on the environment to provide confidentiality (as part of the constraints referenced in
              <xref to="fel-trp-func-tsf"/>) or whether the registration data exchanged does not require confidentiality (in which case this assertion must be justified). If "none" is selected, then this word may be omitted in the ST to improve readability.
              <h:br/>
              <h:br/>
              The assignment in
              <xref to="fel-trp-func-tsf"/>
              ensures that the ST highlights any specific details needed to protect the registration environment. Note that when the ST uses FTP_TRP.1/TRUSTPATH_JOIN for the registration channel then this channel cannot be reused as the normal inter-component communication channel (the latter channel must meet FTP_ITC.1 or FPT_ITT.1/INTER_XFER / FPT_ITT.1/INTER_XFER_AGENT). Specific requirements for Preparative Procedures relating to FTP_TRP.1/TRUSTPATH_JOIN are defined in the Evaluation Activities.
              <h:br/>
              <h:br/>
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to determine that the methods of joining TOE components are indicated, along with how those communications are protected. The evaluator shall also confirm that all protocols listed in the TSS in support of joining are consistent with those specified in the requirement, and are included in the requirements in the ST.
                <h:br/>
                <h:br/>
                If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each supported platform) how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the MDM server; nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).
              </TSS>
              <Guidance>The evaluator shall confirm that the operational guidance contains instructions for joining TOE components for each supported method.</Guidance>
              <Tests>
                The evaluator shall also perform the following tests:
                <testlist>
                  <test>The evaluator shall ensure that the communications path for joining components to the TSF is tested for each distinct (nonequivalent) component type, setting up the connections as described in the guidance documentation and ensuring that communication is successful. In particular the evaluator shall confirm that requirements on environment protection for the registration process are consistent with observations made on the test configuration (for example, a requirement to isolate the components from the Internet during registration might be inconsistent with the need for a component to contact a license server). If no requirements on the registration environment are identified as necessary to protect confidentiality, then the evaluator shall confirm that the key used for registration can be configured (following the instructions in the guidance documentation) to be at least the same length as the key used for the internal TSF channel that is being enabled. The evaluator shall confirm that the key used for the channel is unique to the pair of components (this is done by identifying the relevant key during the registration test: it is not necessary to examine the key value).</test>
                  <test>The evaluator shall follow the guidance documentation to ensure that in fact the communication channel can be enabled by an administrator for all the TOE components identified in the guidance documentation as capable of initiation.</test>
                  <test>The evaluator shall ensure that if the guidance documentation states that the channel data is encrypted then the data observed on the channel is not plaintext.</test>
                  <test>The evaluator shall ensure that, for each different pair of nonequivalent component types that can use the registration channel, the connection is physically interrupted during a joining attempt. The evaluator shall ensure that when physical connectivity is restored, communications are appropriately protected.</test>
                </testlist>
                Further evaluation activities are associated with the specific protocols.
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Initiation and termination of the trusted channel</audit-event-descr>
            <audit-event-info>Trusted channel protocol</audit-event-info>
          </audit-event>
        </f-component>
        <!-- FTP_TRP.1/TRUSTPATH_REM_ADMIN Trusted Path (for Remote Administration) -->
        <f-component cc-id="ftp_trp.1" id="ftp-trp-1-trustpath-rem-admin" name="Trusted Path (for Remote Administration)" iteration="TRUSTPATH_REM_ADMIN">
          <f-element id="trustpath-rem-admin">
            <title>
              The TSF shall
              <selectables linebreak="yes">
                <selectable id="ftp_trp.1.1_TRUSTPATH_REM_ADMIN_1">
                  <h:b>invoke platform-provided functionality to use <selectables linebreak="yes"><selectable id="TRP1_IPSEC_INVOKE">IPsec</selectable><selectable id="TRP1_TLS_INVOKE">TLS</selectable><selectable id="TRP1_HTTPS_INVOKE">HTTPS</selectable><selectable id="TRP1_SSH_INVOKE">SSH</selectable></selectables></h:b>
                </selectable>
                <selectable id="ftp_trp.1.1_TRUSTPATH_REM_ADMIN_2">
                  <h:b>implement functionality using <selectables linebreak="yes"><selectable id="TRP1_IPSEC_IMPLEMENT">IPsec as defined in the PP-Module for VPN Client</selectable><selectable id="TRP1_TLS_IMPLEMENT">TLS as defined in the Package for Transport Layer Security</selectable><selectable id="TRP1_HTTPS_IMPLEMENT">HTTPS in accordance with FCS_HTTPS_EXT.1</selectable><selectable id="TRP1_SSH_IMPLEMENT">SSH as defined in the Functional Package for Secure Shell</selectable></selectables></h:b>
                </selectable>
              </selectables>
              <h:b>to</h:b>
              provide a 
              communication path between itself
              <h:b>as a  <selectables><selectable id="ftp_trp.1.1_TRUSTPATH_REM_ADMIN_3">server</selectable><selectable id="ftp_trp.1.1_TRUSTPATH_REM_ADMIN_4">peer</selectable></selectables></h:b>
              and [<h:i>remote</h:i>]
              <h:b>administrators</h:b>
              that is logically distinct from other communication paths and provides assured
              identification of its endpoints and protection of the communicated data from [<h:i>modification, disclosure</h:i>].
            </title>
          </f-element>
          <f-element id="ftp-trp-1e2-tra">
            <title>The TSF shall  <selectables><selectable id="ftp_trp.1.2_TRUSTPATH_REM_ADMIN_1"><h:b>invoke platform-provided functionality</h:b></selectable><selectable id="ftp_trp.1.2_TRUSTPATH_REM_ADMIN_2"><h:b>implement functionality</h:b></selectable></selectables> <h:b>to</h:b> permit [<h:i>remote <h:b>administrators</h:b></h:i>] to initiate communication via the trusted path.</title>
          </f-element>
          <f-element id="ftp-trp-1e3-tra">
            <title>The TSF shall require the use of the trusted path for [<h:i>initial <h:b>administrator</h:b> authentication, [remote administration]</h:i>].</title>
            <note role="application">
              This requirement ensures that authorized remote administrators initiate all 
              communication with the TOE via a trusted path, and that all communications with 
              the TOE by remote administrators is performed over this path. The data passed in this trusted 
              communication channel are encrypted as defined in the protocol chosen in the first selection. The ST 
              author chooses the mechanism or mechanisms supported by the TOE.
              <h:br/>
              <h:br/>
              If "IPsec as defined in the PP-Module for VPN Client" is selected, the TSF must claim conformance to a PP-Configuration that includes the VPN Client PP-Module.
              <h:br/>
              <h:br/>
              If the ST author selects "SSH as defined in the Functional Package for Secure Shell," the TSF must be validated against the FP for Secure Shell with the MDM PP. It should be noted that due to constraints imposed by this PP that SHA-1 cannot be used.
              <h:br/>
              <h:br/>
              If the ST author selects "TLS as defined in the Package for Transport Layer Security" the TSF must be validated against requirements from the Package for Transport Layer Security, with the following selections made:
              <h:ul>
                <h:li>
                  FCS_TLS_EXT.1:
                  <h:ul>
                    <h:li>TLS must be selected</h:li>
                    <h:li>Server must be selected</h:li>
                  </h:ul>
                </h:li>
                <h:li>
                  FCS_TLSS_EXT.1.1:
                  <h:ul>
                    <h:li>The cipher suites selected must correspond with the algorithms and hash functions allowed in FCS_COP.1.</h:li>
                  </h:ul>
                </h:li>
              </h:ul>
              Protocol, RBG, Certificate validation, algorithm, and similar services may be met with
            platform-provided services.
              <h:br/>
              <h:br/>
              If HTTPS is chosen, FCS_HTTPS_EXT.1 must be included in the ST.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to determine that the methods of remote TOE administration are indicated, along with how those communications are protected. The evaluator shall also confirm that all protocols listed in the TSS in support of TOE administration are consistent with those specified in the requirement, and are included in the requirements in the ST.
                <h:br/>
                <h:br/>
                If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each supported platform) how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the MDM server; nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).
              </TSS>
              <Guidance>The evaluator shall confirm that the operational guidance contains instructions for establishing the remote administrative sessions for each supported method.</Guidance>
              <Tests>
                The evaluator shall also perform the following tests:
                <testlist>
                  <test>The evaluator shall ensure that communications using each specified (in the operational guidance) remote administration method is tested during the course of the evaluation, setting up the connections as described in the operational guidance and ensuring that communication is successful.</test>
                  <test>For each method of remote administration supported, the evaluator shall follow the operational guidance to ensure that there is no available interface that can be used by a remote user to establish remote administrative sessions without invoking the trusted path.</test>
                  <test>The evaluator shall ensure, for each method of remote administration, the channel data is not sent in plaintext.</test>
                </testlist>
                Further evaluation activities are associated with the specific protocols.
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Initiation and termination of the trusted channel</audit-event-descr>
            <audit-event-info>Trusted channel protocol</audit-event-info>
            <audit-event-info>Identity of administrator</audit-event-info>
          </audit-event>
        </f-component>
        <implements>
          <feature/>
          <feature/>
          <feature/>
        </implements>
      </section>
    </sec:SFRs>
    <!-- 5.2 Security Assurance Requirements -->
    <section title="Security Assurance Requirements" id="SARs">
      The Security Objectives for the TOE in
      <xref to="req"/>
      were constructed to address threats
      identified in
      <xref to="Threats"/>. The Security 
	Functional Requirements (SFRs) in
      <xref to="req"/>
      are a formal instantiation of the Security Objectives. The PP identifies the Security Assurance
	Requirements (SARs) to frame the extent to which the evaluator assesses the documentation applicable for the evaluation and performs independent testing.
      <h:br/>
      This section lists the set of SARs from CC part 3 that are required in evaluations against this PP. Individual Evaluation
	Activities (AAs) to be performed are specified both in
      <xref to="req"/>
      as well as in this section.
      <h:br/>
      <h:br/>
      The general model for evaluation of TOEs against STs written to conform to this PP is as follows:
      <h:br/>
      <h:br/>
      After the ST has been approved for evaluation, the ITSEF will obtain the TOE, supporting environmental IT, and the administrative and user guides for the TOE. 
	The ITSEF is expected to perform actions mandated by the Common Evaluation Methodology (CEM) for the ASE and ALC SARs. The ITSEF also performs the Evaluation 
	Activities contained within
      <xref to="req"/>, which are intended to be an interpretation of the other CEM assurance requirements as they apply to the
	specific technology instantiated in the TOE. The Evaluation Activities that are captured in
      <xref to="req"/>
      also provide clarification as to what the
	developer needs to provide to demonstrate the TOE is compliant with the PP.
      <h:br/>
      <h:br/>
      The TOE security assurance requirements are identified in
      <xref to="sar"/>.
      <h:center>
        <h:H4>
          <ctr ctr-type="Table" pre="Table " id="sar">:Security Assurance Requirements</ctr>
        </h:H4>
      </h:center>
      <h:table>
        <h:TR>
          <h:TD>
            <h:b>Assurance Class</h:b>
          </h:TD>
          <h:TD>
            <h:b>Assurance Components</h:b>
          </h:TD>
        </h:TR>
        <h:TR>
          <h:TD>Security Target (ASE)</h:TD>
          <h:TD>
            ST introduction (ASE_INT.1)
            <h:br/>
            Conformance claims (ASE_CCL.1)
            <h:br/>
            Security objectives for the operational environment (ASE_OBJ.1)
            <h:br/>
            Extended components definition (ASE_ECD.1)
            <h:br/>
            Stated security requirements (ASE_REQ.1)
            <h:br/>
            TOE summary specification (ASE_TSS.1)
          </h:TD>
        </h:TR>
        <h:TR>
          <h:TD>Development (ADV)</h:TD>
          <h:TD> Basic functional specification (ADV_FSP.1) </h:TD>
        </h:TR>
        <h:TR>
          <h:TD>Guidance documents (AGD)</h:TD>
          <h:TD>
            Operational user guidance (AGD_OPE.1)
            <h:br/>
            Preparative procedures (AGD_PRE.1)
          </h:TD>
        </h:TR>
        <h:TR>
          <h:TD>Life cycle support (ALC)</h:TD>
          <h:TD>
            Labeling of the TOE (ALC_CMC.1)
            <h:br/>
            TOE CM coverage (ALC_CMS.1)
          </h:TD>
        </h:TR>
        <h:TR>
          <h:TD>Tests (ATE)</h:TD>
          <h:TD> Independent testing - sample (ATE_IND.1) </h:TD>
        </h:TR>
        <h:TR>
          <h:TD>Vulnerability assessment (AVA)</h:TD>
          <h:TD> Vulnerability survey (AVA_VAN.1) </h:TD>
        </h:TR>
      </h:table>
      <section title="Class ASE: Security Target" id="ase">
        The ST is evaluated as per ASE activities defined in the CEM. In addition, there may be Evaluation Activities specified within
        <xref to="req"/>
        and relevant appendices that call for necessary descriptions to be included in the TSS that are specific to the TOE technology type.
        <a-component cc-id="ase_tss.1" name="TOE summary specification">
          <a-element type="C">
            <title>The TOE summary specification shall describe how the TOE meets each SFR.</title>
            <aactivity/>
          </a-element>
        </a-component>
      </section>
      <section title="Class ADV: Development" id="adv">
        The design information about the TOE is contained in the guidance documentation available to the end user as well as the TSS portion of the ST, and any additional information required by this PP that is not to be made public (e.g., Entropy Essay).
        <a-component cc-id="adv_fsp.1" name="Basic Functional Specification (ADV_FSP.1)">
          The functional specification describes the Target Security Functions Interfaces (TSFIs). It is not necessary to have 
		  a formal or complete specification of these interfaces. Additionally, because TOEs conforming to this PP will 
		  necessarily have interfaces to the Operational Environment that are not directly invokable by TOE users, there is 
		  little point specifying that such interfaces be described in and of themselves since only indirect testing of such
		  interfaces may be possible. For this PP, the activities for this family should focus on understanding the interfaces 
		  presented in the TSS in response to the functional requirements and the interfaces presented in the AGD documentation.
		  No additional "functional specification" documentation is necessary to satisfy the evaluation activities specified.
          <h:br/>
          <h:br/>
          The interfaces that need to be evaluated are characterized through the information needed to perform the evaluation activities listed, rather than as an independent, abstract list.
          <a-element type="D">
            <title>The developer shall provide a functional specification.</title>
            <aactivity/>
          </a-element>
          <a-element type="D">
            <title>The developer shall provide a tracing from the functional specification to the SFRs.</title>
            <note role="application">As indicated in the introduction to this section, the functional specification is comprised of the information contained in the AGD_OPE and AGD_PRE documentation. The developer may reference a website accessible to application developers and the evaluator. The evaluation activities in the functional requirements point to evidence that should exist in the documentation and TSS section; since these are directly associated with the SFRs, the tracing in element ADV_FSP.1.2D is implicitly already done and no additional documentation is necessary. </note>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The functional specification shall describe the purpose and method of use for each SFR-enforcing and SFR-supporting TSFI.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The functional specification shall identify all parameters associated with each SFR-enforcing and SFR-supporting TSFI.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The functional specification shall provide rationale for the implicit categorization of interfaces as SFR-non-interfering.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The tracing shall demonstrate that the SFRs trace to TSFIs in the functional specification.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements for content and presentation of evidence.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall determine that the functional specification is an accurate and complete instantiation of the SFRs.</title>
            <aactivity>There are no specific evaluation activities associated with these SARs, except ensuring the information is provided. The functional specification documentation is provided to support the evaluation activities described in Section 5 and the relevant appendices, and other activities described for AGD, ATE, and AVA SARs. The requirements on the content of the functional specification information is implicitly assessed by virtue of the other evaluation activities being performed; if the evaluator is unable to perform an activity because there is insufficient interface information, then an adequate functional specification has not been provided.</aactivity>
          </a-element>
        </a-component>
      </section>
      <section title="Class AGD: Guidance Documentation" id="agd">
        The guidance documents will be provided with the ST. Guidance must include a description of how the IT personnel verifies that the Operational Environment can fulfill its role for the security functionality. The documentation should be in an informal style and readable by the IT personnel.
        <h:br/>
        <h:br/>
        Guidance must be provided for every operational environment that the product supports as claimed in the ST. This guidance includes:
        <h:br/>
        <h:br/>
        <h:ul>
          <h:li>instructions to successfully install the TSF in that environment</h:li>
          <h:li>instructions to manage the security of the TSF as a product and as a component of the larger operational environment</h:li>
          <h:li>instructions to provide a protected administrative capability</h:li>
        </h:ul>
        Guidance pertaining to particular security functionality must also be provided; requirements on such guidance are contained in the evaluation activities specified with each requirement.
        <a-component cc-id="agd_ope.1" name="Operational User Guidance (AGD_OPE.1)">
          <a-element type="D">
            <title>The developer shall provide operational user guidance.</title>
            <note role="application">
              The operational user guidance does not have to be contained in a single document. Guidance to users, administrators and application developers can be spread among documents or web pages. Where appropriate, the guidance documentation is expressed in the eXtensible Configuration Checklist Description Format (XCCDF) to support security automation.
              <h:br/>
              <h:br/>
              Rather than repeat information here, the developer should review the evaluation activities for this component to ascertain the specifics of the guidance that the evaluator will be checking for. This will provide the necessary information for the preparation of acceptable guidance.
            </note>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The operational user guidance shall describe, for each user role, the user-accessible functions and privileges that should be controlled in a secure processing environment, including appropriate warnings.</title>
            <note role="application">User and administrator are to be considered in the definition of user role.</note>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The operational user guidance shall describe, for each user role, how to use the available interfaces provided by the TOE in a secure manner.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The operational user guidance shall describe, for each user role, the available functions and interfaces, in particular all security parameters under the control of the user, indicating secure values as appropriate.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The operational user guidance shall, for each user role, clearly present each type of security-relevant event relative to the user-accessible functions that need to be performed, including changing the security characteristics of entities under the control of the TSF.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The operational user guidance shall identify all possible modes of operation of the TOE (including operation following failure or operational error), their consequences, and implications for maintaining secure operation.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The operational user guidance shall, for each user role, describe the security measures to be followed in order to fulfill the security objectives for the operational environment as described in the ST.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The operational user guidance shall be clear and reasonable.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements for content and presentation of evidence.</title>
            <aactivity>
              Some of the contents of the operational guidance will be verified by the evaluation
                activities in Sections 4.2, 4.3, and 4.4, and evaluation of the 
				TOE according to the CEM. The following additional information is also required.
              <h:br/>
              <h:br/>
              If cryptographic functions are provided by the TOE, the operational guidance shall contain instructions for configuring the cryptographic engine
				associated with the evaluated configuration of the TOE. It shall provide a warning to the administrator that use of other cryptographic engines was 
				not evaluated nor tested during the CC evaluation of the TOE.
              <h:br/>
              <h:br/>
              The documentation must describe the process for verifying updates to the
				TOE by verifying a digital signature - this may be done by the TOE or the underlying platform. The evaluator shall verify that this process includes
				the following steps:
              <h:br/>
              <h:br/>
              Instructions for obtaining the update itself. This should include instructions for making the update accessible to the TOE (e.g., placement in a 
				specific directory).
              <h:br/>
              <h:br/>
              Instructions for initiating the update process, as well as discerning whether the process was successful or unsuccessful. This includes generation 
				of the hash or digital signature.
              <h:br/>
              <h:br/>
              The TOE will likely contain security functionality that does not fall in the scope of evaluation under 
				this PP. The operational guidance shall make it clear to an administrator which security functionality is covered by the evaluation activities.
            </aactivity>
          </a-element>
        </a-component>
      </section>
      <section title="Preparative Procedures (AGD_PRE.1)" id="agd_pre">
        <a-component cc-id="agd_pre.1" name="Preparative Procedures (AGD_PRE.1)">
          <a-element type="D">
            <title>The developer shall provide the TOE, including its preparative procedures.</title>
            <note role="application">As with the operational guidance, the developer should look to the evaluation activities to determine the required content with respect to preparative procedures.</note>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The preparative procedures shall describe all the steps necessary for secure acceptance of the delivered TOE in accordance with the developer's delivery procedures.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The preparative procedures shall describe all the steps necessary for secure installation of the TOE and for the secure preparation of the operational environment in accordance with the security objectives for the operational environment as described in the ST.</title>
            <note role="application">
              It is recognized that the application of these requirements will vary depending on aspects such as whether the TOE is delivered in an operational state, or whether it has to be installed at the TOE owner's site, etc.
              <h:br/>
              <h:br/>
              It might also be the case that no installation is necessary, for example as a
                Software as a Service implementation in a Cloud environment. In this case it may be inappropriate to require and analyze installation procedures and thus this requirement is implicitly satisfied.
            </note>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements for content and presentation of evidence.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall apply the preparative procedures to confirm that the TOE can be prepared securely for operation.</title>
            <aactivity>As indicated in the introduction above, there are significant expectations with respect to the documentation, especially when configuring the operational environment to support TOE functional requirements. The evaluator shall check to ensure that the guidance provided for the TOE adequately addresses all platforms claimed for the TOE in the ST.</aactivity>
          </a-element>
        </a-component>
      </section>
      <section title="Class ALC: Life-cycle Support" id="alc">
        At the assurance level provided for TOEs conformant to this PP, life-cycle support is limited to end-user visible aspects of the life-cycle, rather than an examination of the TOE vendor's development and configuration management process. This is not meant to diminish the critical role that a developer's practices play in contributing to the overall trustworthiness of a product; rather, it's a reflection on the information to be made available for evaluation at this assurance level.
        <a-component cc-id="alc_cmc.1" name="Labeling of the TOE (ALC_CMC.1)">
          This component is targeted at identifying the TOE such that it can be distinguished from other products or versions from the same vendor and can be easily specified when being procured by an end user.
          <a-element type="D">
            <title>The developer shall provide the TOE and a reference for the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The TOE shall be labeled with its unique reference.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements for content and presentation of evidence.</title>
            <aactivity>The evaluator shall check the ST to ensure that it contains an identifier
                (such as a product name and version number) that specifically identifies the version that meets the requirements of the ST. Further, the evaluator shall check the operational guidance and TOE samples received for testing to ensure that the version number is consistent with that in the ST. If the vendor maintains a website advertising the TOE, the evaluator shall examine the information on the website to ensure that the information in the ST is sufficient to distinguish the product.</aactivity>
          </a-element>
        </a-component>
      </section>
      <section title="TOE CM Coverage (ALC_CMS.1)" id="alc_cms">
        <a-component cc-id="alc_cms.1" name="TOE CM Coverage (ALC_CMS.1)">
          Given the scope of the TOE and its associated evaluation evidence requirements, this component's evaluation activities are covered by the evaluation activities listed for ALC_CMC.1.
          <a-element type="D">
            <title>The developer shall provide a configuration list for the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The configuration list shall include the following: the TOE itself; and the evaluation evidence required by the SARs.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The configuration list shall uniquely identify the configuration items.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements for content and presentation of evidence.</title>
            <note role="application">In cases where the MDM software is Software as a Service, running in a cloud environment where they have little to no control of the operating system and underlying hardware, the evaluated configuration is considered a snapshot of the MDM software with the OS or VM versions used at the time of testing.</note>
            <aactivity>
              The "evaluation evidence required by the SARs" in this
                PP is limited to the information in the ST coupled with the guidance provided to administrators and users under the AGD requirements. By ensuring that the TOE is specifically identified and that this identification is consistent in the ST and in the operational guidance (as done in the evaluation activity for ALC_CMC.1), the evaluator implicitly confirms the information required by this component.
              <h:br/>
              <h:br/>
              Life-cycle support is targeted aspects of the developer's life-cycle and instructions to providers of applications for the developer's devices, rather than an in-depth examination of the TSF manufacturer's development and configuration management process. This is not meant to diminish the critical role that a developer's practices play in contributing to the overall trustworthiness of a product; rather, it's a reflection on the information to be made available for evaluation.
              <h:br/>
              <h:br/>
              The evaluator shall ensure that the TSF is uniquely identified (with respect to other products from the TSF vendor), and that documentation provided by the developer in association with the requirements in the ST is associated with the TSF using this unique identification.
              <h:br/>
              <h:br/>
            </aactivity>
          </a-element>
        </a-component>
        <a-component cc-id="alc_flr.1" name="Basic Flaw Remediation (ALC_FLR.1)" status="optional">
          <a-element type="D">
            <title>The developer shall document and provide flaw remediation procedures addressed to TOE
              developers.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures documentation shall describe the procedures used to
              track all reported security flaws in each release of the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall require that a description of the nature and effect
              of each security flaw be provided, as well as the status of finding a correction to that flaw.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall require that corrective actions be identified for
              each of the security flaws.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures documentation shall describe the methods used to
              provide flaw information, corrections and guidance on corrective actions to TOE users.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements for
              content and presentation of evidence.</title>
            <aactivity>Evaluated as specified by <xref to="bibCEM"/>.</aactivity>
          </a-element>
        </a-component>
        <a-component cc-id="alc_flr.2" name="Flaw Reporting Procedures (ALC_FLR.2)" status="optional">
          <a-element type="D">
            <title>The developer shall document and provide flaw remediation procedures addressed to TOE
              developers.</title>
            <aactivity/>
          </a-element>
          <a-element type="D">
            <title>The developer shall establish a procedure for accepting and acting upon all reports of
              security flaws and requests for corrections to those flaws.</title>
            <aactivity/>
          </a-element>
          <a-element type="D">
            <title>The developer shall provide flaw remediation guidance addressed to TOE users.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures documentation shall describe the procedures used to track all
              reported security flaws in each release of the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall require that a description of the nature and effect of each
              security flaw be provided, as well as the status of finding a correction to that flaw.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall require that corrective actions be identified for each of the
              security flaws.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures documentation shall describe the methods used to provide flaw
              information, corrections and guidance on corrective actions to TOE users.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall describe a means by which the developer receives
              from TOE users reports and enquiries of suspected security flaws in the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The procedures for processing reported security flaws shall ensure that any reported
              flaws are remediated and the remediation procedures issued to TOE users.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The procedures for processing reported security flaws shall provide safeguards that any
              corrections to these security flaws do not introduce any new flaws.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation guidance shall describe a means by which TOE users report to the
              developer any suspected security flaws in the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements for content and
              presentation of evidence.</title>
            <aactivity>Evaluated as specified by <xref to="bibCEM"/>.</aactivity>
          </a-element>
        </a-component>
        <a-component cc-id="alc_flr.3" name="Systematic Flaw Remediation (ALC_FLR.3)" status="optional">
          <a-element type="D">
            <title>The developer shall document and provide flaw remediation procedures addressed to TOE
              developers.</title>
            <aactivity/>
          </a-element>
          <a-element type="D">
            <title>The developer shall establish a procedure for accepting and acting upon all reports of security
              flaws and requests for corrections to those flaws.</title>
            <aactivity/>
          </a-element>
          <a-element type="D">
            <title>The developer shall provide flaw remediation guidance addressed to TOE users.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures documentation shall describe the procedures used to track all
              reported security flaws in each release of the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall require that a description of the nature and effect of each
              security flaw be provided, as well as the status of finding a correction to that flaw.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall require that corrective actions be identified for each of the
              security flaws.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures documentation shall describe the methods used to provide flaw
              information, corrections and guidance on corrective actions to TOE users.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall describe a means by which the developer receives from
              TOE users reports and enquiries of suspected security flaws in the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation procedures shall include a procedure requiring timely response and
              the automatic distribution of security flaw reports and the associated corrections to
              registered users who might be affected by the security flaw.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The procedures for processing reported security flaws shall ensure that any reported flaws are
              remediated and the remediation procedures issued to TOE users.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The procedures for processing reported security flaws shall provide safeguards that any
              corrections to these security flaws do not introduce any new flaws.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation guidance shall describe a means by which TOE users report to the
              developer any suspected security flaws in the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation guidance shall describe a means by which TOE users may register
              with the developer, to be eligible to receive security flaw reports and corrections.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The flaw remediation guidance shall identify the specific points of contact for all reports
              and enquiries about security issues involving the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements for content and
              presentation of evidence.</title>
            <aactivity>Evaluated as specified by <xref to="bibCEM"/>.</aactivity>
          </a-element>
        </a-component>
      </section>
      <section title="Class ATE: Tests" id="ate-tests">
        Testing is specified for functional aspects of the system as well as aspects that take advantage of design or implementation weaknesses. The former is done through the ATE_IND family, while the latter is through the AVA_VAN family. At the assurance level specified in this PP, testing is based on advertised functionality and interfaces with dependency on the availability of design information. One of the primary outputs of the evaluation process is the test report as specified in the following requirements.
        <h:br/>
        <h:br/>
        Since many of the APIs are not exposed at the user interface (e.g., touch screen), the ability to stimulate the necessary interfaces requires a developer's test environment. This test environment will allow the evaluator, for example, to access APIs and view file system information that is not available on consumer devices.
        <a-component cc-id="ate_ind.1" name="Independent Testing - Conformance (ATE_IND.1)">
          Testing is performed to confirm the functionality described in the TSS as well as the administrative (including configuration and operational) documentation provided. The focus of the testing is to confirm that the requirements specified in Sections 5.3 and 5.4 are being met, although some additional testing is specified for SARs in Section 6. The Evaluation Activities identify the additional testing activities associated with these components. The evaluator produces a test report documenting the plan for and results of testing, as well as coverage arguments focused on the TOE or platform combinations that are claiming conformance to this PP.
          <a-element type="D">
            <title>The developer shall provide the TOE for testing.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The TOE shall be suitable for testing.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>
              The evaluator
              <h:i>shall confirm</h:i>
              that the information provided meets all requirements for content 
			  and presentation of evidence.
            </title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall test a subset of the TSF to confirm that the TSF operates as specified.</title>
            <aactivity>
              The evaluator shall prepare a test plan and report documenting the testing aspects of the system. The
			  test plan covers all of the testing
			  actions contained in the CEM and the body of this PP's Evaluation Activities. While it is not
			  necessary to have
			  one test case per test listed in an evaluation activity, the evaluator must document in the test plan that each 
			  applicable testing requirement in the ST is covered.
              <h:br/>
              <h:br/>
              The test plan identifies the platforms to be tested, and for those platforms not included in the test plan but
				included in the ST, the test plan provides a justification for not testing the platforms. This justification
				must address the differences between the tested platforms and the untested platforms, and make an argument that
				the differences do not affect the testing to be performed. It is not sufficient to merely assert that the
				differences have no affect; rationale must be provided. If all platforms claimed in the ST are tested, then
				no rationale is necessary.
              <h:br/>
              <h:br/>
              The test plan describes the composition of each platform to be tested, and any setup that is necessary beyond
				what is contained in the  part of a test or as a standard pre-test condition. This may include special test
				drivers or tools. For each driver or tool, an argument (not just an assertion) should be provided that the 
				driver or tool will not adversely affect the performance of the functionality by the TOE and its platform.
				This also includes the configuration of the cryptographic engine to be used. The cryptographic algorithms 
				implemented by this engine are those specified by this PP and used by the cryptographic protocols being
				evaluated (IPsec, TLS/HTTPS, SSH).
              <h:br/>
              <h:br/>
              The test plan identifies high-level test objectives as well as the test procedures to be followed to achieve 
				those objectives. These procedures include expected results. The test report (which could just be an annotated 
				version of the test plan) details the activities that took place when the test procedures were executed, and
				includes the actual results of the tests. This shall be a cumulative account, so if there was a test run that
				resulted in a failure; a fix installed; and then a successful re-run of the test, the report would show a
				"fail" and "pass" result (and the supporting details), and not just the "pass" result.
              <h:br/>
              <h:br/>
            </aactivity>
          </a-element>
        </a-component>
      </section>
      <section title="Class AVA: Vulnerability Analysis" id="ava">
        For the first generation of this protection profile, the evaluation lab is expected to survey open sources to discover 
	  what vulnerabilities have been discovered in these types of products. In most cases, these vulnerabilities will require 
	  sophistication beyond that of a basic attacker. Until penetration tools are created and uniformly distributed to the
	  evaluation labs, the evaluator will not be expected to test for these vulnerabilities in the TOE. The labs will be 
	  expected to comment on the likelihood of these vulnerabilities given the documentation provided by the vendor. This
	  information will be used in the development of penetration testing tools and for the development of future protection 
	  profiles.
        <a-component cc-id="ava_van.1" name="Vulnerability Survey (AVA_VAN.1)">
          <a-element type="D">
            <title>The developer shall provide the TOE for testing.</title>
            <aactivity/>
          </a-element>
          <a-element type="C">
            <title>The TOE shall be suitable for testing.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall confirm that the information provided meets all requirements for content and 
			  presentation of evidence.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall perform a search of public domain sources to identify potential vulnerabilities in 
			  the TOE.</title>
            <aactivity/>
          </a-element>
          <a-element type="E">
            <title>The evaluator shall conduct penetration testing, based on the identified potential vulnerabilities, to 
			  determine
			  that the TOE is resistant to attacks performed by an attacker possessing Basic attack potential.</title>
            <aactivity>As with ATE_IND, the evaluator shall generate a report to document their findings with respect to this
			  requirement. This report could physically be part of the overall test report mentioned in ATE_IND, or a separate
			  document. The evaluator performs a search of public information to determine the vulnerabilities that have been
			  found in network infrastructure devices and the implemented communication protocols in general, as well as those
			  that pertain to the particular TOE. The evaluator documents the sources consulted and the vulnerabilities found
			  in the report. For each vulnerability found, the evaluator either provides a rationale with respect to its 
			  non-applicability, or the evaluator formulates a test (using the guidelines provided in ATE_IND) to confirm
			  the vulnerability, if suitable. Suitability is determined by assessing the attack vector needed to take
			  advantage of the vulnerability. If exploiting the vulnerability requires expert skills and an electron
			  microscope, for instance, then a test would not be suitable and an appropriate justification would be formulated.</aactivity>
          </a-element>
        </a-component>
      </section>
    </section>
  </sec:req>
  <appendix title="Implicitly Satisfied Requirements" id="satisfiedreqs">
    <!--   Boilerplate goes here   -->
    <!--  	This appendix lists requirements that should be considered satisfied by products successfully evaluated
	against this PP. However, these requirements are not featured explicitly as SFRs and should not be
	included in the ST. They are not included as standalone SFRs because it would increase the time, cost,
	and complexity of evaluation. This approach is permitted by [CC] Part 1, 8.2 Dependencies between
	components.<h:br/><h:br/>
	This information benefits systems engineering activities which call for inclusion of particular security
	controls. Evaluation against the PP-Module provides evidence that these controls are present and have
	been evaluated.
  -->
    <h:b>
      <ctr ctr-type="Table" pre="Table " id="imp-sat-reqs-table">: Implicitly Satisfied Requirements</ctr>
    </h:b>
    <h:table>
      <h:tr class="header">
        <h:td>Requirement</h:td>
        <h:td>Rationale for Satisfaction</h:td>
      </h:tr>
      <h:tr>
        <h:td>
          <h:b>FIA_UID.1 - Timing of Identification</h:b>
        </h:td>
        <h:td>
          FIA_UAU.1 has a dependency on FIA_UID.1 because authentication of an external entity requires that entity to first identify
          itself so that its identity can be validated by the authentication process.
          <h:br/>
          <h:br/>
          This SFR has not been defined in this PP-Module because authentication of a user implicitly requires them to be identified as well.
          <h:br/>
          <h:br/>
          There are two cases in which a user must be authenticated by the TSF per the application note in FIA_UAU.1: enrollment of a users 
          MD into management, and authentication of a user to the TOEs management interface. FIA_ENR_EXT.1 requires authentication
          of the user using a method such as a directory server, which implicitly expects that the user must identify themselves as well as 
          provide a credential associated with the claimed identity. For management, FMT_SMR.1(1) requires the TSF to maintain an administrator
          role but it does not specify whether authentication to this role is role-based or identity-based. Therefore, the PP is not concerned 
          with the specific mechanism by which an administrator presents their identity to the TSF, only that there is a mechanism to validate
          and authorize whatever information they do present.
        </h:td>
      </h:tr>
      <h:tr>
        <h:td>
          <h:b>FMT_MTD.1 - Management of TSF Data</h:b>
        </h:td>
        <h:td>
          FAU_SEL.1 has a dependency on FMT_MTD.1 because the configuration settings that determine what events are audited is considered to be
          TSF data. While FAU_SEL.1 determines the extent to which the TOEs audit function is configured, it relies on FMT_MTD.1 to determine
          the administrative roles that are permitted to manipulate this data.
          <h:br/>
          <h:br/>
          The PP allows FAU_SEL.1 to be implemented either by the TSF or by the TOE platform because the TOE may rely on the audit functionality
          provided by the OS it runs on. If this is configured entirely through the platform, the administrator does not necessarily need to be 
          authenticated by the TOE to do this. Therefore, requiring FMT_MTD.1 does not make sense in this situation. If this is configured through
          the TOE, it can be implied from a review of FMT_SMR.1(1) that the MD user role cannot perform this function as they lack the authority
          to manage the TSF. It is therefore understood that this function can be performed by the administrator role or potentially by one or 
          more roles specified by the ST author if the selection to specify additional roles is chosen. An additional SFR that explicitly identifies
          the roles permitted to manage this function is redundant in this context.
        </h:td>
      </h:tr>
      <h:tr>
        <h:td>
          <h:b>FPT_STM.1 - Reliable Time Stamps</h:b>
        </h:td>
        <h:td>The PPs iterations of FAU_GEN.1 as well as its cryptographic functionality have a
          dependency on FPT_STM.1 because audit data require 
          accurate timestamps as well as some cryptographic operations, such as determining if a presented X.509 certificate is expired. The TOE 
          is installed on a general-purpose computer or specialized network device that is assumed to have the ability to provide certain functions
          to the TOE as specified in A.MDM_SERVER_PLATFORM. This assumption explicitly lists reliable timestamps as a function that the TSF is 
          expected to have available to it.</h:td>
      </h:tr>
    </h:table>
  </appendix>
  <appendix title="Entropy Documentation and Assessment" id="entropyappendix">
    This appendix describes the required supplementary information for each entropy source used by the TOE.
    <h:br/>
    <h:br/>
    The 
	documentation of the entropy sources should be detailed enough that, after reading, the evaluator will thoroughly 
	understand the entropy source and why it can be relied on to provide sufficient entropy. This documentation should 
	include multiple detailed sections: design description, entropy justification, operating conditions, and health testing. 
	This documentation is not required to be part of the TSS.
    <h:br/>
    <h:br/>
    <section id="design-description" title="Design Description">
      Documentation shall include the design of each entropy source
	as a whole, including the interaction of all entropy source components. Any information that can be shared regarding the
	design should also be included for any third-party entropy sources that are included in the product.
      <h:br/>
      <h:br/>
      The
	documentation will describe the operation of the entropy source to include, how entropy is produced, and how unprocessed 
	(raw) data can be obtained from within the entropy source for testing purposes. The documentation should walk through the
	entropy source design indicating where the entropy comes from, where the entropy output is passed next, any post-processing 
	of the raw outputs (hash, XOR, etc.), if or where it is stored, and finally, how it is output from the entropy source. Any 
	conditions placed on the process (e.g., blocking) should also be described in the entropy source design. Diagrams and
	examples are encouraged.
      <h:br/>
      <h:br/>
      This design must also include a description of the content of the security boundary 
	of the entropy source and a description of how the security boundary ensures that an adversary outside the boundary cannot 
	affect the entropy rate.
      <h:br/>
      <h:br/>
      If implemented, the design description shall include a description of how third-party
	applications can add entropy to the RBG. A description of any RBG state saving between power-off and power-on shall be 
	included.
      <h:br/>
      <h:br/>
    </section>
    <section id="entropy-justification" title="Entropy Justification">
      There should be a technical argument for where
      the unpredictability in the source comes from and why there is confidence in the entropy
      source delivering sufficient entropy for the uses made of the RBG output (by this particular
        TOE). This argument will include a description of the expected min-entropy
      rate (i.e., the minimum entropy (in bits) per bit or byte of source data) and explain that
      sufficient entropy is going into the TOE randomizer seeding process. This
      discussion will be part of a justification for why the entropy source can be relied on to
      produce bits with entropy.
      <h:br/>
      <h:br/>
      The amount of information necessary to justify the
      expected min-entropy rate depends on the type of entropy source included in the
      product.
      <h:br/>
      <h:br/>
      For developer provided entropy sources, in order to justify the min-entropy
      rate, it is expected that a large number of raw source bits will be collected, statistical
      tests will be performed, and the min-entropy rate determined from the statistical tests.
      While no particular statistical tests are required at this time, it is expected that some
      testing is necessary in order to determine the amount of min-entropy in each output.
      <h:br/>
      <h:br/>
      For third-party provided entropy sources, in which the TOE vendor has
      limited access to the design and raw entropy data of the source, the documentation will
      indicate an estimate of the amount of min-entropy obtained from this third-party source. It
      is acceptable for the vendor to "assume" an amount of min-entropy, however, this assumption
      must be clearly stated in the documentation provided. In particular, the min-entropy estimate
      must be specified and the assumption included in the ST.
      <h:br/>
      <h:br/>
      Regardless
      of type of entropy source, the justification will also include how the DRBG is initialized
      with the entropy stated in the ST, for example by verifying that the
      min-entropy rate is multiplied by the amount of source data used to seed the DRBG or that the
      rate of entropy expected based on the amount of source data is explicitly stated and compared
      to the statistical rate. If the amount of source data used to seed the DRBG is not clear or
      the calculated rate is not explicitly related to the seed, the documentation will not be
      considered complete.
      <h:br/>
      <h:br/>
      The entropy justification shall not include any data added from
      any third-party application or from any state saving between restarts.
      <h:br/>
      <h:br/>
    </section>
    <section id="operating-conditions" title="Operating Conditions">
      The entropy rate may be affected by conditions
      outside the control of the entropy source itself. For example, voltage, frequency,
      temperature, and elapsed time after power-on are just a few of the factors that may affect the
      operation of the entropy source. As such, documentation will also include the range of
      operating conditions under which the entropy source is expected to generate random data.
      Similarly, documentation shall describe the conditions under which the entropy source is no
      longer guaranteed to provide sufficient entropy. Methods used to detect failure or degradation
      of the source shall be included.
      <h:br/>
      <h:br/>
    </section>
    <section id="sec4" title="Health Testing">
      More specifically, all entropy source health tests
      and their rationale will be documented. This will include a description of the health tests,
      the rate and conditions under which each health test is performed (e.g., at startup,
      continuously, or on-demand), the expected results for each health test, TOE
      behavior upon entropy source failure, and rationale indicating why each test is believed to be
      appropriate for detecting one or more failures in the entropy source.
      <h:br/>
      <h:br/>
    </section>
  </appendix>
  <appendix title="Objective Requirements" id="objective">
    As indicated in the introduction to this PP, the baseline requirements (those that must be performed by the TOE or its 
	underlying platform) are contained in the body of this PP. There are additional requirements that specify security 
	functionality that is desirable and these requirements are contained in this Appendix. It is expected that these 
	requirements will transition from objective requirements to baseline requirements in future versions of this PP.
    <h:br/>
    <h:br/>
    At any time these may be included in the ST such that the TOE is still conformant to this PP.
    <h:br/>
    <h:br/>
    This Appendix is 
	divided into two subsections: objective requirements that may be performed by the TSF and objective requirements that may be
	performed by the MDM agent or its underlying platform.
    <h:br/>
    <h:br/>
  </appendix>
  <appendix title="Evaluating Additional Components for a Distributed TOE" id="EACDT">
    In the case of a distributed TOE the ST will identify an evaluated configuration that consists of a number of separate components chosen by the ST author, 
	which collectively satisfy the requirements of the PP. This evaluated configuration need not be the minimum set of components that could possibly meet the PP 
	(e.g., if the TOE is intended for large enterprise deployments then the evaluated configuration might include some redundancy in components in order to support
	expected connectivity and loads), but because this is the main configuration referred to in the ST and the evaluation, it is treated in this section as the 
	minimum configuration of interest and is referred to here as the 'minimum configuration' as well as the 'evaluated configuration'.
    <h:br/>
    <h:br/>
    In addition to the minimum configuration above, the ST may also identify (at the author's discretion, and subject to verification as described in this section) 
	which TOE components can have instances added to an operational configuration without affecting the validity of the CC certification. The ST description may 
	include constraints on how such components are added, including required or prohibited configurations of the components.
    <h:br/>
    <h:br/>
    Extra instances of a TOE component must have the same hardware and software as the original component included in the evaluated configuration.
    <h:br/>
    <h:br/>
    <section title="Evaluator Actions for Assessing the ST" id="sec1">
      <h:b>TSS</h:b>
      The evaluator shall examine the TSS to identify any extra instances of TOE components allowed in the ST and shall examine the description of how the additional 
	  components maintain the SFRs to confirm that it is consistent with the role that the component plays in the evaluated configuration. For example: the secure 
	  channels used by the extra component for intra-TOE communications (FPT_ITT) and external communications (FTP_ITC) must be consistent, the audit information
	  generated by the extra component must be maintained, and the management of the extra component must be consistent with that used for the original instance of 
	  the component in the minimum configuration.
    </section>
    <section title="Evaluator Actions for Assessing the Guidance Documentation" id="sec2">
      <h:b>Guidance</h:b>
      w
      <!--   <Guidance>   -->
      The evaluator shall examine the description of the extra instances of TOE components in the guidance documentation to confirm that they are consistent with those
	identified as allowed in the ST. This includes confirmation that the result of applying the guidance documentation to configure the extra component will leave the
	TOE in a state such that the claims for SFR support in each component are as described in the ST and therefore that all SFRs continue to be met when the extra
	components are present.
      <h:br/>
      <h:br/>
      The evaluator shall examine the secure communications described for the extra components to confirm that they are the same as described for the components in
	  the minimum configuration (additional connections between allowed extra components and the components in the minimum configuration are allowed of course).
      <h:br/>
      <h:br/>
      <!--   </Guidance>   -->
    </section>
    <section title="Evaluator Actions for Testing the TOE" id="sec3">
      <h:b>Tests</h:b>
      <!--   <Tests>   -->
      The evaluator tests the TOE in the minimum configuration as defined in the ST (and the guidance documentation).
      <h:br/>
      <h:br/>
      If the description of the use of extra components in the ST and guidance documentation identifies any difference in the SFRs allocated to a component, or 
	  the scope of the SFRs involved (e.g., if different selections apply to different instances of the component) then the evaluator tests these additional SFR cases
	  that were not included in the minimum configuration.
      <h:br/>
      <h:br/>
      In addition, the evaluator tests the following aspects for each extra component that is identified as allowed in the distributed TOE:
      <h:br/>
      <h:br/>
      <h:ul>
        <h:li>Communications: the evaluator follows the guidance documentation to confirm, by testing, that any additional connections introduced with the extra 
		component and not present in the minimum configuration are consistent with the requirements stated in the ST (e.g., with regard to protocols and ciphersuites
		used). An example of such an additional connection would be if a single instance of the component is present in the minimum configuration and adding a 
		duplicate component then introduces an extra communication between the two instances. Another example might be if the use of the additional components
		necessitated the use of a connection to an external authentication server instead of using locally stored credentials.</h:li>
        <h:li>Audit: the evaluator confirms that the audit records from different instances of a component can be distinguished so that it is clear which instance
		generated the record.</h:li>
        <h:li>Management: if the extra component manages other components in the distributed TOE then the evaluator shall follow the guidance documentation to
		confirm that management via the extra component uses the same roles and role holders for administrators as for the component in the minimum configuration.</h:li>
      </h:ul>
      <!--   </Tests>   -->
    </section>
  </appendix>
  <appendix title="MDM Software Equivalency Guidelines" id="equiv">
    <section id="mdm-intro" title="Introduction">
      The purpose of equivalence in PP-based evaluations is to find a balance between evaluation rigor and commercial practicability, to 
      ensure that evaluations meet customer expectations while recognizing that there is little to be gained from requiring that every 
      variation in a product or platform be fully tested. If a product is found to be compliant with a PP on one platform, then all 
      equivalent products on equivalent platforms are also considered to be compliant with the PP.
      <h:br/>
      <h:br/>
      A Vendor can make a claim of equivalence if the Vendor believes that a particular instance of their Product implements PP-specified 
      security functionality in a way equivalent to the implementation of the same functionality on another instance of their Product on 
      which the functionality was tested. The Product instances can differ in version number or feature level (model), or the instances may
      run on different platforms. Equivalency can be used to reduce the testing required across claimed evaluated configurations. It can 
      also be used during Assurance Maintenance to reduce testing needed to add more evaluated configurations to a certification.
      <h:br/>
      <h:br/>
      These equivalency guidelines do not replace Assurance Maintenance requirements or NIAP Policy #5 requirements for CAVP certificates. 
      Nor may equivalency be used to leverage evaluations with expired certifications.
      <h:br/>
      <h:br/>
      These Equivalency Guidelines represent a shift from complete testing of all product instances to more of a risk-based approach. 
      Rather than require that every combination of product and platform be tested, these guidelines support an approach that recognizes
      that products are being used in a variety of environments, and often in cloud environments over where the vendor (and sometimes the 
      customer) have little or no control over the underlying hardware. Developers should be responsible for the security functionality of 
      their applications on the platforms they are developed for, whether that is an operating system, a virtual machine, or a software-based
      execution environment such as a container. But those platforms may themselves run within other environments, virtual machines or
      operating systems, that completely abstract away the underlying hardware from the application. The developer should not be held
      accountable for security functionality that is implemented by platform layers that are abstracted away. The implication is that
      not all security functionality will necessarily be tested for all platform layers down to the hardware for all evaluated
      configurations, especially for applications developed for software-based execution environments such as containers. For these cases, 
      the balancing of evaluation rigor and commercial practicability tips in favor of practicability. Note that this does not affect the requirement 
	  that at least one product instance be fully tested on at least one platform with cryptography mapped to a CAVP certificate.
      <h:br/>
      <h:br/>
      Equivalency has two aspects:
      <h:br/>
      <h:ul>
        <h:li>
          <h:b>
            <h:i>Product Equivalence:</h:i>
          </h:b>
          Products may be considered equivalent if there are no
          differences between Product Models and Product Versions with respect to PP-specified security functionality.
        </h:li>
        <h:li>
          <h:b>
            <h:i>Platform Equivalence:</h:i>
          </h:b>
          Platforms may be considered equivalent if there are no
          significant differences in the services they provide to the Product, or in the way the platforms 
          provide those services, with respect to PP-specified security functionality.
        </h:li>
      </h:ul>
      The equivalency determination is made in accordance with these guidelines by the Validator and Scheme using information provided by the evaluator or vendor.
    </section>
    <section id="approach" title="Approach to Equivalency Analysis">
      There are two scenarios for performing equivalency analysis. One is when a product has been certified and the vendor 
      wants to show that a later product should be considered certified due to equivalence with the earlier product. The 
      other is when multiple product variants are going though evaluation together and the vendor would like to reduce 
      the amount of testing that must be done. The basic rules for determining equivalence are the same in both cases. 
      But there is one additional consideration that applies to equivalence with previously certified products. That is, 
      the product with which equivalence is being claimed must have a valid certification in accordance with scheme rules
      and the Assurance Maintenance process must be followed. If a products certification has expired, then equivalence 
      cannot be claimed with that product.
      <h:br/>
      <h:br/>
      When performing equivalency analysis, the evaluator or vendor should first use the factors and guidelines for Product
      Model equivalence to determine the set of Product Models to be evaluated. In general, Product Models that do not differ 
      in PP-specified security functionality are considered equivalent for purposes of evaluation against the APP PP.
      <h:br/>
      <h:br/>
      If multiple revision levels of Product Models are to be evaluated, or to determine whether a revision of an evaluated 
      product needs re-evaluation, the evaluator or vendor and validator should use the factors and guidelines for Product 
      Version equivalence to analyze whether Product Versions are equivalent.
      <h:br/>
      <h:br/>
      Having determined the set of Product Models and Versions to be evaluated, the next step is to determine the set of
      Platforms that the Products must be tested on.
      <h:br/>
      <h:br/>
      Each non-equivalent Product for which compliance is claimed must be fully tested on each non-equivalent platform 
      for which compliance is claimed. For non-equivalent Products on equivalent platforms, only the differences that
      affect PP-specified security functionality must be tested for each product.
      <h:br/>
      <h:br/>
      <h:b>
        <h:i>"Differences in PP-Specified Security Functionality" Defined</h:i>
      </h:b>
      <h:br/>
      If PP-specified security functionality is implemented by the TOE, then differences in the actual implementation
      between versions or product models break equivalence for that feature. Likewise, if the TOE implements the 
      functionality in one version or model and the functionality is implemented by the platform in another version 
      or model, then equivalence is broken. If the functionality is implemented by the platform in multiple models or 
      versions on equivalent platforms, then the functionality is considered different if the product invokes the platform 
      differently to perform the function.
    </section>
    <section id="modelequiv" title="Specific Guidance for Determining Product Model Equivalence">
      Product Model equivalence attempts to determine whether different feature levels of the same product across 
      a product line are equivalent for purposes of PP testing. For example, if a product has a "basic" edition and an "enterprise" 
      edition, is it necessary to test both models? Or does testing one model provide sufficient assurance that both models 
      are compliant?
      <h:br/>
      <h:br/>
      Product models are considered equivalent if there are no differences that affect PP-specified security functionality, as indicated in
      <xref to="modeleq"/>.
      <h:br/>
      <h:br/>
      <h:b>
        <ctr ctr-type="Table" pre="Table " id="modeleq">: Determining Product Model Equivalence</ctr>
      </h:b>
      <h:table>
        <h:tr>
          <h:td valign="top">Factor</h:td>
          <h:td valign="top">Same or Different</h:td>
          <h:td valign="top">Guidance</h:td>
        </h:tr>
        <h:tr>
          <h:td rowspan="2" valign="top">PP-Specified Functionality</h:td>
          <h:td valign="top">Same</h:td>
          <h:td valign="top">If the differences between Models affect only non-PP-specified functionality, then the Models are equivalent. </h:td>
        </h:tr>
        <h:tr>
          <h:td valign="top">Different</h:td>
          <h:td valign="top">If PP-specified security functionality is affected by the differences between Models, 
            then the Models are not equivalent and must be tested separately. It is necessary only to test the functionality 
            affected by the software differences. If only differences are tested, then the differences must be enumerated, 
            and for each difference the Vendor must provide an explanation of why each difference does or does not affect 
            PP-specified functionality. If the Product Models are separately tested fully, then there is no need to document the differences.</h:td>
        </h:tr>
      </h:table>
      <h:br/>
      <h:br/>
    </section>
    <section id="versionequiv" title="Specific Guidance for Determining Product Version Equivalence">
      In cases of version equivalence, differences are expressed in terms of changes implemented in revisions 
      of an evaluated Product. In general, versions are equivalent if the changes have no effect on any 
      security-relevant claims about the TOE or assurance evidence. Non-security-relevant changes to TOE 
      functionality or the addition of non-security-relevant functionality does not affect equivalence.
      <h:br/>
      <h:br/>
      <h:b>
        <ctr ctr-type="Table" pre="Table " id="versioneq">: Factors for Determining Product Version Equivalence</ctr>
      </h:b>
      <h:table>
        <h:tr>
          <h:td valign="top">Factor</h:td>
          <h:td valign="top">Same or Different</h:td>
          <h:td valign="top">Guidance</h:td>
        </h:tr>
        <h:tr valign="top">
          <h:td valign="top">Product Models</h:td>
          <h:td valign="top">Different</h:td>
          <h:td valign="top">Versions of different Product Models are not equivalent unless the Models are equivalent as defined in subsection 3.</h:td>
        </h:tr>
        <h:tr>
          <h:td rowspan="2" valign="top">PP-Specified Functionality</h:td>
          <h:td valign="top">Same</h:td>
          <h:td valign="top">If the differences affect only non-PP-specified functionality, then the Versions are equivalent. </h:td>
        </h:tr>
        <h:tr>
          <h:td valign="top">Different</h:td>
          <h:td valign="top">If PP-specified security functionality is affected by the differences, then the 
            Versions are not considered equivalent and must be tested separately. It is necessary only to test 
            the functionality affected by the changes. If only the differences are tested, then for each 
            difference the Vendor must provide an explanation of why the difference does or does not affect 
            PP-specified functionality. If the Product Versions are separately tested fully, then there is 
            no need to document the differences.</h:td>
        </h:tr>
      </h:table>
      <h:br/>
      <h:br/>
    </section>
    <section id="platformequiv" title="Specific Guidance for Determining Platform Equivalence">
      Platform equivalence is used to determine the platforms that equivalent versions of a Product must be tested on. 
      Platform equivalence analysis done for one MDM cannot be applied to another MDM.
      Platform equivalence is not general, it is with respect to a particular MDM.
      <h:br/>
      <h:br/>
      Product Equivalency analysis must already have been done and Products have been determined to be equivalent.
      <h:br/>
      <h:br/>
      The platform can be hardware or virtual hardware, an operating system or similar entity, or a software execution 
      environment such as a container. For purposes of determining equivalence for MDMs, we address each
      type of platform separately. In general, platform equivalence is based on differences in the interfaces between the 
      TOE and Platform that are relevant to the implementation of PP-specified security functionality.
      <h:br/>
      <h:br/>
      <section id="hardware-equiv" title="Platform Equivalence, Hardware and Virtual Hardware Platforms">
        If an MDM runs directly on hardware without an operating system, or directly on virtualized 
        hardware without an operating system, then platform equivalence is based on processor architecture and 
        instruction sets. In the case of virtualized hardware, it is the virtualized processor and architecture 
        that are presented to the MDM that matters, not the physical hardware.
        <h:br/>
        <h:br/>
        Platforms with different processor architectures and instruction sets are not equivalent. This is not 
        likely to be an issue for equivalency analysis for MDMs since there is likely to be a different 
        version of the MDM for different hardware environments.
        Equivalency analysis becomes important when comparing processors with the same architecture. Processors 
        with the same architecture that have instruction sets that are subsets or supersets of each other are not
        disqualified from being equivalent for purposes of an MDM evaluation. If the MDM takes the same 
        code paths when executing PP-specified security functionality on different processors of the same family, 
        then the processors can be considered equivalent with respect to that MDM.
        For example, if an MDM follows one code path on platforms that support the AES-NI instruction 
        and another on platforms that do not, then those two platforms are not equivalent with respect to that 
        MDM functionality. But if the MDM follows the same code path whether or not the platform 
        supports AES-NI, then the platforms are equivalent with respect to that functionality.
        <h:br/>
        <h:br/>
        The platforms are equivalent with respect to the MDM if the platforms are equivalent with respect to all PP-specified
        security functionality.
        <h:br/>
        <h:br/>
        <h:b>
          <ctr ctr-type="Table" pre="Table " id="hwplateq">: Factors for Determining Hardware and Virtual Hardware Platform Equivalence</ctr>
        </h:b>
        <h:table>
          <h:tr>
            <h:td valign="top">Factor</h:td>
            <h:td valign="top">Same, Different, or None</h:td>
            <h:td valign="top">Guidance</h:td>
          </h:tr>
          <h:tr valign="top">
            <h:td valign="top">Platform Architectures</h:td>
            <h:td valign="top">Different</h:td>
            <h:td valign="top">Platforms that present different processor architectures and instruction sets to the MDM are not equivalent.</h:td>
          </h:tr>
          <h:tr>
            <h:td valign="top">PP-Specified Functionality</h:td>
            <h:td valign="top">Same</h:td>
            <h:td valign="top">For platforms with the same processor architecture, the platforms are equivalent with
              respect to the MDM if execution of all PP-specified security functionality follows the same code path on both platforms.</h:td>
          </h:tr>
        </h:table>
        <h:br/>
        <h:br/>
      </section>
      <section id="os-equiv" title="Platform Equivalence, OS Platforms">
        For MDMs that are built for and run on operating systems, platform equivalence is 
        determined by the interfaces between the MDM and the operating system that are relevant to PP-specified 
        security functionality. Generally, these are the processor interface, device interfaces, and OS APIs. The following 
        factors applied in order:
        <h:br/>
        <h:br/>
        <h:b>
          <ctr ctr-type="Table" pre="Table " id="osplateq">: Factors for Determining OS or VS Platform Equivalence</ctr>
        </h:b>
        <h:table>
          <h:tr>
            <h:td valign="top">Factor</h:td>
            <h:td valign="top">Same, Different, or None</h:td>
            <h:td valign="top">Guidance</h:td>
          </h:tr>
          <h:tr valign="top">
            <h:td valign="top">Platform Architectures</h:td>
            <h:td valign="top">Different</h:td>
            <h:td valign="top">Platforms that run on different processor architectures and instruction sets are not equivalent.</h:td>
          </h:tr>
          <h:tr valign="top">
            <h:td valign="top">Platform Vendors</h:td>
            <h:td valign="top">Different</h:td>
            <h:td valign="top">Platforms from different vendors are not equivalent. </h:td>
          </h:tr>
          <h:tr valign="top">
            <h:td valign="top">Platform Versions</h:td>
            <h:td valign="top">Different</h:td>
            <h:td valign="top">Platforms from the same vendor with different major version numbers are not equivalent.</h:td>
          </h:tr>
          <h:tr valign="top">
            <h:td valign="top">Platform Interfaces</h:td>
            <h:td valign="top">Different</h:td>
            <h:td valign="top">Platforms from the same vendor and major version are not equivalent if there are
              differences in device interfaces and OS APIs that are relevant to the way the platform provides PP-specified 
              security functionality to the MDM.</h:td>
          </h:tr>
          <h:tr valign="top">
            <h:td valign="top">Platform Interfaces</h:td>
            <h:td valign="top">Same</h:td>
            <h:td valign="top">Platforms from the same vendor and major version are equivalent if there are 
              no differences in device interfaces and OS APIs that are relevant to the way the platform 
              provides PP-specified security functionality to the MDM, or if the Platform does 
              not provide such functionality to the MDM.</h:td>
          </h:tr>
        </h:table>
        <h:br/>
        <h:br/>
      </section>
      <section id="software-equiv" title="Software-based Execution Environment Platform Equivalence">
        If an MDM is built for and runs in a non-OS software-based execution environment, such as a Container or 
        Java Runtime, then the below criteria must be used to determine platform equivalence. The key point is that the 
        underlying hardware (virtual or physical) and OS is not relevant to platform equivalence. This allows MDMs 
        to be tested and run on software-based execution environments on any hardware, as in cloud deployments.
        <h:br/>
        <h:br/>
        <h:b>
          <ctr ctr-type="Table" pre="Table " id="swplateq">: Factors for Software-based Execution Environment Platform Equivalence</ctr>
        </h:b>
        <h:table>
          <h:tr>
            <h:td valign="top">Factor</h:td>
            <h:td valign="top">Same, Different, or None</h:td>
            <h:td valign="top">Guidance</h:td>
          </h:tr>
          <h:tr valign="top">
            <h:td valign="top">Platform Type or Vendor</h:td>
            <h:td valign="top">Different</h:td>
            <h:td valign="top">Software-based execution environments that are substantially different or come 
              from different vendors are not equivalent. For example, a java virtual machine is not the same as a 
              container. A Docker container is not the same as a CoreOS container.</h:td>
          </h:tr>
          <h:tr valign="top">
            <h:td valign="top">Platform Versions</h:td>
            <h:td valign="top">Different</h:td>
            <h:td valign="top">Execution environments that are otherwise equivalent are not equivalent if they have 
              different major version numbers.</h:td>
          </h:tr>
          <h:tr valign="top">
            <h:td valign="top">PP-Specified Security Functionality</h:td>
            <h:td valign="top">Same</h:td>
            <h:td valign="top">All other things being equal, execution environments are equivalent if there is no 
              significant difference in the interfaces through which the environments provide PP-specified security 
              functionality to MDMs.</h:td>
          </h:tr>
        </h:table>
        <h:br/>
        <h:br/>
      </section>
    </section>
    <section id="specificity" title="Level of Specificity for Tested Configurations and Claimed Equivalent Configurations">
      In order to make equivalency determinations, the vendor and evaluator must agree on the equivalency claims. They must 
      then provide the scheme with sufficient information about the TOE instances and platforms that were evaluated, and the 
      TOE instances and platforms that are claimed to be equivalent.
      <h:br/>
      <h:br/>
      The ST must describe all configurations evaluated down to processor manufacturer, model number, and microarchitecture version.
      <h:br/>
      <h:br/>
      The information regarding claimed equivalent configurations depends on the platform that the MDM was developed for and runs on.
      <h:br/>
      <h:br/>
      <h:b>Bare-Metal MDMs</h:b>
      <h:br/>
      <h:br/>
      For MDM servers that run without an operating system on bare-metal or virtual bare-metal, the claimed configuration must 
      describe the platform down to the specific processor manufacturer, model number, and microarchitecture version. The Vendor
      must describe the differences in the TOE with respect to PP-specified security functionality and how the TOE functions
      differently to leverage platform differences (e.g., instruction set extensions) in the tested configuration versus the 
      claimed equivalent configuration.
      <h:br/>
      <h:br/>
      <h:b>Traditional MDMs</h:b>
      <h:br/>
      <h:br/>
      For MDMs that run with an operating system as their immediate platform, the claimed configuration must describe 
      the platform down to the specific operating system version. If the platform is a virtualization system, then the claimed 
      configuration must describe the platform down to the specific virtualization system version. The Vendor must describe the 
      differences in the TOE with respect to PP-specified security functionality and how the TOE functions differently to leverage
      platform differences in the tested configuration versus the claimed equivalent configuration. Relevant platform differences 
      could include instruction sets, device interfaces, and OS APIs invoked by the TOE to implement PP-specified security 
      functionality.
      <h:br/>
      <h:br/>
      <h:b>Software-Based Execution Environments</h:b>
      <h:br/>
      <h:br/>
      For MDMs that run in a software-based execution environment such as a Java virtual machine or a Container, then 
      the claimed configuration must describe the platform down to the specific version of the software execution environment. 
      The Vendor must describe the differences in the TOE with respect to PP-specified security functionality and how the TOE 
      functions differently to leverage platform differences in the tested configuration versus the claimed equivalent 
      configuration.
      <h:br/>
    </section>
  </appendix>
  <appendix title="Use Case Templates" id="use-case">
    The following use case templates list those selections, assignments, and objective requirements that best support the use cases identified by this Protection Profile. Note that the templates assume that all SFRs listed in Section 5 are included in the ST, not just those listed in the templates. These templates and deviations from the template should be identified in the Security Target to assist customers with making risk-based purchasing decisions. Products that do not meet these templates are not precluded from use in the scenarios identified by this Protection Profile. Where selections for a particular requirement are not identified in a use case template, all available selections are equally applicable to the use case.
    <section title="Enterprise-owned device for general-purpose enterprise use" id="usecase1">
      <h:table>
        <h:TR>
          <h:TD>
            <h:b>Requirement</h:b>
          </h:TD>
          <h:TD>
            <h:b>Action</h:b>
          </h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 32</h:TD>
          <h:TD>Include in ST and assign GPS.</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 34</h:TD>
          <h:TD>Include in ST. Assign personal hotspot connections (if feature
            exists).</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 47</h:TD>
          <h:TD>Include in ST.</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 49</h:TD>
          <h:TD>Include in ST and select "a. USB mass storage mode."</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 51</h:TD>
          <h:TD>Include in ST. Select both options.</h:TD>
        </h:TR>
      </h:table>
    </section>
    <section title="Enterprise-owned device for specialized, high-security use" id="usecase2">
      <h:table>
        <h:TR>
          <h:TD>
            <h:b>Requirement</h:b>
          </h:TD>
          <h:TD>
            <h:b>Action</h:b>
          </h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 15</h:TD>
          <h:TD>Include in ST.</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 16</h:TD>
          <h:TD>Include in ST.</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 31</h:TD>
          <h:TD>Include in ST and select "no other method."</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 32</h:TD>
          <h:TD>Include in ST.</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 33</h:TD>
          <h:TD>Include in ST. Assign at least USB.</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 34</h:TD>
          <h:TD>Include in ST. Assign all protocols where the TSF acts as a server.</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 36</h:TD>
          <h:TD>Include in ST.</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 37</h:TD>
          <h:TD>Include in ST.</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 40</h:TD>
          <h:TD>Include in ST.</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 42</h:TD>
          <h:TD>Include in ST.</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 47</h:TD>
          <h:TD>Include in ST.</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 52</h:TD>
          <h:TD>Include in ST.</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 54</h:TD>
          <h:TD>Include in ST.</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function c.1</h:TD>
          <h:TD>Include in ST.</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function c.2</h:TD>
          <h:TD>Include in ST.</h:TD>
        </h:TR>
      </h:table>
    </section>
    <section title="Personally-owned device for personal and enterprise use" id="usecase3">
      <h:table>
        <h:TR>
          <h:TD>
            <h:b>Requirement</h:b>
          </h:TD>
          <h:TD>
            <h:b>Action</h:b>
          </h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 13</h:TD>
          <h:TD>Include in ST</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 14</h:TD>
          <h:TD>Include in ST</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 21</h:TD>
          <h:TD>Include in ST</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 22</h:TD>
          <h:TD>Include in ST</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 30</h:TD>
          <h:TD>Select "on a per-app basis," "on a per-group of application processes basis," or both</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 31</h:TD>
          <h:TD>If included in ST, select "on a per-app basis," "on a per-group of application processes basis," or both</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 48</h:TD>
          <h:TD>Include in ST</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_AGENT Function 52</h:TD>
          <h:TD>If included in ST, select "on a per-app basis," "on a per-group of application processes basis," or both</h:TD>
        </h:TR>
        <h:TR>
          <h:TD>FMT_SMF.1/SERVER_CONF_SERVER Function f</h:TD>
          <h:TD>Include in the ST</h:TD>
        </h:TR>
      </h:table>
    </section>
    <section title="Personally-owned device for personal and limited enterprise use" id="usecase4">At this time no requirements are recommended for this use case.</section>
  </appendix>
  <bibliography>
    <entry id="bibCSA">
      <tag>CSA</tag>
      <description><h:a href="http://csrc.nist.gov/groups/SMA/ispab/documents/csa_87.txt">Computer Security Act of 1987</h:a>, H.R. 145, June 11, 1987. </description>
    </entry>
    <entry id="bibOMB">
      <tag>OMB</tag>
      <description><h:a href="http://www.whitehouse.gov/sites/default/files/omb/memoranda/fy2006/m06-19.pdf">Reporting Incidents Involving Personally Identifiable Information and Incorporating the Cost for Security in Agency Information Technology Investments</h:a>, OMB M-06-19, July 12, 2006. </description>
    </entry>
  </bibliography>
</PP>
